<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FinSight | Trading Dashboard</title>
  <meta name="description" content="Professional quantitative trading dashboard with real-time portfolio monitoring, agent control, and live trading logs." />
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- Render API Utils -->
  <script src="../../assets/js/render-api-utils.js"></script>
  
  <!-- Styles -->
  <link rel="stylesheet" href="quant-core.css" />
</head>
<body>
  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h2 id="loadingTitle">Loading FinSight</h2>
      <p id="loadingMessage">Connecting to API...</p>
    </div>
  </div>

  <!-- Main Container -->
  <div class="dashboard-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <div class="logo-icon">
            <!-- FinSight Logo - Star/Insight symbol -->
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2L14 8L20 10L14 12L12 18L10 12L4 10L10 8L12 2Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
              <circle cx="12" cy="10" r="2" fill="currentColor"/>
            </svg>
          </div>
          <span class="logo-text">FinSight</span>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <button class="nav-item active" data-view="dashboard">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="3" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <rect x="11" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <rect x="3" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <rect x="11" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
          <span>Dashboard</span>
        </button>
        <button class="nav-item" data-view="settings">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="10" cy="10" r="2.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M10 2.5V5.5M10 14.5V17.5M17.5 10H14.5M5.5 10H2.5M15.66 4.34L13.54 6.46M6.46 13.54L4.34 15.66M15.66 15.66L13.54 13.54M6.46 6.46L4.34 4.34" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <span>Settings</span>
        </button>
        <button class="nav-item" data-view="profile">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="10" cy="7" r="3" stroke="currentColor" stroke-width="1.5" fill="none"/>
            <path d="M4 17C4 13 6.5 11 10 11C13.5 11 16 13 16 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <span>Profile</span>
        </button>
      </nav>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <h1 class="header-title">Dashboard</h1>
        </div>
        <div class="header-right">
          <div style="position: relative;">
            <button class="header-btn" id="notificationsBtn" title="Notifications" onclick="toggleNotificationsMenu()">
              <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 2C7.24 2 5 4.24 5 7V12L3 15H17L15 12V7C15 4.24 12.76 2 10 2Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                <path d="M8 17H12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
              <span class="badge" id="notificationBadge" style="display: none;">0</span>
            </button>
            <div class="notifications-menu" id="notificationsMenu" style="display: none;">
              <div class="notifications-menu-header">
                <h3>Notifications</h3>
                <button class="notifications-clear-btn" id="clearAllNotificationsBtn" title="Clear all">
                  <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 6H16M7 6V4C7 3.45 7.45 3 8 3H12C12.55 3 13 3.45 13 4V6M9 10V15M11 10V15M6 6L5 17H15L14 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
              </div>
              <div class="notifications-list" id="notificationsList">
                <div class="notification-empty">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.3; margin-bottom: var(--spacing-md);">
                    <path d="M10 2C7.24 2 5 4.24 5 7V12L3 15H17L15 12V7C15 4.24 12.76 2 10 2Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    <path d="M8 17H12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <p>No notifications</p>
                </div>
              </div>
            </div>
          </div>
          <div style="position: relative;">
            <button class="header-btn" id="messagesBtn" title="System Messages" onclick="toggleMessagesMenu()">
              <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 5H17V13H6L3 16V5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
              </svg>
              <span class="badge" id="messageBadge" style="display: none;">0</span>
            </button>
            <div class="messages-menu" id="messagesMenu" style="display: none;">
              <div class="messages-menu-header">
                <h3>System Messages</h3>
                <button class="messages-clear-btn" id="clearAllMessagesBtn" title="Clear all">
                  <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 6H16M7 6V4C7 3.45 7.45 3 8 3H12C12.55 3 13 3.45 13 4V6M9 10V15M11 10V15M6 6L5 17H15L14 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
              </div>
              <div class="messages-list" id="messagesList">
                <div class="message-empty">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.3; margin-bottom: var(--spacing-md);">
                    <path d="M3 5H21V19H7L3 23V5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                  </svg>
                  <p>No messages</p>
                </div>
              </div>
            </div>
          </div>
          <div class="user-avatar" id="userAvatar" title="User Profile" onclick="toggleUserMenu()">
            <img id="userAvatarImg" src="" alt="User" style="display: none; width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">
            <svg id="userAvatarIcon" width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="10" cy="7" r="3" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M4 17C4 13 6.5 11 10 11C13.5 11 16 13 16 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="user-menu" id="userMenu" style="display: none;">
            <div class="user-menu-header" id="userMenuHeader">
              <div class="user-menu-avatar">
                <img id="userMenuAvatarImg" src="" alt="User" style="display: none; width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">
                <svg id="userMenuAvatarIcon" width="24" height="24" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="10" cy="7" r="3" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <path d="M4 17C4 13 6.5 11 10 11C13.5 11 16 13 16 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
              </div>
              <div class="user-menu-info">
                <div class="user-menu-name" id="userMenuName">Not signed in</div>
                <div class="user-menu-email" id="userMenuEmail"></div>
              </div>
            </div>
            <div class="user-menu-actions">
              <button class="user-menu-btn" id="signInBtn" onclick="openLoginModal()">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M8 15L13 10L8 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M13 10H2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span>Sign in</span>
              </button>
              <button class="user-menu-btn" id="signUpBtn" onclick="openSignUpModal()">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="10" cy="7" r="3" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <path d="M4 17C4 13 6.5 11 10 11C13.5 11 16 13 16 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  <path d="M15 5L15 11M12 8L18 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span>Sign up</span>
              </button>
              <button class="user-menu-btn" id="signOutBtn" onclick="handleSignOut()" style="display: none;">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 15L7 10L12 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M7 10H18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span>Sign out</span>
              </button>
            </div>
          </div>
        </div>
      </header>

      <!-- Dashboard View -->
      <div id="dashboardView" class="view active">
        <!-- Welcome/Onboarding Section (shown when no data) -->
        <div id="onboardingSection" class="onboarding-section" style="display: none;">
          <div class="onboarding-card">
            <div class="onboarding-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2L14 8L20 10L14 12L12 18L10 12L4 10L10 8L12 2Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                <circle cx="12" cy="10" r="2" fill="currentColor"/>
              </svg>
            </div>
            <h2 class="onboarding-title">Welcome to FinSight</h2>
            <p class="onboarding-description">Get started by connecting your exchange and configuring your trading parameters.</p>
            <div class="onboarding-steps">
              <div class="onboarding-step">
                <div class="step-number">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2L15 8L22 9L17 13L18 20L12 17L6 20L7 13L2 9L9 8L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="step-content">
                  <h3>Connect Exchange</h3>
                  <p>Go to <strong>Settings</strong> and connect your exchange (Binance, Alpaca, or Bybit) using your API credentials.</p>
                  <button class="btn-primary btn-outline" onclick="switchView('settings')">
                    <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle cx="10" cy="10" r="2.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
                      <path d="M10 2.5V5.5M10 14.5V17.5M17.5 10H14.5M5.5 10H2.5M15.66 4.34L13.54 6.46M6.46 13.54L4.34 15.66M15.66 15.66L13.54 13.54M6.46 6.46L4.34 4.34" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Go to Settings</span>
                  </button>
                </div>
              </div>
              <div class="onboarding-step">
                <div class="step-number">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M9 9H15M9 12H15M9 15H12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </div>
                <div class="step-content">
                  <h3>Configure Guard-Rails</h3>
                  <p>Set your risk management parameters: daily stop loss, max leverage, and allowed trading symbols.</p>
                </div>
              </div>
              <div class="onboarding-step">
                <div class="step-number">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 12L7 8L11 12L17 6L21 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M3 18L7 14L11 18L17 12L21 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="step-content">
                  <h3>Set Strategy</h3>
                  <p>Choose your trading strategy mode: Conservative, Moderate, or Aggressive.</p>
                </div>
              </div>
              <div class="onboarding-step">
                <div class="step-number">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="step-content">
                  <h3>Start Trading</h3>
                  <p>Once configured, you can start the trading agent and monitor your positions in real-time.</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Balance Section -->
        <section class="balance-section" id="balanceSection" style="display: none;">
          <div class="balance-card">
            <div class="balance-label">BALANCE</div>
            <div class="balance-amount" id="balanceAmount">—</div>
            <div class="balance-change" id="balanceChange">
              <span class="change-amount">—</span>
              <span class="change-percent">(—)</span>
            </div>
          </div>
          
          <button class="stop-system-btn" id="stopSystemBtn" style="display: none;">
            <svg width="14" height="14" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="6" y="6" width="8" height="8" rx="1" fill="currentColor"/>
            </svg>
            <span>TERMINATE SESSION</span>
          </button>
        </section>

        <!-- Open Positions Section -->
        <section class="positions-section" id="positionsSection" style="display: none;">
          <h2 class="section-title">OPEN POSITIONS</h2>
          <div class="positions-grid" id="positionsGrid">
            <!-- Positions will be dynamically inserted here -->
          </div>
        </section>

        <!-- Live Terminal Section -->
        <section class="terminal-section">
          <div class="terminal-header">
            <h2 class="section-title">LIVE TERMINAL (Logs)</h2>
            <div class="terminal-controls">
              <button class="terminal-btn" id="clearLogsBtn" title="Clear logs">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M4 6H16M7 6V4C7 3.45 7.45 3 8 3H12C12.55 3 13 3.45 13 4V6M9 10V15M11 10V15M6 6L5 17H15L14 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <button class="terminal-btn" id="pauseLogsBtn" title="Pause/Resume">
                <svg id="pauseIcon" width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="7" y="4" width="2" height="12" rx="1" fill="currentColor"/>
                  <rect x="11" y="4" width="2" height="12" rx="1" fill="currentColor"/>
                </svg>
                <svg id="playIcon" width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                  <path d="M7 5L15 10L7 15V5Z" fill="currentColor"/>
                </svg>
              </button>
            </div>
          </div>
          <div class="terminal-content" id="terminalContent">
            <div class="empty-state" style="padding: var(--spacing-xl); text-align: center;">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.3; margin-bottom: var(--spacing-md);">
                <rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <path d="M7 9L11 12L7 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M14 9H17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
              <p style="color: var(--text-tertiary); font-size: 13px;">Waiting for logs...</p>
            </div>
          </div>
        </section>
      </div>

      <!-- Settings View -->
      <div id="settingsView" class="view">
        <h2 class="view-title">Settings</h2>
        <div class="settings-content">
          <!-- Exchange Connection -->
          <div class="settings-card">
            <h3 class="settings-card-title">Exchange Connection</h3>
            <div class="form-group">
              <label for="exchangeSelect">Exchange</label>
              <select id="exchangeSelect" class="form-control">
                <option value="binance">Binance</option>
                <option value="alpaca">Alpaca</option>
                <option value="bybit">Bybit</option>
              </select>
            </div>
            <div class="form-group">
              <label for="apiKeyInput">API Key</label>
              <input type="password" id="apiKeyInput" class="form-control" placeholder="Enter API key">
            </div>
            <div class="form-group">
              <label for="apiSecretInput">API Secret</label>
              <input type="password" id="apiSecretInput" class="form-control" placeholder="Enter API secret">
            </div>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="testnetCheckbox">
                <span>Testnet</span>
              </label>
            </div>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="testModeCheckbox">
                <span>Test Mode</span>
                <span class="test-mode-indicator" id="testModeIndicator" style="display: none;">
                  <svg viewBox="0 0 20 20">
                    <path d="M10 2 L12 7 L17 8 L13 12 L14 17 L10 14 L6 17 L7 12 L3 8 L8 7 Z"/>
                  </svg>
                  Demo Mode Active
                </span>
              </label>
              <div class="form-help-text" style="margin-top: var(--spacing-xs); padding-left: 28px;">
                Use demo data with BTC, ETH, AAPL. No API keys required.
              </div>
            </div>
            <button class="btn-primary" id="connectExchangeBtn">Connect</button>
            <div id="exchangeStatus" class="status-message"></div>
          </div>

          <!-- Guard-Rails -->
          <div class="settings-card">
            <h3 class="settings-card-title">Guard-Rails</h3>
            <div class="form-group">
              <label for="dailyStopLossInput">Daily Stop Loss (USD)</label>
              <div class="number-input-wrapper">
                <input type="number" id="dailyStopLossInput" class="form-control" placeholder="500" min="0" step="1">
                <div class="number-input-buttons">
                  <button type="button" class="number-input-btn" data-input="dailyStopLossInput" data-action="increment" aria-label="Increase">
                    <svg viewBox="0 0 12 12">
                      <path d="M6 2 L6 10 M2 6 L10 6"/>
                    </svg>
                  </button>
                  <button type="button" class="number-input-btn" data-input="dailyStopLossInput" data-action="decrement" aria-label="Decrease">
                    <svg viewBox="0 0 12 12">
                      <path d="M2 6 L10 6"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="maxLeverageInput">Max Leverage</label>
              <div class="number-input-wrapper">
                <input type="number" id="maxLeverageInput" class="form-control" placeholder="2.0" min="0" step="0.1">
                <div class="number-input-buttons">
                  <button type="button" class="number-input-btn" data-input="maxLeverageInput" data-action="increment" aria-label="Increase">
                    <svg viewBox="0 0 12 12">
                      <path d="M6 2 L6 10 M2 6 L10 6"/>
                    </svg>
                  </button>
                  <button type="button" class="number-input-btn" data-input="maxLeverageInput" data-action="decrement" aria-label="Decrease">
                    <svg viewBox="0 0 12 12">
                      <path d="M2 6 L10 6"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="allowedSymbolsInput">Allowed Symbols (comma-separated)</label>
              <input type="text" id="allowedSymbolsInput" class="form-control" placeholder="BTC, ETH, AAPL">
            </div>
            <div class="form-group">
              <label for="maxPositionSizeInput">Max Position Size (USD)</label>
              <div class="number-input-wrapper">
                <input type="number" id="maxPositionSizeInput" class="form-control" placeholder="10000" min="0" step="1">
                <div class="number-input-buttons">
                  <button type="button" class="number-input-btn" data-input="maxPositionSizeInput" data-action="increment" aria-label="Increase">
                    <svg viewBox="0 0 12 12">
                      <path d="M6 2 L6 10 M2 6 L10 6"/>
                    </svg>
                  </button>
                  <button type="button" class="number-input-btn" data-input="maxPositionSizeInput" data-action="decrement" aria-label="Decrease">
                    <svg viewBox="0 0 12 12">
                      <path d="M2 6 L10 6"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
            <button class="btn-primary" id="saveGuardrailsBtn">Save Guard-Rails</button>
          </div>

          <!-- Strategy -->
          <div class="settings-card">
            <h3 class="settings-card-title">Strategy</h3>
            <div class="form-group">
              <label>Mode</label>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" name="strategyMode" value="conservative">
                  <span>Conservative</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="strategyMode" value="moderate" checked>
                  <span>Moderate</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="strategyMode" value="aggressive">
                  <span>Aggressive</span>
                </label>
              </div>
            </div>
            <button class="btn-primary" id="saveStrategyBtn">Save Strategy</button>
          </div>
        </div>
      </div>

      <!-- Profile View -->
      <div id="profileView" class="view">
        <h2 class="view-title">Profile</h2>
        <div class="profile-content">
          <!-- Profile Info Card -->
          <div class="profile-card">
            <div class="profile-avatar-section">
              <div class="profile-avatar-large" id="profileAvatarLarge">
                <img id="profileAvatarImg" src="" alt="Profile" style="display: none; width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">
                <svg id="profileAvatarIcon" width="48" height="48" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="10" cy="7" r="3" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <path d="M4 17C4 13 6.5 11 10 11C13.5 11 16 13 16 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
              </div>
              <label for="profileImageInput" class="profile-avatar-upload-btn">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M14 2H6C4.9 2 4 2.9 4 4V16C4 17.1 4.9 18 6 18H14C15.1 18 16 17.1 16 16V4C16 2.9 15.1 2 14 2Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                  <path d="M12 6H8M10 4V8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span>Change Photo</span>
              </label>
              <input type="file" id="profileImageInput" accept="image/*" style="display: none;">
            </div>
            <h3 id="profileName">Not signed in</h3>
            <p id="profileEmail"></p>
            <p id="profileBio" style="display: none; margin-top: var(--spacing-md);"></p>
            <div id="profileDetails" style="display: none; margin-top: var(--spacing-md); font-size: 13px; color: var(--text-tertiary);">
              <p id="profileLocation"></p>
              <p id="profileWebsite"></p>
            </div>
          </div>

          <!-- Profile Edit Form -->
          <div class="profile-card" id="profileEditCard" style="display: none;">
            <h3 class="settings-card-title">Edit Profile</h3>
            <form id="profileEditForm">
              <div class="form-group">
                <label for="editProfileName">Full Name</label>
                <input type="text" id="editProfileName" class="form-control" placeholder="John Doe" required>
              </div>
              <div class="form-group">
                <label for="editProfileEmail">Email</label>
                <input type="email" id="editProfileEmail" class="form-control" placeholder="your@email.com" required>
              </div>
              <div class="form-group">
                <label for="editProfileBio">Bio (Optional)</label>
                <textarea id="editProfileBio" class="form-control" rows="3" placeholder="Tell us about yourself..."></textarea>
              </div>
              <div class="form-group">
                <label for="editProfileLocation">Location (Optional)</label>
                <input type="text" id="editProfileLocation" class="form-control" placeholder="City, Country">
              </div>
              <div class="form-group">
                <label for="editProfileWebsite">Website (Optional)</label>
                <input type="url" id="editProfileWebsite" class="form-control" placeholder="https://yourwebsite.com">
              </div>
              <div class="form-actions">
                <button type="button" class="btn-primary btn-outline" id="cancelEditProfileBtn">Cancel</button>
                <button type="submit" class="btn-primary" id="saveProfileBtn">
                  <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17 3L7 13L3 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <span>Save Changes</span>
                </button>
              </div>
            </form>
          </div>

          <!-- Profile Actions -->
          <div class="profile-card" id="profileActionsCard">
            <h3 class="settings-card-title">Account Actions</h3>
            <div class="profile-actions">
              <button class="btn-primary btn-outline" id="editProfileBtn" onclick="showEditProfile()">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M11 4H4C3.45 4 3 4.45 3 5V16C3 16.55 3.45 17 4 17H15C15.55 17 16 16.55 16 16V9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M14.5 2.5L17.5 5.5L10.5 12.5H7.5V9.5L14.5 2.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Edit Profile</span>
              </button>
              <button class="btn-primary btn-outline" id="changePasswordBtn" onclick="showChangePasswordModal()">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="3" y="9" width="14" height="8" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <path d="M7 9V6C7 4.34 8.34 3 10 3C11.66 3 13 4.34 13 6V9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span>Change Password</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Change Password Modal -->
      <div id="changePasswordModal" class="auth-modal" style="display: none;">
        <div class="auth-modal-content">
          <div class="auth-modal-header">
            <h2>Change Password</h2>
            <button class="auth-modal-close" onclick="closeChangePasswordModal()">
              <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 5L15 15M15 5L5 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
          <div class="auth-modal-body">
            <form id="changePasswordForm" onsubmit="handleChangePassword(event)">
              <div class="form-group">
                <label for="currentPassword">Current Password</label>
                <input type="password" id="currentPassword" class="form-control" placeholder="Enter current password" required>
              </div>
              <div class="form-group">
                <label for="newPassword">New Password</label>
                <input type="password" id="newPassword" class="form-control" placeholder="Enter new password" required minlength="8">
                <small class="form-hint">Minimum 8 characters</small>
              </div>
              <div class="form-group">
                <label for="confirmNewPassword">Confirm New Password</label>
                <input type="password" id="confirmNewPassword" class="form-control" placeholder="Confirm new password" required>
              </div>
              <button type="submit" class="btn-primary btn-full">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M17 3L7 13L3 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Update Password</span>
              </button>
            </form>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Login Modal -->
  <div id="loginModal" class="auth-modal" style="display: none;">
    <div class="auth-modal-content">
      <div class="auth-modal-header">
        <h2>Sign In</h2>
        <button class="auth-modal-close" onclick="closeLoginModal()">
          <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 5L15 15M15 5L5 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
      <div class="auth-modal-body">
        <form id="loginForm" onsubmit="handleLogin(event)">
          <div class="form-group">
            <label for="loginEmail">Email</label>
            <input type="email" id="loginEmail" class="form-control" placeholder="your@email.com" required>
          </div>
          <div class="form-group">
            <label for="loginPassword">Password</label>
            <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password" required>
          </div>
          <button type="submit" class="btn-primary btn-full">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 15L13 10L8 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M13 10H2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>Sign In</span>
          </button>
        </form>
        <div class="auth-modal-footer">
          <p>Don't have an account? <a href="#" onclick="closeLoginModal(); openSignUpModal();">Sign up</a></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Sign Up Modal -->
  <div id="signUpModal" class="auth-modal" style="display: none;">
    <div class="auth-modal-content">
      <div class="auth-modal-header">
        <h2>Create Account</h2>
        <button class="auth-modal-close" onclick="closeSignUpModal()">
          <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 5L15 15M15 5L5 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
      <div class="auth-modal-body">
        <form id="signUpForm" onsubmit="handleSignUp(event)">
          <div class="form-group">
            <label for="signUpName">Full Name</label>
            <input type="text" id="signUpName" class="form-control" placeholder="John Doe" required>
          </div>
          <div class="form-group">
            <label for="signUpEmail">Email</label>
            <input type="email" id="signUpEmail" class="form-control" placeholder="your@email.com" required>
          </div>
          <div class="form-group">
            <label for="signUpPassword">Password</label>
            <input type="password" id="signUpPassword" class="form-control" placeholder="Create a strong password" required minlength="8">
            <small class="form-hint">Minimum 8 characters</small>
          </div>
          <div class="form-group">
            <label for="signUpPasswordConfirm">Confirm Password</label>
            <input type="password" id="signUpPasswordConfirm" class="form-control" placeholder="Confirm your password" required>
          </div>
          <button type="submit" class="btn-primary btn-full">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="10" cy="7" r="3" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M4 17C4 13 6.5 11 10 11C13.5 11 16 13 16 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              <path d="M15 5L15 11M12 8L18 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>Create Account</span>
          </button>
        </form>
        <div class="auth-modal-footer">
          <p>Already have an account? <a href="#" onclick="closeSignUpModal(); openLoginModal();">Sign in</a></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="quant-core.js"></script>
</body>
</html>
