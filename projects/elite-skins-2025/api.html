<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" type="image/png" href="./images/favicon.png" />
  <title>Elite Skins | A maior comunidade de skins de CS2 do Brasil</title>
  <meta name="description" content="Elite Skins: Comunidade brasileira de troca e negocia√ß√£o de skins de Counter Strike 2. Trading, premia√ß√µes e ofertas." />
  <script>
    // SCRIPT DE EMERG√äNCIA: Garantir que bot√µes sejam clic√°veis
    (function() {
      function fixAllButtons() {
        // Remover qualquer overlay bloqueante
        const blockingOverlays = document.querySelectorAll('#redirect-indicator');
        blockingOverlays.forEach(overlay => {
          const created = overlay.dataset.created;
          if (created) {
            const age = Date.now() - parseInt(created);
            if (age > 5000) { // Se tem mais de 5 segundos, remover
              console.log('Removendo overlay antigo bloqueante');
              overlay.remove();
            }
          }
        });
        
        // Garantir que TODOS os bot√µes sejam clic√°veis
        const allButtons = document.querySelectorAll('button, .btn, .api-tab, [role="button"]');
        allButtons.forEach(btn => {
          btn.style.setProperty('pointer-events', 'auto', 'important');
          btn.style.setProperty('cursor', 'pointer', 'important');
          btn.style.setProperty('z-index', '1000', 'important');
          btn.style.setProperty('position', 'relative', 'important');
          btn.removeAttribute('disabled');
        });
        
        // Garantir que elementos pais n√£o bloqueiem
        const containers = document.querySelectorAll('body, main, #auth-section');
        containers.forEach(container => {
          const style = window.getComputedStyle(container);
          if (style.pointerEvents === 'none') {
            container.style.setProperty('pointer-events', 'auto', 'important');
          }
        });
      }
      
      // Executar imediatamente
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', fixAllButtons);
      } else {
        fixAllButtons();
      }
      
      // Executar periodicamente para garantir
      setInterval(fixAllButtons, 2000);
    })();
  </script>
  <meta name="keywords" content="CS2, Counter Strike 2, skins, trading, comunidade, grupos, ofertas, premia√ß√µes" />
  <link rel="stylesheet" href="index.css" />
  <link rel="stylesheet" href="background.css" />
  <link rel="stylesheet" href="mobile.css" media="screen and (max-width: 768px)" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&family=Teko:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {

    /* Corre√ß√£o global para bot√µes rosados */
    .btn-gradient:hover, .btn-gradient:focus,
    .btn-cs2:hover, .btn-cs2:focus,
    .btn-pink:hover, .btn-pink:focus {
      background: var(--cs2-gradient-gold) !important;
      color: var(--cs2-bg-dark) !important;
      box-shadow: 0 6px 15px rgba(255, 215, 0, 0.4) !important;
    }
    .btn-blue:hover, .btn-blue:focus {
      background: linear-gradient(45deg, var(--cs2-info-blue), var(--cs2-secondary-blue)) !important;
      color: #fff !important;
      box-shadow: 0 6px 15px rgba(35, 137, 218, 0.4) !important;
    }
    .btn-green:hover, .btn-green:focus {
      background: linear-gradient(45deg, var(--cs2-accent-green), var(--cs2-bg-dark)) !important;
      color: #fff !important;
      box-shadow: 0 6px 15px rgba(75, 158, 42, 0.4) !important;
    }

      --cs2-primary-gold: #FFD700;
      --cs2-secondary-blue: #131E2B;
      --cs2-bg-dark: #0A0E12;
      --cs2-accent-orange: #FF6600;
      --cs2-text-light: #F5F5F5;
      --cs2-accent-green: #4B9E2A;
      --cs2-danger-red: #DD3333;
      --cs2-info-blue: #2389DA;
      --cs2-radial-dark: radial-gradient(circle at center, #182233 0%, #0A0E12 100%);
      --cs2-gradient-blue: linear-gradient(135deg, #131E2B 0%, #0A0E12 100%);
      --cs2-gradient-gold: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      --cs2-glitch-border: 2px solid rgba(255, 215, 0, 0.6);
      --gamer-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Rajdhani', sans-serif;
      background-color: var(--cs2-bg-dark);
      /* Background movido para o arquivo background.css */
      color: var(--cs2-text-light);
      margin: 0;
      padding: 0;
      line-height: 1.6;
      overflow-x: hidden;
    }
    
    .container {
      width: 90%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    section {
      padding: 60px 0;
    }
    
    h1, h2, h3, h4 {
      margin: 0;
      line-height: 1.3;
      color: var(--cs2-primary-gold);
    }
    
    a {
      text-decoration: none;
      color: var(--cs2-primary-gold);
      transition: all 0.3s ease;
    }
    
    a:hover {
      color: var(--cs2-accent-orange);
      text-shadow: 0 0 8px rgba(255, 102, 0, 0.5);
    }
    
    .btn {
      display: inline-block;
      padding: 10px 25px;
      font-family: 'Teko', sans-serif;
      font-size: 1.3rem;
      font-weight: 700;
      text-align: center;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
    }
    
    .btn-primary {
      background: var(--cs2-gradient-gold);
      color: var(--cs2-bg-dark);
      border: none;
      text-shadow: 0 1px 0 rgba(0,0,0,0.2);
    }
    
    .btn-primary:hover {
      background: var(--cs2-gradient-gold);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(255, 215, 0, 0.4);
      color: var(--cs2-bg-dark);
    }
    
    .btn-outline {
      background-color: rgba(255, 215, 0, 0.1);
      border: 2px solid var(--cs2-primary-gold);
      color: var(--cs2-primary-gold);
    }
    
    .btn-outline:hover {
      background: var(--cs2-gradient-gold);
      color: var(--cs2-bg-dark);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(255, 215, 0, 0.4);
      border-color: transparent;
    }
    
    .btn::after {
      content: '';
      position: absolute;
      height: 100%;
      width: 150px;
      top: 0;
      left: -150px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: 0.5s;
    }
    
    .btn:hover::after {
      left: 100%;
    }
    
    h1, h2, h3, h4 {
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--cs2-primary-gold);
      text-shadow: 0px 2px 4px rgba(0, 0, 0, 0.5);
    }
    
    h1 {
      font-size: 2.8rem;
      background: var(--cs2-gradient-gold);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 800;
    }

    .header {
      background-color: rgba(19, 30, 43, 0.9);
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 100;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
      height: auto;
      min-height: 70px;
      border-bottom: 1px solid rgba(255, 215, 0, 0.3);
      backdrop-filter: blur(10px);
    }
    
    .header-inner {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      min-height: 70px;
    }
    
    .logo {
      font-family: 'Orbitron', sans-serif;
      font-size: 28px;
      font-weight: 900;
      color: var(--cs2-primary-gold);
      letter-spacing: 2px;
      text-transform: uppercase;
      position: relative;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
      transition: all 0.3s ease;
    }
    
    .logo:hover {
      color: var(--cs2-primary-gold);
      text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
    }
    
    .logo::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 100%;
      height: 2px;
      background: var(--cs2-gradient-gold);
    }
    
    .nav {
      display: flex;
      gap: 25px;
    }
    
    .nav a {
      color: var(--cs2-text-light);
      font-weight: 600;
      font-family: 'Rajdhani', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      padding: 5px 10px;
      font-size: 1.1rem;
    }
    
    .nav a:hover {
      color: var(--cs2-primary-gold);
      text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
    }
    
    .nav a::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 10px;
      width: 0;
      height: 2px;
      background: var(--cs2-primary-gold);
      transition: width 0.3s ease;
    }
    
    .nav a:hover::before {
      width: calc(100% - 20px);
    }
  </style>
</head>

<body>
  <!-- ***** Header ***** -->
  <header class="header" id="top">
    <div class="container header-inner">
      <a href="#top" class="logo">Elite Skins</a>
      <nav class="nav">
        <a href="index.html" class="scroll-top-link">Voltar</a>
        <a href="#ofertas">Acessar Steam</a>
        <a href="#avaliacao">Avalia√ß√£o</a>
      </nav>
      <a href="#avaliacao" class="btn btn-primary">Avalia√ß√£o de Invent√°rio</a>
    </div>
  </header>

  <!-- SheetJS library for Excel export -->
  <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
  
  <!-- Plotly.js for interactive charts -->
  <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
  
  <style>
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>

  <main style="padding-top: 100px;">
  <!-- ***** Hero Section ***** -->
  <section class="hero" id="hero" style="padding-top:40px; padding-bottom:60px; position: relative; overflow: hidden;">

    <div class="container" style="display:grid; grid-template-columns: 1fr 1fr; gap:40px; position: relative; z-index: 1; max-width: 1200px; margin: 0 auto; padding: 0 20px;">
      <!-- Text Content Left Side -->
      <div style="position: relative; padding: 30px 0;">
        <!-- Corner accents -->
        <div style="position: absolute; top: 0; left: 0; width: 80px; height: 80px; border-top: 3px solid var(--cs2-primary-gold); border-left: 3px solid var(--cs2-primary-gold); opacity: 0.8; z-index: 1;"></div>
        <div style="position: absolute; bottom: 0; right: 0; width: 80px; height: 80px; border-bottom: 3px solid var(--cs2-accent-orange); border-right: 3px solid var(--cs2-accent-orange); opacity: 0.8; z-index: 1;"></div>
        
        <!-- Main content with padding for the corners -->
        <div style="padding: 35px 35px 35px 35px; position: relative; margin: 0; display: flex; flex-direction: column; align-items: flex-start; z-index: 2;">
          <!-- Main heading -->
          <h1 style="font-family: 'Orbitron', sans-serif; font-size:2.5rem; margin-bottom:1.5rem; text-transform: uppercase; line-height: 1.2; text-shadow: 0 2px 10px rgba(0,0,0,0.5); margin-top: 0; margin-left: 0; text-align: left;">
            A MAIOR <span style="color: var(--cs2-primary-gold);">COMUNIDADE</span><br>
            <span style="color: var(--cs2-accent-orange);">DE SKINS DE CS2</span><br>
            DO BRASIL
          </h1>
          
          <!-- Descriptive paragraph -->
          <p style="font-size:1.25rem; margin-bottom:2.5rem; color:var(--cs2-text-light); font-family: 'Rajdhani', sans-serif; max-width: 500px; position: relative; margin-left: 0; margin-right: 0; text-align: left;">
            Junte-se √† comunidade com mais de <span style="color:var(--cs2-primary-gold); font-weight:bold; font-size: 1.4rem;">R$ 1.000.000,00</span> movimentados em 2024. <span style="color: var(--cs2-accent-orange);">Negocia√ß√µes seguras</span> e ofertas rel√¢mpago.
          </p>
          
          <!-- CTA Buttons -->
          <div style="display:flex; gap:20px; flex-wrap:wrap; margin-top: 1rem; align-items: flex-start; width: 100%;">
            <a href="#avaliacao" class="btn btn-primary" style="font-weight: 600; padding: 12px 28px; letter-spacing: 1px;">Avalia√ß√£o de Invent√°rio</a>
          </div>

          <!-- Stats indicator -->
          <div style="margin-top: 2.5rem; display: flex; align-items: center; width: 100%;">
            <span style="display: inline-block; width: 8px; height: 8px; background: var(--cs2-accent-green); border-radius: 50%; animation: pulse 1.5s infinite; margin-right: 10px;"></span>
            <span style="color: rgba(255,255,255,0.7); font-family: 'Rajdhani', sans-serif; font-size: 0.9rem;">+560 negocia√ß√µes conclu√≠das esta semana</span>
          </div>
        </div>
      </div>
      
      <!-- Logo Right Side -->
      <div style="display: flex; align-items: center; justify-content: center; position: relative;">
        <!-- Background glow effect -->
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 350px; height: 350px; background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%); border-radius: 50%; z-index: -1;"></div>
        
        <!-- Logo container with border effect -->
        <div style="width: 320px; height: 320px; display: flex; align-items: center; justify-content: center; position: relative; background: rgba(15,20,25,0.5); border-radius: 10px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,215,0,0.1);">
          <!-- Border light effect -->
          <div style="position: absolute; inset: 0; border: 1px solid rgba(255,215,0,0.3); border-radius: 10px; box-shadow: inset 0 0 30px rgba(255,215,0,0.1); z-index: 0;"></div>
          
          <!-- Logo image with effects -->
          <img src="./images/elite_logo.png" alt="Elite Skins Logo" style="max-width: 88%; height: auto; filter: drop-shadow(0 5px 15px rgba(255,215,0,0.3)); transform: perspective(800px) rotateY(-5deg); transition: transform 0.5s ease; z-index: 1;">
        </div>
      </div>
    </div>
    
    <!-- Bottom accent line -->
    <div style="position: absolute; bottom: 0; left: 0; width: 100%; height: 5px; background: linear-gradient(90deg, var(--cs2-primary-gold), var(--cs2-accent-orange), var(--cs2-primary-gold)); opacity: 0.7;"></div>
  </section>

  <!-- ***** Se√ß√£o de Avalia√ß√£o de Invent√°rio ***** -->
  <section id="ofertas" style="background: linear-gradient(165deg, #192736 0%, #0b1015 100%); position: relative; overflow: hidden; border-top: 1px solid rgba(255,215,0,0.1); border-bottom: 1px solid rgba(255,215,0,0.1); padding: 60px 0;">
    <!-- Material design subtle diagonal accent -->
    <div style="position: absolute; top: -100px; right: -100px; width: 300px; height: 300px; background: radial-gradient(circle at top right, rgba(255,147,0,0.03) 0%, transparent 70%); z-index: 0;"></div>
    
    <!-- Material design light patterns -->
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: linear-gradient(135deg, rgba(255,215,0,0.02) 25%, transparent 25%), linear-gradient(225deg, rgba(255,215,0,0.02) 25%, transparent 25%); background-size: 60px 60px; opacity: 0.5; z-index: 0;"></div>
    
    <div class="container" style="position: relative; z-index: 1;">
      <div style="text-align:center; margin-bottom:3rem; position: relative;">
        <h2 id="avaliacao" style="text-align:center; margin-bottom:0.5rem; font-size: 2.8rem; text-transform: uppercase;">Avalia√ß√£o de Invent√°rio</h2>
        <p style="color: var(--cs2-accent-orange); font-family: 'Rajdhani', sans-serif; font-weight: 600; font-size: 1.2rem; letter-spacing: 1px; text-transform: uppercase;">Descubra o valor real de suas skins de CS2</p>
        <div style="width: 80px; height: 4px; background: var(--cs2-gradient-gold); margin: 1rem auto;"></div>
      </div>
      
      <!-- API Status Indicator -->
      <div style="display: flex; justify-content: center; align-items: center; margin-bottom: 2rem;">
        <div style="display: inline-flex; align-items: center; padding: 4px 12px; background: rgba(10,14,18,0.5); border-radius: 4px; border: 1px solid rgba(255,215,0,0.2);">
          <div id="api-status-indicator" style="width: 8px; height: 8px; border-radius: 50%; margin-right: 6px; background-color: #777;"></div>
          <span id="api-status-text" style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); font-size: 0.9rem;">Verificando status da API...</span>
        </div>
        
        <!-- Exchange Rate Indicator (NEW) -->
        <div style="display: inline-flex; align-items: center; padding: 4px 12px; background: rgba(10,14,18,0.5); border-radius: 4px; border: 1px solid rgba(255,215,0,0.2); margin-left: 10px;">
          <div id="exchange-rate-indicator" style="width: 8px; height: 8px; border-radius: 50%; margin-right: 6px; background-color: #777;"></div>
          <span id="exchange-rate-text" style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); font-size: 0.9rem;">Atualizando taxa de c√¢mbio...</span>
        </div>
      </div>
      
      <!-- Authentication Section (NEW) -->
      <div id="auth-section" style="text-align: center; margin-bottom: 2rem; background: linear-gradient(135deg, rgba(26,38,52,0.6) 0%, rgba(10,14,18,0.8) 100%); border-radius: 8px; padding: 20px; border: 1px solid rgba(255,215,0,0.2);">
        <h3 style="font-family: 'Orbitron', sans-serif; color:var(--cs2-primary-gold); margin-bottom:1rem; font-size: 1.6rem; text-transform: uppercase;">Autentica√ß√£o Steam</h3>
        <p style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); margin-bottom: 1.5rem; line-height: 1.6;">Conecte com sua conta Steam para acessar recursos avan√ßados, incluindo an√°lise completa do invent√°rio com acesso √†s Unidades de Armazenamento.</p>
        
        <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 1rem; position: relative; z-index: 100;">
          <button id="login-btn" class="btn" type="button" style="display: inline-flex !important; padding: 10px 25px; background: linear-gradient(135deg, #2f526f 0%, #1c2838 100%); color: var(--cs2-text-light); border: none; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1.1rem; cursor: pointer !important; position: relative !important; z-index: 1000 !important; pointer-events: auto !important; opacity: 1 !important;">
            <div style="display: flex; align-items: center; justify-content: center; width: 100%; pointer-events: none;">
              <img src="./images/steam.png" alt="Steam" style="height: 20px; width: 20px; display: block; margin-right: 10px; pointer-events: none;">
              <span style="display: block; pointer-events: none;">LOGIN COM STEAM</span>
            </div>
          </button>
          
          <!-- Bot√£o de teste para URL de retorno -->
          <button id="test-redirect-btn" class="btn" style="display: none; padding: 10px 25px; margin-left: 10px; background: linear-gradient(135deg, #614080 0%, #4a2c6a 100%); color: var(--cs2-text-light); border: none; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1.1rem; cursor: pointer;">
            <div style="display: flex; align-items: center; justify-content: center; width: 100%;">
              <span style="display: block;">TESTAR RETORNO</span>
            </div>
          </button>
          
          <button id="logout-btn" class="btn" style="display: none; padding: 10px 25px; background: rgba(221,51,51,0.2); color: var(--cs2-danger-red); border: 1px solid var(--cs2-danger-red); border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1.1rem; cursor: pointer;">
            Desconectar
          </button>
        </div>
        
        <div id="user-info" style="display: none; font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); background: rgba(10,14,18,0.5); padding: 8px 12px; border-radius: 4px; display: inline-block; margin-top: 10px;"></div>
        
        <!-- Bot√£o para analisar pr√≥prio invent√°rio (aparece apenas quando logado) -->
        <div id="my-inventory-btn-container" style="display: none; margin-top: 15px;">
          <button id="my-inventory-btn" class="btn btn-primary" style="padding: 12px 28px; background: linear-gradient(135deg, var(--cs2-primary-gold) 0%, var(--cs2-accent-orange) 100%); color: var(--cs2-bg-dark); border: none; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1.1rem; font-weight: 600; cursor: pointer; text-transform: uppercase; letter-spacing: 1px;">
            Analisar Meu Invent√°rio
          </button>
        </div>
      </div>
      
      <!-- API Tabs -->
      <div style="position: relative; margin-top: 2rem;">
        <div style="display: flex; border-bottom: 1px solid rgba(255,215,0,0.2); flex-wrap: wrap;">
          <button class="api-tab active" data-tab="inventory" style="font-family: 'Rajdhani', sans-serif; padding: 10px 20px; margin-right: 5px; background: none; border: none; color: var(--cs2-primary-gold); font-size: 1.1rem; font-weight: 600; cursor: pointer; position: relative; letter-spacing: 1px; transition: all 0.3s ease;">INVENT√ÅRIO</button>
          <button class="api-tab" data-tab="price" style="font-family: 'Rajdhani', sans-serif; padding: 10px 20px; margin-right: 5px; background: none; border: none; color: var(--cs2-text-light); font-size: 1.1rem; font-weight: 600; cursor: pointer; position: relative; letter-spacing: 1px; transition: all 0.3s ease;">PRE√áO DE SKIN</button>
        </div>
        
        <!-- Tab Content -->
        <div style="margin-top: 2rem; background: linear-gradient(135deg, rgba(26,38,52,0.6) 0%, rgba(10,14,18,0.8) 100%); border: 1px solid rgba(255,215,0,0.2); border-radius: 8px; padding: 30px; position: relative; overflow: hidden;">
          <!-- Glowing corner effect -->
          <div style="position: absolute; top: -2px; left: -2px; width: 20px; height: 20px; border-top: 2px solid var(--cs2-primary-gold); opacity: 0.7;"></div>
          <div style="position: absolute; bottom: -2px; right: -2px; width: 20px; height: 20px; border-bottom: 2px solid var(--cs2-primary-gold); border-right: 2px solid var(--cs2-primary-gold); opacity: 0.7;"></div>
          
          <!-- Tab 1: Invent√°rio -->
          <div class="tab-content active" id="inventory-tab">
            <div>
              <h3 style="font-family: 'Orbitron', sans-serif; color:var(--cs2-primary-gold); margin-bottom:1.5rem; font-size: 1.6rem; text-transform: uppercase; text-align: center;">An√°lise de Invent√°rio</h3>
              <p style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); margin-bottom: 1.5rem; line-height: 1.6; text-align: center;">Conecte sua conta Steam para obter uma an√°lise completa do seu invent√°rio de CS2, incluindo o valor total, itens mais valiosos e estat√≠sticas detalhadas.</p>
              
              <div id="auth-section-container" style="display: none; flex-direction: column; align-items: center; justify-content: center; margin: 2rem 0;">
                <!-- Autentica√ß√£o Steam - Vers√£o destaque -->
                <div id="auth-section-highlight" style="text-align: center; margin-bottom: 2rem; background: linear-gradient(135deg, rgba(26,38,52,0.8) 0%, rgba(10,14,18,0.9) 100%); border-radius: 8px; padding: 30px; border: 1px solid rgba(255,215,0,0.3); max-width: 600px; width: 100%;">
                  <h3 style="font-family: 'Orbitron', sans-serif; color:var(--cs2-primary-gold); margin-bottom:1rem; font-size: 1.6rem; text-transform: uppercase;">Autentica√ß√£o Steam</h3>
                  <p style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); margin-bottom: 1.5rem; line-height: 1.6;">Conecte com sua conta Steam para acessar recursos avan√ßados, incluindo an√°lise completa do invent√°rio com acesso √†s Unidades de Armazenamento.</p>
                  
                  <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 1rem;">
                    <button class="login-btn-secondary btn" style="display: inline-flex; padding: 12px 30px; background: linear-gradient(135deg, #2f526f 0%, #1c2838 100%); color: var(--cs2-text-light); border: none; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1.2rem; cursor: pointer;">
                      <div style="display: flex; align-items: center; justify-content: center; width: 100%;">
                        <img src="./images/steam.png" alt="Steam" style="height: 20px; width: 20px; display: block; margin-right: 10px;">
                        <span style="display: block;">LOGIN COM STEAM</span>
                      </div>
                    </button>
                    
                    <button class="logout-btn-secondary btn" style="display: none; padding: 12px 30px; background: rgba(221,51,51,0.2); color: var(--cs2-danger-red); border: 1px solid var(--cs2-danger-red); border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1.2rem; cursor: pointer;">
                      Desconectar
                    </button>
                  </div>
                  
                  <div id="user-info" style="display: none; font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); background: rgba(10,14,18,0.5); padding: 12px 20px; border-radius: 4px; display: inline-block; margin-top: 15px; font-size: 1.1rem;"></div>
                </div>
                
                <!-- Bot√£o para analisar pr√≥prio invent√°rio (aparece apenas quando logado) -->
                <div id="my-inventory-btn-container" style="display: none; margin-top: 15px; text-align: center;">
                  <button id="my-inventory-btn" class="btn btn-primary" style="padding: 15px 40px; background: linear-gradient(135deg, var(--cs2-primary-gold) 0%, var(--cs2-accent-orange) 100%); color: var(--cs2-bg-dark); border: none; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1.3rem; font-weight: 600; cursor: pointer; text-transform: uppercase; letter-spacing: 1px;">
                    Analisar Meu Invent√°rio
                  </button>
                  <p style="margin-top: 10px; color: var(--cs2-text-light); font-family: 'Rajdhani', sans-serif; font-size: 0.9rem; opacity: 0.7;">
                    An√°lise completa incluindo conte√∫do das Unidades de Armazenamento
                  </p>
                </div>
              </div>
              
              <div id="inventory-result" style="opacity: 0; display: flex; flex-direction: column; background: rgba(10,14,18,0.5); border-radius: 8px; border: 1px solid rgba(255,215,0,0.2); padding: 20px; transition: opacity 0.5s ease; max-width: 95%; width: 100%; margin: 0 auto;">
                <div id="inventory-loading" style="display: none; text-align: center; padding: 2rem;">
                  <div style="border: 4px solid rgba(255,215,0,0.1); border-left: 4px solid var(--cs2-primary-gold); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
                  <p style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light);">Analisando invent√°rio...</p>
                </div>
                
                <div id="inventory-data" style="display: none; height: 100%;">
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; border-bottom: 1px solid rgba(255,215,0,0.2); padding-bottom: 10px;">
                    <h4 style="font-family: 'Orbitron', sans-serif; color: var(--cs2-primary-gold); margin: 0; font-size: 1.2rem;">An√°lise de Invent√°rio</h4>
                    <span id="inventory-total-value" style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-accent-orange); font-weight: 700; font-size: 1.3rem;">R$ 0,00</span>
                  </div>
                  
                  <div id="export-button-container" style="text-align: right; margin-bottom: 15px;">
                    <button id="export-excel-btn" class="btn" style="padding: 6px 12px; background: linear-gradient(to right, #4B9E2A, #2f7c1e); color: white; border: none; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 0.9rem; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center;">
                      <span style="margin-right: 5px;">üìä</span> Exportar para Excel
                    </button>
                    <button id="generate-dashboard-btn" class="btn" style="margin-left: 10px; padding: 6px 12px; background: linear-gradient(to right, #2389DA, #1a6ca8); color: white; border: none; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 0.9rem; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center;">
                      <span style="margin-right: 5px;">üìà</span> Dashboard Interativa
                    </button>
                  </div>
                  
                  <div style="overflow-y: auto; flex: 1; padding-right: 10px;">
                    <div id="inventory-summary"></div>
                    <div id="inventory-items" style="margin-top: 1rem; max-height: 350px; overflow-y: auto; padding-right: 10px;"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Tab 2: Pre√ßo de Skin -->
          <div class="tab-content" id="price-tab" style="display: none;">
            <!-- Conte√∫do tab pre√ßo permanece igual -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
              <div>
                <h3 style="font-family: 'Orbitron', sans-serif; color:var(--cs2-primary-gold); margin-bottom:1.5rem; font-size: 1.6rem; text-transform: uppercase;">Pre√ßo de Skin</h3>
                <p style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); margin-bottom: 1.5rem; line-height: 1.6;">Consulte o pre√ßo atualizado de qualquer skin do CS2. Basta inserir o nome exato (market hash name) da skin para obter seu valor atual no mercado.</p>
                
                <div style="margin-bottom: 1.5rem;">
                  <label for="skin-name" style="display: block; font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); margin-bottom: 5px; font-weight: 600;">Nome da Skin:</label>
                  <div style="display: flex;">
                    <input type="text" id="skin-name" placeholder="Ex: AK-47 | Redline (Factory New)" style="flex: 1; background: rgba(10,14,18,0.7); border: 1px solid rgba(255,215,0,0.3); padding: 10px 15px; color: var(--cs2-text-light); font-family: 'Rajdhani', sans-serif; border-radius: 4px; font-size: 1rem;">
                    <button id="price-btn" class="btn btn-primary" style="margin-left: 10px; text-transform: uppercase; padding: 10px 20px; background: var(--cs2-gradient-gold); color: var(--cs2-bg-dark); border: none; font-family: 'Teko', sans-serif; font-size: 1.2rem; cursor: pointer; clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);">Buscar</button>
                  </div>
                </div>
                
                <div style="margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                  <label style="display: flex; align-items: center; cursor: pointer; font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); font-size: 1rem;">
                    <input type="checkbox" id="stattrak-checkbox" style="width: 20px; height: 20px; margin-right: 8px; cursor: pointer; accent-color: var(--cs2-primary-gold);">
                    <span style="display: flex; align-items: center; gap: 5px;">
                      <span style="color: var(--cs2-primary-gold); font-weight: 600;">StatTrak‚Ñ¢</span>
                      <span style="opacity: 0.7; font-size: 0.9rem;">(Buscar vers√£o StatTrak)</span>
                    </span>
                  </label>
                </div>
                
                <div style="margin-top: 1.5rem;">
                  <p style="font-family: 'Rajdhani', sans-serif; color: rgba(255,255,255,0.6); font-size: 0.9rem; font-style: italic;">* Formato: "Arma | Nome da Skin (Desgaste)"<br>Exemplos: "AK-47 | Redline (Factory New)", "AWP | Asiimov (Field-Tested)"<br>Voc√™ pode marcar StatTrak‚Ñ¢ ou incluir no nome da skin</p>
                </div>
              </div>
              
              <div>
                <div id="price-result" style="opacity: 0; height: 100%; display: flex; flex-direction: column; background: rgba(10,14,18,0.5); border-radius: 8px; border: 1px solid rgba(255,215,0,0.2); padding: 20px; transition: opacity 0.5s ease;">
                  <div id="price-loading" style="display: none; text-align: center; padding: 2rem;">
                    <div style="border: 4px solid rgba(255,215,0,0.1); border-left: 4px solid var(--cs2-primary-gold); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
                    <p style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light);">Buscando pre√ßo...</p>
                  </div>
                  
                  <div id="price-data" style="display: none; height: 100%;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; border-bottom: 1px solid rgba(255,215,0,0.2); padding-bottom: 10px;">
                      <h4 style="font-family: 'Orbitron', sans-serif; color: var(--cs2-primary-gold); margin: 0; font-size: 1.2rem;">Informa√ß√µes da Skin</h4>
                    </div>
                    
                    <div id="price-info" style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light);"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          

        </div>
      </div>
    </div>
    
    <style>
      @keyframes pulse {
        0% { opacity: 0.4; }
        50% { opacity: 1; }
        100% { opacity: 0.4; }
      }
      
      @keyframes blink {
        0% { opacity: 0.6; }
        50% { opacity: 1; }
        100% { opacity: 0.6; }
      }
    </style>
  </section>

  </main>

  <!-- ***** Footer ***** -->
  <footer style="color:var(--cs2-text-light); padding:4rem 0 3rem; position: relative; overflow: hidden; border-top: 1px solid rgba(255,215,0,0.15);">
    <!-- Background image - header -->
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('./images/backgrounds/header.jpg'); background-size: cover; background-position: center; opacity: 0.5; z-index: 0;"></div>
    
    <!-- Gradient overlay -->
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(10,14,18,0.85) 0%, rgba(10,14,18,0.95) 100%); z-index: 0;"></div>
    
    <!-- Material design top edge highlight -->
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 1px; background: linear-gradient(to right, transparent, rgba(255,255,255,0.05), transparent); z-index: 0;"></div>
    
    <div class="container" style="position: relative; z-index: 1;">
      <div style="display:flex; flex-wrap:wrap; justify-content:space-between; gap:2.5rem;">
        <!-- About section -->
        <div style="flex:1 1 300px;">
          <h3 style="color:var(--cs2-primary-gold); margin-bottom:1.5rem; font-family: 'Orbitron', sans-serif; text-transform: uppercase; font-size: 1.5rem; letter-spacing: 1px; position: relative; display: inline-block;">
            <span style="position: relative; z-index: 1;">Elite Skins</span>
            <span style="position: absolute; bottom: -5px; left: 0; width: 100%; height: 3px; background: var(--cs2-primary-gold); opacity: 0.5;"></span>
          </h3>
          
          <p style="margin-bottom:1.5rem; font-family: 'Rajdhani', sans-serif; font-size: 1.1rem; line-height: 1.5;">A maior comunidade de skins de CS2 do Brasil. Trading, ofertas e premia√ß√µes todos os dias! <span style="color: var(--cs2-primary-gold); font-weight: 600;">Junte-se a n√≥s.</span></p>
          
          <div style="display:flex; gap:1.2rem; margin-top: 2rem;">
            <a href="https://www.instagram.com/eliteskins1/" target="_blank" style="color:var(--cs2-text-light); font-size:1.5rem; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, rgba(26,38,52,0.6) 0%, rgba(10,14,18,0.8) 100%); border-radius: 8px; border: 1px solid rgba(255,215,0,0.2); transition: transform 0.3s ease, box-shadow 0.3s ease;" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 15px rgba(0,0,0,0.3)';this.style.color='var(--cs2-info-blue)';" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none';this.style.color='var(--cs2-text-light)';">
              <img src="./images/instagram.png" alt="Instagram" style="width: 20px; height: 20px;">
            </a>
            
            <a href="https://api.whatsapp.com/send?phone=5511999999999" target="_blank" style="color:var(--cs2-text-light); font-size:1.5rem; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, rgba(26,38,52,0.6) 0%, rgba(10,14,18,0.8) 100%); border-radius: 8px; border: 1px solid rgba(255,215,0,0.2); transition: transform 0.3s ease, box-shadow 0.3s ease;" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 15px rgba(0,0,0,0.3)';this.style.color='var(--cs2-accent-green)';" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none';this.style.color='var(--cs2-text-light)';">
              <img src="./images/whatsapp.png" alt="WhatsApp" style="width: 20px; height: 20px;">
            </a>
            
            <a href="mailto:suporteeliteskins@gmail.com" style="color:var(--cs2-text-light); font-size:1.5rem; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, rgba(26,38,52,0.6) 0%, rgba(10,14,18,0.8) 100%); border-radius: 8px; border: 1px solid rgba(255,215,0,0.2); transition: transform 0.3s ease, box-shadow 0.3s ease;" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 15px rgba(0,0,0,0.3)';this.style.color='var(--cs2-primary-gold)';" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none';this.style.color='var(--cs2-text-light)';">
              <img src="./images/email.png" alt="Email" style="width: 20px; height: 20px;">
            </a>
          </div>
        </div>
        
        <!-- Quick Links -->
        <div style="flex:1 1 200px;">
          <h3 style="color:var(--cs2-info-blue); margin-bottom:1.5rem; font-family: 'Orbitron', sans-serif; text-transform: uppercase; font-size: 1.5rem; letter-spacing: 1px; position: relative; display: inline-block;">
            <span style="position: relative; z-index: 1;">Links R√°pidos</span>
            <span style="position: absolute; bottom: -5px; left: 0; width: 100%; height: 3px; background: var(--cs2-info-blue); opacity: 0.5;"></span>
          </h3>
          
          <ul style="list-style:none; padding:0; font-family: 'Rajdhani', sans-serif; font-size: 1.1rem;">
            <li style="margin-bottom:0.8rem;">
              <a href="#top" class="scroll-top-link" style="color:var(--cs2-text-light); text-decoration: none; display: flex; align-items: center; transition: transform 0.2s ease, color 0.2s ease;" onmouseover="this.style.color='var(--cs2-primary-gold)';this.style.transform='translateX(5px)';" onmouseout="this.style.color='var(--cs2-text-light)';this.style.transform='translateX(0)';">
                <span style="display: inline-block; width: 8px; height: 8px; background: var(--cs2-info-blue); margin-right: 10px; clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0 50%);"></span> In√≠cio
              </a>
            </li>
            <li style="margin-bottom:0.8rem;">
              <a href="#ofertas" style="color:var(--cs2-text-light); text-decoration: none; display: flex; align-items: center; transition: transform 0.2s ease, color 0.2s ease;" onmouseover="this.style.color='var(--cs2-primary-gold)';this.style.transform='translateX(5px)';" onmouseout="this.style.color='var(--cs2-text-light)';this.style.transform='translateX(0)';">
                <span style="display: inline-block; width: 8px; height: 8px; background: var(--cs2-accent-orange); margin-right: 10px; clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);"></span> Acessar Steam
              </a>
            </li>
            <li style="margin-bottom:0.8rem;">
              <a href="#avaliacao" style="color:var(--cs2-text-light); text-decoration: none; display: flex; align-items: center; transition: transform 0.2s ease, color 0.2s ease;" onmouseover="this.style.color='var(--cs2-primary-gold)';this.style.transform='translateX(5px)';" onmouseout="this.style.color='var(--cs2-text-light)';this.style.transform='translateX(0)';">
                <span style="display: inline-block; width: 8px; height: 8px; background: var(--cs2-accent-green); margin-right: 10px; clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);"></span> Avalia√ß√£o
              </a>
            </li>
          </ul>
        </div>
        
        <!-- Legal -->
        <div style="flex:1 1 300px;">
          <h3 style="color:var(--cs2-accent-green); margin-bottom:1.5rem; font-family: 'Orbitron', sans-serif; text-transform: uppercase; font-size: 1.5rem; letter-spacing: 1px; position: relative; display: inline-block;">
            <span style="position: relative; z-index: 1;">Aviso Legal</span>
            <span style="position: absolute; bottom: -5px; left: 0; width: 100%; height: 3px; background: var(--cs2-accent-green); opacity: 0.5;"></span>
          </h3>
          
          <p style="margin-bottom:1.5rem; font-family: 'Rajdhani', sans-serif; font-size: 1rem; background: rgba(10,14,18,0.5); padding: 15px; border-radius: 8px; border-left: 3px solid var(--cs2-primary-gold);">Elite Skins n√£o √© afiliada √† Valve ou ao Counter-Strike 2. Todas as marcas e nomes de produtos s√£o marcas comerciais de seus respectivos propriet√°rios.</p>
          
          <div style="font-family: 'Rajdhani', sans-serif; font-size: 1rem; margin-top: 2rem; display: flex; align-items: center;">
            <img src="./images/elite_logo.png" alt="Elite Skins Logo" style="height: 35px; margin-right: 10px; opacity: 0.8;">
            <p style="margin: 0; opacity: 0.8;">&copy; 2025 Elite Skins. Todos os direitos reservados.</p>
          </div>
        </div>
      </div>
      
      <!-- Copyright -->
      <div style="margin-top: 3rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.05); text-align: center; font-family: 'Rajdhani', sans-serif; font-size: 1rem; color: rgba(255,255,255,0.5);">
        &copy; 2024 Elite Skins. Todos os direitos reservados.
      </div>
    </div>
  </footer>

  <script>
    // Countdown timer for eventos
    document.addEventListener('DOMContentLoaded', function() {
      // Get all countdown elements
      const countdownElements = document.querySelectorAll('[id^="countdown-"]');
      
      // Update countdown function
      function updateCountdown() {
        countdownElements.forEach(el => {
          // Get random time values for demo purposes
          const hours = Math.floor(Math.random() * 6);
          const minutes = Math.floor(Math.random() * 60);
          const seconds = Math.floor(Math.random() * 60);
          
          // Format time with leading zeros
          const formattedHours = hours.toString().padStart(2, '0');
          const formattedMinutes = minutes.toString().padStart(2, '0');
          const formattedSeconds = seconds.toString().padStart(2, '0');
          
          // Display time
          el.textContent = `${formattedHours}:${formattedMinutes}:${formattedSeconds}`;
        });
      }
      
      // Update countdown every 60 seconds
      updateCountdown();
      setInterval(updateCountdown, 60000);
    });
    
    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', function() {
      const menuToggle = document.querySelector('.menu-toggle');
      const nav = document.querySelector('.nav');
      
      if (menuToggle && nav) {
        menuToggle.addEventListener('click', function() {
          nav.classList.toggle('active');
          menuToggle.classList.toggle('active');
        });
      }
    });
    
    // Hover effects for cards
    document.addEventListener('DOMContentLoaded', function() {
      const cards = document.querySelectorAll('[style*="box-shadow: 0 8px 20px"]');
      
      cards.forEach(card => {
        card.addEventListener('mouseenter', function() {
          this.style.transform = 'translateY(-5px)';
          this.style.boxShadow = '0 15px 30px rgba(0,0,0,0.5)';
          
          // Find border and change it
          if (this.style.border) {
            this.style.borderColor = 'var(--cs2-primary-gold)';
          }
          
          // Find hover effect div and change opacity
          const hoverEffect = this.querySelector('[style*="position: absolute"][style*="opacity: 0"]');
          if (hoverEffect) {
            hoverEffect.style.opacity = '1';
          }
        });
        
        card.addEventListener('mouseleave', function() {
          this.style.transform = 'translateY(0)';
          this.style.boxShadow = '0 8px 20px rgba(0,0,0,0.4)';
          
          // Reset border
          if (this.style.border) {
            this.style.borderColor = 'rgba(255,215,0,0.2)';
          }
          
          // Reset hover effect
          const hoverEffect = this.querySelector('[style*="position: absolute"][style*="opacity: 1"]');
          if (hoverEffect) {
            hoverEffect.style.opacity = '0';
          }
        });
      });
    });
    
    // API Interface Scripts
    // Declarar fun√ß√£o global ANTES do DOMContentLoaded para garantir que esteja dispon√≠vel
    window.loginWithSteam = function() {
      console.log('=== loginWithSteam chamado (vers√£o global) ===');
      // Esta ser√° sobrescrita pela vers√£o completa depois, mas serve como fallback
      alert('Carregando... Por favor, aguarde o carregamento completo da p√°gina.');
    };
    
    document.addEventListener('DOMContentLoaded', function() {
      // Detecta ambiente: localhost ou produ√ß√£o
      const isLocalhost = window.location.hostname === 'localhost' || 
                           window.location.hostname === '127.0.0.1';
      
      // For√ßar o uso da API de produ√ß√£o
      const forceProduction = true; // Defina como false para voltar ao comportamento normal
      
      // Base URL da API no Render (produ√ß√£o)
      const API_BASE_URL_RENDER = 'https://cs2-valuation-api-1.onrender.com';
      
      // Base URL da API - Ser√° diferente dependendo do ambiente
      const API_BASE_URL = (forceProduction || !isLocalhost) 
                         ? API_BASE_URL_RENDER  // Ambiente de produ√ß√£o no Render
                         : 'http://localhost:8000';  // Ambiente de desenvolvimento
      
      console.log(`Ambiente detectado: ${isLocalhost ? 'Desenvolvimento local' : 'Produ√ß√£o'}`);
      console.log(`Usando API: ${API_BASE_URL} (Render)`);
      
      // Auth token para armazenar ap√≥s login
      let authToken = localStorage.getItem('steamAuthToken');
      
      // Vari√°vel para armazenar os dados do invent√°rio para exporta√ß√£o
      let lastInventoryData = null;
      
      // Elementos da p√°gina
      const apiStatusIndicator = document.getElementById('api-status-indicator');
      const apiStatusText = document.getElementById('api-status-text');
      const tabs = document.querySelectorAll('.api-tab');
      const tabContents = document.querySelectorAll('.tab-content');
      
      // Elementos da tab Invent√°rio
      const inventoryResult = document.getElementById('inventory-result');
      const inventoryLoading = document.getElementById('inventory-loading');
      const inventoryData = document.getElementById('inventory-data');
      const inventoryTotalValue = document.getElementById('inventory-total-value');
      const inventorySummary = document.getElementById('inventory-summary');
      const inventoryItems = document.getElementById('inventory-items');
      const exportExcelBtn = document.getElementById('export-excel-btn');
      
      // Elementos da tab Pre√ßo
      const skinNameInput = document.getElementById('skin-name');
      const priceBtn = document.getElementById('price-btn');
      const priceResult = document.getElementById('price-result');
      const priceLoading = document.getElementById('price-loading');
      const priceData = document.getElementById('price-data');
      const priceInfo = document.getElementById('price-info');
      

      
      // Elementos da autentica√ß√£o (adicionados)
      const authSection = document.getElementById('auth-section');
      const loginBtn = document.getElementById('login-btn');
      const logoutBtn = document.getElementById('logout-btn');
      const userInfo = document.getElementById('user-info');
      
      // Fun√ß√£o auxiliar para fazer requisi√ß√µes com headers personalizados
      async function fetchWithHeaders(endpoint, options = {}) {
          const defaultOptions = {
              method: 'GET',
              headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'application/json',
                  'Cache-Control': 'no-cache, no-store, must-revalidate',
                  'Pragma': 'no-cache',
                  'Expires': '0'
              },
              credentials: 'same-origin',
              cache: 'no-cache',
              mode: 'cors' // Sempre usar modo CORS para todas as requisi√ß√µes
          };

          // Mesclar op√ß√µes padr√£o com as fornecidas
          const mergedOptions = {
              ...defaultOptions,
              ...options,
              headers: {
                  ...defaultOptions.headers,
                  ...(options.headers || {})
              }
          };

          // Fazer a requisi√ß√£o
          const response = await fetch(endpoint, mergedOptions);
          console.log(`Status da resposta: ${response.status}`);

          // Se a resposta n√£o for 2xx, lan√ßar erro
          if (!response.ok) {
              // Tentar obter detalhes do erro da resposta
              let errorMessage;
              try {
                  const errorData = await response.json();
                  errorMessage = errorData.error || errorData.detail || errorData.message || `Erro ${response.status}`;
              } catch (e) {
                  errorMessage = `Erro ${response.status}: ${response.statusText}`;
              }
              
              throw new Error(errorMessage);
          }

          // Verificar se a resposta est√° vazia
          const contentType = response.headers.get('content-type');
          if (contentType && contentType.includes('application/json')) {
              return await response.json();
          } else {
              return await response.text();
          }
      }
      
      // Verificar status da API
      function checkApiStatus() {
        // Tentar diferentes endpoints que podem existir na API
        const possibleEndpoints = [
          '/api/status',  // Endpoint de status da API
          '/healthcheck', // Health check
          '/',           // Endpoint raiz
          '/docs'        // Documenta√ß√£o Swagger
        ];
        
        let currentEndpointIndex = 0;
        
        function tryNextEndpoint() {
          if (currentEndpointIndex >= possibleEndpoints.length) {
            // Todos os endpoints falharam, considerar API offline
            console.warn('Nenhum endpoint respondeu, considerando API offline');
            if (apiStatusIndicator) {
              apiStatusIndicator.style.backgroundColor = 'var(--cs2-danger-red)';
              apiStatusText.textContent = 'API offline';
            }
            addRetryButton();
            loadDefaultData();
            return;
          }
          
          const endpoint = possibleEndpoints[currentEndpointIndex];
          const statusEndpoint = `${API_BASE_URL}${endpoint}`;
          console.log(`Verificando status da API em: ${statusEndpoint}`);
          
          // Ativar indicador visual de verifica√ß√£o
          if (apiStatusIndicator) {
            apiStatusIndicator.style.backgroundColor = '#777';
            apiStatusText.textContent = 'Verificando API...';
          }
          
          // Tentar fazer requisi√ß√£o
          fetch(`${statusEndpoint}?_=${Date.now()}`, {
            method: 'GET',
            mode: 'cors',
            cache: 'no-cache',
            credentials: 'omit'
          })
          .then(response => {
            // Se recebeu qualquer resposta (mesmo erro), a API est√° online
            console.log(`API respondeu com sucesso no endpoint ${endpoint} (status: ${response.status})`);
            if (apiStatusIndicator) {
              apiStatusIndicator.style.backgroundColor = 'var(--cs2-accent-green)';
              apiStatusText.textContent = 'API online';
            }
            
            // Remover bot√£o de retry se existir
            const retryButton = document.getElementById('api-status-retry-btn');
            if (retryButton && retryButton.parentNode) {
              retryButton.parentNode.removeChild(retryButton);
            }
            
            loadCases(); // Carrega a lista de caixas se a API estiver online
          })
          .catch(error => {
            console.log(`Endpoint ${endpoint} falhou, tentando pr√≥ximo...`);
            currentEndpointIndex++;
            tryNextEndpoint();
          });
        }
        
        // Iniciar tentativas
        tryNextEndpoint();
      }
      
      // M√©todo de fallback para verificar API status usando script
      function checkApiStatusFallback() {
        console.log('Tentando m√©todo alternativo para verificar status da API');
        
        // Criar um elemento de script para JSONP
        const script = document.createElement('script');
        const callbackName = 'apiStatusCallback_' + Date.now();
        const timestamp = Date.now();
        
        // Definir uma fun√ß√£o global tempor√°ria para callback
        window[callbackName] = function(data) {
          console.log('API respondeu com sucesso (via JSONP)');
          apiStatusIndicator.style.backgroundColor = 'var(--cs2-accent-green)';
          apiStatusText.textContent = 'API online | DB: Conectado';
          
          // Remover bot√£o de retry se existir
          const retryButton = document.getElementById('api-status-retry-btn');
          if (retryButton && retryButton.parentNode) {
            retryButton.parentNode.removeChild(retryButton);
          }
          
          loadCases(); // Carrega a lista de caixas se a API estiver online
          
          // Limpar a fun√ß√£o global
          delete window[callbackName];
          
          // Remover o script
          if (script.parentNode) {
            script.parentNode.removeChild(script);
          }
        };
        
        // Configurar timeout local para o script
        const scriptTimeout = setTimeout(() => {
          console.error('Erro ao verificar status da API via JSONP: Timeout');
          // Remover a fun√ß√£o global
          delete window[callbackName];
          
          // Tentar terceiro m√©todo de fallback usando iframe
          checkApiStatusFallbackIframe();
        }, 10000);
        
        // Quando o script falhar
        script.onerror = function() {
          clearTimeout(scriptTimeout);
          console.error('Erro ao verificar status da API via JSONP: Falha no script');
          
          // Remover a fun√ß√£o global
          delete window[callbackName];
          
          // Tentar terceiro m√©todo de fallback usando iframe
          checkApiStatusFallbackIframe();
        };
        
        // Configurar URL do script
        script.src = `${API_BASE_URL}/api/status?callback=${callbackName}&_=${timestamp}`;
        
        // Adicionar o script ao documento
        document.head.appendChild(script);
      }
      
      // M√©todo de fallback usando iframe (final)
      function checkApiStatusFallbackIframe() {
        console.log('Tentando m√©todo final para verificar status da API (iframe)');
        
        // Criar um iframe invis√≠vel
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.id = 'api-status-iframe';
        
        // Definir timeout
        const iframeTimeout = setTimeout(() => {
          console.error('Erro ao verificar status da API via iframe: Timeout');
          apiStatusIndicator.style.backgroundColor = 'var(--cs2-danger-red)';
          apiStatusText.textContent = 'API offline';
          
          // Remover iframe
          if (iframe.parentNode) {
            document.body.removeChild(iframe);
          }
          
          // Adicionar bot√£o de retry
          addRetryButton();
          
          // Inicializar de qualquer forma para permitir uso offline
          loadDefaultData();
        }, 10000);
        
        // Evento de carga
        iframe.onload = function() {
          clearTimeout(iframeTimeout);
          console.log('API respondeu com sucesso (via iframe)');
          apiStatusIndicator.style.backgroundColor = 'var(--cs2-accent-green)';
          apiStatusText.textContent = 'API online | DB: Conectado';
          
          // Remover bot√£o de retry se existir
          const retryButton = document.getElementById('api-status-retry-btn');
          if (retryButton && retryButton.parentNode) {
            retryButton.parentNode.removeChild(retryButton);
          }
          
          // Remover iframe
          document.body.removeChild(iframe);
          
          loadCases(); // Carrega a lista de caixas se a API estiver online
        };
        
        // Evento de erro
        iframe.onerror = function() {
          clearTimeout(iframeTimeout);
          console.error('Erro ao verificar status da API via iframe: Falha ao carregar');
          apiStatusIndicator.style.backgroundColor = 'var(--cs2-danger-red)';
          apiStatusText.textContent = 'API offline';
          
          // Remover iframe
          if (iframe.parentNode) {
            document.body.removeChild(iframe);
          }
          
          // Adicionar bot√£o de retry
          addRetryButton();
          
          // Inicializar de qualquer forma para permitir uso offline
          loadDefaultData();
        };
        
        // Configurar URL do iframe
        iframe.src = `${API_BASE_URL}/api/status?iframe=true&_=${Date.now()}`;
        
        // Adicionar iframe ao documento
        document.body.appendChild(iframe);
      }
      
      // Carregar dados padr√£o para opera√ß√£o offline
      function loadDefaultData() {
        console.log('Carregando dados padr√£o para opera√ß√£o offline');
        // A funcionalidade de caixas foi removida
      }
      
      // Fun√ß√£o para adicionar bot√£o de retry
      function addRetryButton() {
        // Apenas adicionar se n√£o existir
        if (!document.getElementById('api-status-retry-btn')) {
          const retryButton = document.createElement('button');
          retryButton.textContent = 'Reconectar';
          retryButton.id = 'api-status-retry-btn';
          retryButton.style.marginLeft = '8px';
          retryButton.style.padding = '2px 6px';
          retryButton.style.fontSize = '0.8rem';
          retryButton.style.backgroundColor = 'rgba(255,255,255,0.1)';
          retryButton.style.border = '1px solid rgba(255,255,255,0.3)';
          retryButton.style.borderRadius = '2px';
          retryButton.style.color = 'var(--cs2-text-light)';
          retryButton.style.cursor = 'pointer';
          
          retryButton.addEventListener('click', () => {
            apiStatusText.textContent = 'Reconectando...';
            // Remover o bot√£o ao tentar novamente
            if (retryButton.parentNode) {
              retryButton.parentNode.removeChild(retryButton);
            }
            // Tentar novamente ap√≥s 500ms
            setTimeout(checkApiStatus, 500);
          });
          
          if (apiStatusText && apiStatusText.parentNode) {
            apiStatusText.parentNode.appendChild(retryButton);
          }
        }
      }
      
      // Verificar estado de autentica√ß√£o
      function checkAuthStatus() {
        if (authToken) {
          // Mostrar elementos de usu√°rio logado
          if (loginBtn) loginBtn.style.display = 'none';
          if (logoutBtn) logoutBtn.style.display = 'inline-block';
          if (userInfo) userInfo.style.display = 'block';
          
          // Atualizar bot√µes secund√°rios tamb√©m
          const loginButtonsSecondary = document.querySelectorAll('.login-btn-secondary');
          loginButtonsSecondary.forEach(btn => {
            btn.style.display = 'none';
          });
          
          const logoutButtonsSecondary = document.querySelectorAll('.logout-btn-secondary');
          logoutButtonsSecondary.forEach(btn => {
            btn.style.display = 'inline-block';
          });
          
          // N√£o mostrar o storageUnitSwitch aqui - ser√° mostrado apenas quando o usu√°rio estiver analisando seu pr√≥prio invent√°rio
          if (document.getElementById('my-inventory-btn-container')) document.getElementById('my-inventory-btn-container').style.display = 'block';
          
          // Atualizar informa√ß√µes do usu√°rio usando a fun√ß√£o helper
          const steamId = getSteamIDFromToken();
          if (steamId && userInfo) {
            userInfo.textContent = `SteamID: ${steamId}`;
          }
          
          // Atualizar tamb√©m os elementos de user-info secund√°rios
          const userInfoElements = document.querySelectorAll('#user-info');
          userInfoElements.forEach(el => {
            if (steamId) {
              el.textContent = `SteamID: ${steamId}`;
            }
          });
        } else {
          // Mostrar elementos para usu√°rio n√£o logado
          if (loginBtn) loginBtn.style.display = 'inline-block';
          if (logoutBtn) logoutBtn.style.display = 'none';
          if (userInfo) userInfo.style.display = 'none';
          
          // Atualizar bot√µes secund√°rios tamb√©m
          const loginButtonsSecondary = document.querySelectorAll('.login-btn-secondary');
          loginButtonsSecondary.forEach(btn => {
            btn.style.display = 'inline-flex';
          });
          
          const logoutButtonsSecondary = document.querySelectorAll('.logout-btn-secondary');
          logoutButtonsSecondary.forEach(btn => {
            btn.style.display = 'none';
          });
          
          if (document.getElementById('my-inventory-btn-container')) document.getElementById('my-inventory-btn-container').style.display = 'none';
        }
      }
      
      // Adicionar elementos para indicador de redirecionamento
      const createRedirectIndicator = () => {
        // Remover se j√° existir
        const existingIndicator = document.getElementById('redirect-indicator');
        if (existingIndicator) {
          document.body.removeChild(existingIndicator);
        }
        
        // Criar overlay
        const indicator = document.createElement('div');
        indicator.id = 'redirect-indicator';
        indicator.dataset.created = Date.now().toString(); // Marcar quando foi criado
        indicator.style.position = 'fixed';
        indicator.style.top = '0';
        indicator.style.left = '0';
        indicator.style.width = '100%';
        indicator.style.height = '100%';
        indicator.style.backgroundColor = 'rgba(10, 14, 18, 0.85)';
        indicator.style.display = 'flex';
        indicator.style.flexDirection = 'column';
        indicator.style.alignItems = 'center';
        indicator.style.justifyContent = 'center';
        indicator.style.zIndex = '9999';
        indicator.style.pointerEvents = 'auto'; // Permitir cliques no pr√≥prio overlay
        
        // Criar spinner
        const spinner = document.createElement('div');
        spinner.style.border = '6px solid rgba(255, 215, 0, 0.1)';
        spinner.style.borderLeft = '6px solid var(--cs2-primary-gold)';
        spinner.style.borderRadius = '50%';
        spinner.style.width = '50px';
        spinner.style.height = '50px';
        spinner.style.animation = 'spin 1s linear infinite';
        
        // Criar mensagem
        const message = document.createElement('div');
        message.textContent = 'Redirecionando para a Steam...';
        message.style.color = 'var(--cs2-text-light)';
        message.style.marginTop = '20px';
        message.style.fontFamily = 'Rajdhani, sans-serif';
        message.style.fontSize = '1.2rem';
        
        // Criar subtexto
        const subtext = document.createElement('div');
        subtext.textContent = 'Aguarde enquanto voc√™ √© redirecionado para autentica√ß√£o';
        subtext.style.color = 'rgba(255, 255, 255, 0.6)';
        subtext.style.marginTop = '10px';
        subtext.style.fontFamily = 'Rajdhani, sans-serif';
        subtext.style.fontSize = '0.9rem';
        
        // Bot√£o para cancelar
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancelar';
        cancelBtn.style.marginTop = '20px';
        cancelBtn.style.padding = '8px 16px';
        cancelBtn.style.backgroundColor = 'rgba(221, 51, 51, 0.2)';
        cancelBtn.style.border = '1px solid var(--cs2-danger-red)';
        cancelBtn.style.color = 'var(--cs2-danger-red)';
        cancelBtn.style.borderRadius = '4px';
        cancelBtn.style.fontFamily = 'Rajdhani, sans-serif';
        cancelBtn.style.cursor = 'pointer';
        
        cancelBtn.addEventListener('click', () => {
          document.body.removeChild(indicator);
          // Resetar o bot√£o de login
          if (loginBtn) {
            loginBtn.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; width: 100%;"><img src="./images/steam.png" alt="Steam" style="height: 20px; width: 20px; display: block; margin-right: 10px;"><span style="display: block;">LOGIN COM STEAM</span></div>';
            loginBtn.disabled = false;
          }
        });
        
        // Montar elementos
        indicator.appendChild(spinner);
        indicator.appendChild(message);
        indicator.appendChild(subtext);
        indicator.appendChild(cancelBtn);
        
        // Adicionar ao corpo do documento
        document.body.appendChild(indicator);
        
        // Configurar remo√ß√£o autom√°tica ap√≥s 20 segundos (caso algo d√™ errado)
        setTimeout(() => {
          if (document.body.contains(indicator)) {
            document.body.removeChild(indicator);
          }
        }, 20000);
        
        return indicator;
      };
      
      // Iniciar login com Steam - Implementa√ß√£o direta via OpenID
      function loginWithSteam() {
        console.log('=== loginWithSteam chamado ===');
        
        // Mostrar modal para escolher m√©todo de login
        showSteamLoginModal();
      }
      
      // Modal para escolher m√©todo de login Steam
      function showSteamLoginModal() {
        // Criar overlay
        const modal = document.createElement('div');
        modal.id = 'steam-login-modal';
        modal.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(10, 14, 18, 0.95);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 10000;
          backdrop-filter: blur(5px);
        `;
        
        modal.innerHTML = `
          <div style="background: linear-gradient(135deg, rgba(26,38,52,0.95) 0%, rgba(10,14,18,0.98) 100%); 
                      border: 2px solid var(--cs2-primary-gold); 
                      border-radius: 12px; 
                      padding: 40px; 
                      max-width: 500px; 
                      width: 90%;
                      box-shadow: 0 10px 40px rgba(0,0,0,0.8);">
            <h3 style="font-family: 'Orbitron', sans-serif; color: var(--cs2-primary-gold); 
                        margin-bottom: 20px; font-size: 1.8rem; text-align: center; text-transform: uppercase;">
              Login com Steam
            </h3>
            
            <p style="color: var(--cs2-text-light); margin-bottom: 25px; text-align: center; 
                       font-family: 'Rajdhani', sans-serif; font-size: 1.1rem;">
              Escolha como deseja fazer login:
            </p>
            
            <div style="display: flex; flex-direction: column; gap: 15px; margin-bottom: 25px;">
              <button id="steam-openid-btn" class="btn" style="
                padding: 15px 25px; 
                background: linear-gradient(135deg, #2f526f 0%, #1c2838 100%); 
                color: var(--cs2-text-light); 
                border: 2px solid var(--cs2-primary-gold);
                border-radius: 6px; 
                font-family: 'Rajdhani', sans-serif; 
                font-size: 1.1rem; 
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
              ">
                <img src="./images/steam.png" alt="Steam" style="height: 24px; width: 24px;">
                <span>Login via Steam OpenID</span>
              </button>
              
              <button id="steam-manual-btn" class="btn" style="
                padding: 15px 25px; 
                background: linear-gradient(135deg, rgba(26,38,52,0.8) 0%, rgba(10,14,18,0.9) 100%); 
                color: var(--cs2-text-light); 
                border: 2px solid rgba(255,215,0,0.5);
                border-radius: 6px; 
                font-family: 'Rajdhani', sans-serif; 
                font-size: 1.1rem; 
                font-weight: 600;
                cursor: pointer;
              ">
                Inserir SteamID Manualmente
              </button>
            </div>
            
            <button id="close-steam-modal" style="
              width: 100%;
              padding: 10px;
              background: rgba(221,51,51,0.2);
              color: var(--cs2-danger-red);
              border: 1px solid var(--cs2-danger-red);
              border-radius: 6px;
              font-family: 'Rajdhani', sans-serif;
              font-size: 1rem;
              cursor: pointer;
            ">Cancelar</button>
          </div>
        `;
        
        document.body.appendChild(modal);
        
        // Event listeners
        document.getElementById('steam-openid-btn').addEventListener('click', () => {
          modal.remove();
          startSteamOpenIDLogin();
        });
        
        document.getElementById('steam-manual-btn').addEventListener('click', () => {
          modal.remove();
          showManualSteamIDInput();
        });
        
        document.getElementById('close-steam-modal').addEventListener('click', () => {
          modal.remove();
        });
        
        // Fechar ao clicar fora
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            modal.remove();
          }
        });
      }
      
      // Login via Steam OpenID (direto, sem backend)
      function startSteamOpenIDLogin() {
        console.log('Iniciando login Steam OpenID direto');
        
        // URL de retorno (onde a Steam vai redirecionar)
        const returnUrl = window.location.origin + window.location.pathname;
        const realm = window.location.origin;
        
        // Gerar nonce √∫nico para seguran√ßa
        const nonce = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        localStorage.setItem('steam_openid_nonce', nonce);
        
        // URL da Steam OpenID
        const steamOpenIDUrl = `https://steamcommunity.com/openid/login?` +
          `openid.ns=http://specs.openid.net/auth/2.0&` +
          `openid.mode=checkid_setup&` +
          `openid.return_to=${encodeURIComponent(returnUrl + '?steam_auth=callback')}&` +
          `openid.realm=${encodeURIComponent(realm)}&` +
          `openid.identity=http://specs.openid.net/auth/2.0/identifier_select&` +
          `openid.claimed_id=http://specs.openid.net/auth/2.0/identifier_select`;
        
        console.log('Redirecionando para Steam OpenID:', steamOpenIDUrl);
        
        // Mostrar indicador
        createRedirectIndicator();
        
        // Redirecionar para Steam
        window.location.href = steamOpenIDUrl;
      }
      
      // Mostrar input manual para SteamID
      function showManualSteamIDInput() {
        const modal = document.createElement('div');
        modal.id = 'steam-id-input-modal';
        modal.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(10, 14, 18, 0.95);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 10000;
          backdrop-filter: blur(5px);
        `;
        
        modal.innerHTML = `
          <div style="background: linear-gradient(135deg, rgba(26,38,52,0.95) 0%, rgba(10,14,18,0.98) 100%); 
                      border: 2px solid var(--cs2-primary-gold); 
                      border-radius: 12px; 
                      padding: 40px; 
                      max-width: 500px; 
                      width: 90%;
                      box-shadow: 0 10px 40px rgba(0,0,0,0.8);">
            <h3 style="font-family: 'Orbitron', sans-serif; color: var(--cs2-primary-gold); 
                        margin-bottom: 15px; font-size: 1.6rem; text-align: center; text-transform: uppercase;">
              Inserir SteamID
            </h3>
            
            <p style="color: var(--cs2-text-light); margin-bottom: 20px; text-align: center; 
                       font-family: 'Rajdhani', sans-serif; font-size: 1rem; line-height: 1.6;">
              Para encontrar seu SteamID:<br>
              1. Acesse <a href="https://steamid.io" target="_blank" style="color: var(--cs2-info-blue);">steamid.io</a><br>
              2. Cole o link do seu perfil Steam<br>
              3. Copie o <strong>SteamID64</strong> (formato: 76561198...)
            </p>
            
            <input type="text" id="steam-id-input" placeholder="76561198123456789" 
                   style="width: 100%; padding: 12px; margin-bottom: 15px; 
                          background: rgba(10,14,18,0.8); 
                          border: 2px solid rgba(255,215,0,0.3); 
                          border-radius: 6px; 
                          color: var(--cs2-text-light);
                          font-family: 'Rajdhani', sans-serif;
                          font-size: 1.1rem;
                          box-sizing: border-box;">
            
            <div style="display: flex; gap: 10px;">
              <button id="submit-steam-id" class="btn" style="
                flex: 1;
                padding: 12px; 
                background: linear-gradient(135deg, var(--cs2-primary-gold) 0%, var(--cs2-accent-orange) 100%); 
                color: var(--cs2-bg-dark); 
                border: none;
                border-radius: 6px; 
                font-family: 'Rajdhani', sans-serif; 
                font-size: 1.1rem; 
                font-weight: 600;
                cursor: pointer;
              ">Confirmar</button>
              
              <button id="cancel-steam-id" style="
                flex: 1;
                padding: 12px;
                background: rgba(221,51,51,0.2);
                color: var(--cs2-danger-red);
                border: 1px solid var(--cs2-danger-red);
                border-radius: 6px;
                font-family: 'Rajdhani', sans-serif;
                font-size: 1rem;
                cursor: pointer;
              ">Cancelar</button>
            </div>
          </div>
        `;
        
        document.body.appendChild(modal);
        
        const input = document.getElementById('steam-id-input');
        input.focus();
        
        // Validar e processar SteamID
        document.getElementById('submit-steam-id').addEventListener('click', () => {
          const steamId = input.value.trim();
          
          if (!steamId) {
            alert('Por favor, insira um SteamID.');
            return;
          }
          
          // Validar formato (deve ser num√©rico e come√ßar com 7656119)
          if (!/^7656119\d{10}$/.test(steamId)) {
            if (confirm('O SteamID n√£o est√° no formato esperado. Deseja continuar mesmo assim?')) {
              processSteamIDLogin(steamId);
            }
          } else {
            processSteamIDLogin(steamId);
          }
          
          modal.remove();
        });
        
        document.getElementById('cancel-steam-id').addEventListener('click', () => {
          modal.remove();
        });
        
        // Fechar ao clicar fora
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            modal.remove();
          }
        });
        
        // Enter para confirmar
        input.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            document.getElementById('submit-steam-id').click();
          }
        });
      }
      
      // Processar login com SteamID
      function processSteamIDLogin(steamId) {
        console.log('Processando login com SteamID:', steamId);
        
        // Criar um token simples (mock) para armazenar o SteamID
        const mockToken = btoa(JSON.stringify({
          steam_id: steamId,
          exp: Math.floor(Date.now() / 1000) + (24 * 60 * 60), // 24 horas
          iat: Math.floor(Date.now() / 1000)
        }));
        
        // Armazenar token
        localStorage.setItem('steamAuthToken', mockToken);
        authToken = mockToken;
        
        // Atualizar UI
        checkAuthStatus();
        
        // Buscar informa√ß√µes do perfil Steam via API p√∫blica
        fetchSteamProfile(steamId);
        
        alert('Login realizado com sucesso! Voc√™ pode agora analisar seu invent√°rio.');
      }
      
      // Buscar perfil Steam via API p√∫blica
      async function fetchSteamProfile(steamId) {
        try {
          // Usar API p√∫blica da Steam (requer CORS proxy ou backend)
          // Alternativa: usar steamid.io ou similar
          const profileUrl = `https://steamcommunity.com/profiles/${steamId}?xml=1`;
          
          // Como n√£o podemos fazer fetch direto devido a CORS, vamos apenas armazenar o SteamID
          // e usar para buscar invent√°rio via API p√∫blica da Steam
          console.log('SteamID armazenado:', steamId);
          
          // Atualizar informa√ß√µes do usu√°rio
          if (userInfo) {
            userInfo.textContent = `SteamID: ${steamId}`;
            userInfo.style.display = 'block';
          }
        } catch (error) {
          console.error('Erro ao buscar perfil Steam:', error);
        }
      }
      
      // Logout
      function logout() {
        localStorage.removeItem('steamAuthToken');
        authToken = null;
        checkAuthStatus();
      }
      
      // Processar callback do OpenID da Steam
      function processSteamOpenIDCallback() {
        const urlParams = new URLSearchParams(window.location.search);
        const steamAuth = urlParams.get('steam_auth');
        
        if (steamAuth === 'callback') {
          console.log('Processando callback do OpenID Steam');
          
          // Extrair par√¢metros OpenID da URL
          const openidParams = {};
          urlParams.forEach((value, key) => {
            if (key.startsWith('openid.')) {
              openidParams[key] = value;
            }
          });
          
          // Verificar se temos a claimed_id (cont√©m o SteamID)
          if (openidParams['openid.claimed_id']) {
            // Extrair SteamID da claimed_id
            // Formato: https://steamcommunity.com/openid/id/76561198123456789
            const claimedId = openidParams['openid.claimed_id'];
            const steamIdMatch = claimedId.match(/\/id\/(\d+)$/);
            
            if (steamIdMatch && steamIdMatch[1]) {
              const steamId = steamIdMatch[1];
              console.log('SteamID extra√≠do:', steamId);
              
              // Processar login com o SteamID
              processSteamIDLogin(steamId);
              
              // Limpar par√¢metros da URL
              const newUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
              window.history.replaceState({path: newUrl}, '', newUrl);
              
              return true;
            }
          }
          
          // Se n√£o conseguiu extrair, mostrar erro
          console.error('N√£o foi poss√≠vel extrair SteamID do callback');
          alert('Erro ao processar autentica√ß√£o Steam. Tente novamente ou use o m√©todo manual.');
          
          // Limpar par√¢metros
          const newUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
          window.history.replaceState({path: newUrl}, '', newUrl);
          
          return false;
        }
        
        return false;
      }
      
      // Processar par√¢metros da URL (para callback de auth)
      function processUrlParams() {
        // Primeiro, verificar callback do OpenID Steam
        if (processSteamOpenIDCallback()) {
          return; // Se processou o callback, n√£o precisa processar outros par√¢metros
        }
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('token');
        
        console.log('Verificando par√¢metros de URL ap√≥s redirecionamento');
        console.log('- URL completa:', window.location.href);
        console.log('- Hostname:', window.location.hostname);
        console.log('- Porto:', window.location.port);
        console.log('- Par√¢metros de URL:', window.location.search);
        console.log('- Token detectado:', token ? 'Sim' : 'N√£o');
        
        if (token) {
          console.log('- Token obtido, armazenando no localStorage');
          
          try {
            // Verificar se o token √© v√°lido (formato JWT)
            const tokenParts = token.split('.');
            if (tokenParts.length !== 3) {
              console.error('Formato de token inv√°lido');
              alert('O token de autentica√ß√£o parece ser inv√°lido. Por favor, tente fazer login novamente.');
              return;
            }
            
            // Decodificar payload para verificar estrutura
            try {
              const payload = JSON.parse(atob(tokenParts[1]));
              console.log('- Payload do token decodificado:', payload);
              
              // Verificar se cont√©m informa√ß√µes essenciais
              if (!payload.steam_id && !payload.exp) {
                console.warn('Token n√£o cont√©m informa√ß√µes essenciais (steam_id e exp)');
              }
              
              // Verificar se o token est√° expirado
              if (payload.exp && payload.exp < Math.floor(Date.now() / 1000)) {
                console.error('Token expirado');
                alert('Seu token de autentica√ß√£o expirou. Por favor, fa√ßa login novamente.');
                return;
              }
            } catch (e) {
              console.warn('N√£o foi poss√≠vel decodificar o payload do token, mas continuando mesmo assim', e);
            }
            
            // Armazenar o token
            localStorage.setItem('steamAuthToken', token);
            authToken = token;
            
            // Resetar bot√£o de login se ainda estiver no estado de loading
            if (loginBtn) {
              loginBtn.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; width: 100%;"><img src="./images/steam.png" alt="Steam" style="height: 20px; width: 20px; display: block; margin-right: 10px;"><span style="display: block;">LOGIN COM STEAM</span></div>';
              loginBtn.disabled = false;
            }
            
            // Atualizar UI para mostrar que o usu√°rio est√° logado
            checkAuthStatus();
            
            // Verifica√ß√£o de token com a API removida - n√£o necess√°ria
            
            // Limpar par√¢metros da URL sem recarregar a p√°gina
            const newUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
            window.history.replaceState({path: newUrl}, '', newUrl);
            
            console.log('- Redirecionamento para autentica√ß√£o conclu√≠do com sucesso');
          } catch (error) {
            console.error('Erro ao processar token:', error);
            localStorage.removeItem('steamAuthToken');
            authToken = null;
            checkAuthStatus();
          }
        }
        
        // Verificar outros par√¢metros
        const errorParam = urlParams.get('error');
        if (errorParam) {
          console.error('Erro de autentica√ß√£o:', errorParam);
          alert(`Ocorreu um erro durante a autentica√ß√£o: ${errorParam}`);
          
          // Limpar par√¢metros da URL
          const newUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
          window.history.replaceState({path: newUrl}, '', newUrl);
        }
      }
      
      // Fun√ß√£o para verificar token com a API - removida por ser desnecess√°ria
      function verifyTokenWithApi(token) {
        console.log('Verifica√ß√£o de token com API foi desativada');
        // Fun√ß√£o mantida apenas por compatibilidade, mas n√£o faz nada
        // A verifica√ß√£o de token √© feita localmente
      }
      
      // Atualizar informa√ß√µes do usu√°rio com dados da Steam
      function updateUserInfo(steamInfo) {
        if (!userInfo) return;
        
        // Mostrar informa√ß√µes mais amig√°veis
        if (steamInfo.personaname) {
          userInfo.innerHTML = `
            <div style="display: flex; align-items: center;">
              ${steamInfo.avatar ? `<img src="${steamInfo.avatar}" alt="Avatar" style="width: 24px; height: 24px; border-radius: 50%; margin-right: 10px;">` : ''}
              <div>
                <div style="font-weight: 600;">${steamInfo.personaname}</div>
                <div style="font-size: 0.8rem; opacity: 0.7;">SteamID: ${steamInfo.steamid}</div>
              </div>
            </div>
          `;
        } else {
          userInfo.textContent = `SteamID: ${steamInfo.steamid || 'Desconhecido'}`;
        }
      }
      

      
      // Formatar valor para BRL
      function formatCurrency(value) {
        return new Intl.NumberFormat('pt-BR', { 
          style: 'currency', 
          currency: 'BRL' 
        }).format(value);
      }
      
      // Fun√ß√£o vazia para caixas (mantida para compatibilidade)
      function loadCases() {
        console.log('Funcionalidade de caixas foi removida');
        // Esta fun√ß√£o est√° mantida apenas por compatibilidade
      }
      
      // Fun√ß√£o para exportar dados para Excel
      function exportToExcel(data, filename = 'inventario_elite_skins') {
        if (!data || !data.items || data.items.length === 0) {
          alert('Nenhum dado dispon√≠vel para exportar');
          return;
        }
        
        console.log('Preparando exporta√ß√£o para Excel...');
        
        // Criar uma workbook XLSX
        const wb = XLSX.utils.book_new();
        
        // Preparar os dados para a planilha principal de itens
        const itemsData = [
          // Cabe√ßalho
          ["Nome", "Hash de Mercado", "Pre√ßo (R$)", "Quantidade", "Total (R$)", "Origem", "Categoria", "Desgaste"]
        ];
        
        // Adicionar dados dos itens
        data.items.forEach(item => {
          itemsData.push([
            item.name || '',
            item.market_hash_name || '',
            (item.price || 0).toFixed(2).replace('.', ','),
            item.quantity || 1,
            (item.total || item.price || 0).toFixed(2).replace('.', ','),
            item.source === 'storage_unit' ? 'Unidade de Armazenamento' : 'Invent√°rio',
            item.category || 'Outros',
            item.exterior || ''
          ]);
        });
        
        // Criar uma planilha para os itens
        const wsItems = XLSX.utils.aoa_to_sheet(itemsData);
        
        // Adicionar a planilha ao workbook
        XLSX.utils.book_append_sheet(wb, wsItems, "Itens");
        
        // Criar uma planilha para o resumo
        const summaryData = [
          ["Resumo do Invent√°rio", ""],
          ["Total de Itens", data.total_items || 0],
          ["Valor Total (R$)", (data.total_value || 0).toFixed(2).replace('.', ',')],
          ["Valor M√©dio por Item (R$)", (data.average_item_value || 0).toFixed(2).replace('.', ',')]
        ];
        
        // Adicionar informa√ß√µes de fonte se dispon√≠vel
        if (data.source_summary) {
          summaryData.push(["", ""]);
          summaryData.push(["Resumo por Origem", ""]);
          summaryData.push(["Itens de Unidades", data.source_summary.storage_units?.count || 0]);
          summaryData.push(["Valor em Unidades (R$)", (data.source_summary.storage_units?.value || 0).toFixed(2).replace('.', ',')]);
          summaryData.push(["Itens de Invent√°rio", data.source_summary.market?.count || 0]);
          summaryData.push(["Valor em Invent√°rio (R$)", (data.source_summary.market?.value || 0).toFixed(2).replace('.', ',')]);
        }
        
        // Adicionar data e hora da exporta√ß√£o
        const now = new Date();
        const dateStr = now.toLocaleDateString('pt-BR');
        const timeStr = now.toLocaleTimeString('pt-BR');
        summaryData.push(["", ""]);
        summaryData.push([`Exportado em: ${dateStr} √†s ${timeStr} | Elite Skins 2025`, ""]);
        
        // Criar uma planilha para o resumo
        const wsSummary = XLSX.utils.aoa_to_sheet(summaryData);
        
        // Adicionar a planilha de resumo ao workbook
        XLSX.utils.book_append_sheet(wb, wsSummary, "Resumo");
        
        // Gerar o arquivo XLSX e acionar o download
        XLSX.writeFile(wb, `${filename}_${dateStr.replace(/\//g, '-')}.xlsx`);
        
        console.log('Exporta√ß√£o para Excel conclu√≠da');
      }
      
      // Altern√¢ncia de tabs - Fun√ß√£o robusta
      function setupTabsFunction() {
        const allTabs = document.querySelectorAll('.api-tab');
        const allTabContents = document.querySelectorAll('.tab-content');
        
        allTabs.forEach(tab => {
          // Garantir que seja clic√°vel
          tab.style.pointerEvents = 'auto';
          tab.style.cursor = 'pointer';
          tab.style.zIndex = '1000';
          tab.style.position = 'relative';
          
          // Remover listeners antigos clonando
          const newTab = tab.cloneNode(true);
          tab.parentNode.replaceChild(newTab, tab);
          const freshTab = document.querySelector(`[data-tab="${newTab.dataset.tab}"]`);
          
          if (freshTab) {
            freshTab.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation();
              e.stopImmediatePropagation();
              console.log('Tab clicada:', freshTab.dataset.tab);
              
              // Remove active class de todas as tabs
              allTabs.forEach(t => {
                t.classList.remove('active');
                t.style.color = 'var(--cs2-text-light)';
              });
              
              // Adiciona active class na tab clicada
              freshTab.classList.add('active');
              freshTab.style.color = 'var(--cs2-primary-gold)';
              
              // Esconde todos os conte√∫dos
              allTabContents.forEach(content => {
                content.style.display = 'none';
                content.classList.remove('active');
              });
              
              // Mostra o conte√∫do da tab selecionada
              const tabId = freshTab.getAttribute('data-tab');
              const targetContent = document.getElementById(`${tabId}-tab`);
              if (targetContent) {
                targetContent.style.display = 'block';
                targetContent.classList.add('active');
              }
              
              return false;
            }, true);
          }
        });
      }
      
      // Configurar tabs
      setupTabsFunction();
      
      // Reconfigurar tabs ap√≥s delays
      setTimeout(setupTabsFunction, 100);
      setTimeout(setupTabsFunction, 500);
      
      // Criar cart√£o de item
      // Fun√ß√£o para gerar URL da imagem da Steam baseada no nome do item
      function getSteamItemImageUrl(item) {
        if (!item) return null;
        
        // Prioridade 1: Se j√° tiver image_url completa (da API do csgoskins.gg ou outra fonte)
        if (item.image_url && (item.image_url.startsWith('http://') || item.image_url.startsWith('https://'))) {
          return item.image_url;
        }
        
        // Prioridade 2: Se tiver icon_url como URL completa (da API csgoskins.gg)
        if (item.icon_url && (item.icon_url.startsWith('http://') || item.icon_url.startsWith('https://'))) {
          return item.icon_url;
        }
        
        // Prioridade 3: Se tiver icon_url como hash (formato da Steam API), construir URL completa
        if (item.icon_url) {
          return `https://steamcommunity-a.akamaihd.net/economy/image/${item.icon_url}`;
        }
        
        // Prioridade 3: Se tiver classid e instanceid, construir URL direta da Steam
        if (item.classid && item.instanceid) {
          return `https://steamcommunity-a.akamaihd.net/economy/image/${item.classid}/${item.instanceid}`;
        }
        
        // Prioridade 4: Se tiver image_url mas n√£o come√ßar com http, pode ser um hash da Steam
        if (item.image_url) {
          return `https://steamcommunity-a.akamaihd.net/economy/image/${item.image_url}`;
        }
        
        // Se n√£o tiver nenhuma informa√ß√£o de imagem, retornar null
        return null;
      }
      
      // Fun√ß√£o para buscar URL da imagem via API p√∫blica (melhorada)
      async function fetchItemImageUrl(marketHashName) {
        if (!marketHashName) return null;
        
        try {
          // A Steam retorna icon_url que precisa ser combinado com o prefixo
          // Mas como n√£o temos acesso direto √† API da Steam aqui, vamos retornar null
          // e usar o placeholder. A API backend deve fornecer image_url ou icon_url
          return null;
        } catch (error) {
          console.error('Erro ao buscar imagem:', error);
          return null;
        }
      }
      
      function createItemCard(item) {
        // Adicionar badge de filtragem se aplic√°vel
        const filteredBadge = item.filtered ? 
          `<span style="font-size: 0.7rem; background: rgba(75,158,42,0.2); color: var(--cs2-accent-green); display: inline-block; padding: 1px 4px; border-radius: 3px; margin-left: 5px;">ajustado</span>` : '';
        
        // Badge para indicar m√∫ltiplas fontes de pre√ßo
        const sourcesBadge = item.price_sources_count ? 
          `<span style="font-size: 0.7rem; background: rgba(35,137,218,0.2); color: var(--cs2-info-blue); display: inline-block; padding: 1px 4px; border-radius: 3px; margin-left: 5px;">${item.price_sources_count} fontes</span>` : '';
        
        // Badge para indicar pre√ßo do fallback Steam Market
        const fallbackBadge = item.price_source && item.price_source.includes('Fallback') ? 
          `<span style="font-size: 0.7rem; background: rgba(255,215,0,0.2); color: var(--cs2-primary-gold); display: inline-block; padding: 1px 4px; border-radius: 3px; margin-left: 5px;">Steam Market</span>` : '';
        
        // Obter URL da imagem
        const imageUrl = getSteamItemImageUrl(item);
        const itemName = item.name || item.market_hash_name || 'Item';
        
        // Construir HTML da imagem (tamanho maior e mais destacado)
        let imageHTML = '';
        if (imageUrl) {
          imageHTML = `
            <div style="flex-shrink: 0; width: 120px; height: 90px; margin-right: 15px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, rgba(0,0,0,0.4) 0%, rgba(19,30,43,0.6) 100%); border-radius: 8px; border: 2px solid ${getRarityColor(item.rarity)}50; box-shadow: 0 4px 12px rgba(0,0,0,0.3), 0 0 8px ${getRarityColor(item.rarity)}20;">
              <img src="${imageUrl}" alt="${itemName}" 
                   style="max-width: 100%; max-height: 100%; width: auto; height: auto; object-fit: contain; border-radius: 6px; filter: drop-shadow(0 2px 6px rgba(0,0,0,0.5)); transition: transform 0.2s ease;" 
                   onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\\'color: var(--cs2-text-light); opacity: 0.5; font-size: 0.8rem; text-align: center; padding: 10px;\\'><i class=\\'fas fa-image\\' style=\\'font-size: 2rem; color: ${getRarityColor(item.rarity)};\\'></i></div>';"
                   onmouseover="this.style.transform='scale(1.1)'"
                   onmouseout="this.style.transform='scale(1)'">
            </div>
          `;
        } else {
          // Placeholder com √≠cone
          imageHTML = `
            <div style="flex-shrink: 0; width: 120px; height: 90px; margin-right: 15px; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 8px; border: 2px dashed ${getRarityColor(item.rarity)}40;">
              <div style="color: ${getRarityColor(item.rarity)}; opacity: 0.5; font-size: 2rem;">
                <i class="fas fa-image"></i>
              </div>
            </div>
          `;
        }
        
        return `
          <div style="display: flex; align-items: center; margin-bottom: 15px; padding: 10px; background: rgba(19,30,43,0.5); border-radius: 6px; border-left: 3px solid ${getRarityColor(item.rarity)};">
            ${imageHTML}
            <div style="flex: 1;">
              <div style="font-weight: 600; color: ${getRarityColor(item.rarity)};">
                ${itemName}
                ${filteredBadge}
                ${sourcesBadge}
                ${fallbackBadge}
              </div>
              <div style="font-size: 0.9rem; opacity: 0.7;">${item.type || item.category || ''} | ${item.exterior || ''}</div>
              ${item.source ? `<div style="font-size: 0.8rem; background: rgba(255,215,0,0.1); display: inline-block; padding: 2px 6px; border-radius: 3px; margin-top: 4px;">${item.source === 'storage_unit' ? 'Unidade de Armazenamento' : 'Invent√°rio'}</div>` : ''}
            </div>
            <div style="font-weight: 700; color: var(--cs2-accent-orange); font-size: 1.1rem;">${formatCurrency(item.price || 0)}</div>
          </div>
        `;
      }
      
      // Criar cart√£o de unidade de armazenamento
      function createStorageUnitCard(unit) {
        return `
          <div style="margin-bottom: 20px; padding: 15px; background: rgba(19,30,43,0.8); border-radius: 8px; border: 1px solid rgba(255,215,0,0.3);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
              <h4 style="font-family: 'Orbitron', sans-serif; color: var(--cs2-primary-gold); margin: 0; font-size: 1.1rem;">${unit.unit_info?.name || 'Unidade de Armazenamento'}</h4>
              <span style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-accent-orange); font-weight: 700; font-size: 1.2rem;">${formatCurrency(unit.contents?.total_value || 0)}</span>
            </div>
            <div style="font-size: 0.9rem; margin-bottom: 10px;">
              <span style="color: var(--cs2-text-light); opacity: 0.8;">Total de itens: ${unit.contents?.total_items || 0}</span>
            </div>
            <div style="margin-top: 10px;">
              ${unit.contents?.items?.slice(0, 3).map(item => createItemCard(item)).join('') || ''}
              ${unit.contents?.items?.length > 3 ? `<div style="text-align: center; padding: 5px; font-size: 0.9rem; color: var(--cs2-text-light); opacity: 0.7;">+ ${unit.contents.items.length - 3} itens adicionais</div>` : ''}
            </div>
          </div>
        `;
      }
      
      // Obter cor com base na raridade
      function getRarityColor(rarity) {
        const rarityColors = {
          'Consumer Grade': '#b0c3d9',
          'Industrial Grade': '#5e98d9',
          'Mil-Spec Grade': '#4b69ff',
          'Restricted': '#8847ff',
          'Classified': '#d32ce6',
          'Covert': '#eb4b4b',
          'Knife': '#caab05',
          'Extraordinary': '#caab05'
        };
        
        return rarityColors[rarity] || 'var(--cs2-primary-gold)';
      }
      
      // Analisar invent√°rio (para o bot√£o da interface) - Fun√ß√£o mantida para compatibilidade
      function analyzeInventory() {
        // Exibir mensagem para o usu√°rio
        inventoryResult.style.opacity = '1';
        inventoryLoading.style.display = 'none';
        inventoryData.style.display = 'block';
        
        // Exibir mensagem explicativa
        inventorySummary.innerHTML = `
          <div style="text-align: center; padding: 20px; background: rgba(19,30,43,0.7); border-radius: 8px; border-left: 3px solid var(--cs2-primary-gold);">
            <p style="font-size: 1.1rem; margin-bottom: 10px; color: var(--cs2-primary-gold);">
              <strong>Funcionalidade Atualizada</strong>
            </p>
            <p style="color: var(--cs2-text-light); margin-bottom: 15px;">
              A an√°lise de invent√°rio de terceiros foi descontinuada. 
              Para verificar um invent√°rio, fa√ßa login com sua conta Steam.
            </p>
            <button id="redirect-login-btn" class="btn" style="padding: 8px 20px; background: linear-gradient(135deg, #2f526f 0%, #1c2838 100%); color: var(--cs2-text-light); border: none; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1rem; cursor: pointer;">
              <img src="./images/steam.png" alt="Steam" style="height: 16px; width: 16px; display: inline-block; vertical-align: middle; margin-right: 8px;">
              Login com Steam
            </button>
          </div>
        `;
        
        inventoryItems.innerHTML = '';
        
        // Adicionar event listener para o bot√£o de redirecionamento
        setTimeout(() => {
          const redirectBtn = document.getElementById('redirect-login-btn');
          if (redirectBtn) {
            redirectBtn.addEventListener('click', loginWithSteam);
          }
        }, 100);
      }
      
      // Fun√ß√£o auxiliar para criar URL com proxy CORS
      function createCorsProxyUrl(originalUrl) {
        const corsProxyUrl = 'https://corsproxy.io/?';
        return `${corsProxyUrl}${encodeURIComponent(originalUrl)}`;
      }
      
      // Fun√ß√£o para formatar moeda original baseada na moeda
      function formatOriginalCurrency(price, currency) {
        if (!price) return '0.00';
        price = parseFloat(price);
        
        const symbols = {
          'USD': '$',
          'EUR': '‚Ç¨',
          'GBP': '¬£',
          'BRL': 'R$'
        };
        
        const symbol = symbols[currency] || '$';
        return `${symbol}${price.toFixed(2)}`;
      }
      
      // Fun√ß√£o para extrair nome base e desgaste do nome completo da skin
      function parseSkinName(fullName) {
        // Padr√£o esperado: "Arma | Nome da Skin (Desgaste)"
        // Exemplo: "AK-47 | Redline (Factory New)"
        
        const wearPatterns = {
          'Factory New': 'Factory New',
          'Minimal Wear': 'Minimal Wear',
          'Field-Tested': 'Field-Tested',
          'Well-Worn': 'Well-Worn',
          'Battle-Scarred': 'Battle-Scarred'
        };
        
        let marketHashName = fullName;
        let exterior = null;
        let isStatTrak = false;
        
        // Verificar se √© StatTrak
        if (fullName.includes('StatTrak') || fullName.includes('StatTrak‚Ñ¢')) {
          isStatTrak = true;
          marketHashName = marketHashName.replace(/StatTrak‚Ñ¢?\s*/gi, '').trim();
        }
        
        // Extrair desgaste
        for (const [wearKey, wearValue] of Object.entries(wearPatterns)) {
          const regex = new RegExp(`\\(${wearKey.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}\\)`, 'i');
          if (regex.test(fullName)) {
            exterior = wearValue;
            marketHashName = marketHashName.replace(regex, '').trim();
            break;
          }
        }
        
        // Se n√£o encontrou desgaste, tentar sem par√™nteses
        if (!exterior) {
          for (const [wearKey, wearValue] of Object.entries(wearPatterns)) {
            if (fullName.toLowerCase().includes(wearKey.toLowerCase())) {
              exterior = wearValue;
              marketHashName = marketHashName.replace(new RegExp(wearKey, 'gi'), '').trim();
              break;
            }
          }
        }
        
        // Limpar espa√ßos extras e caracteres residuais
        marketHashName = marketHashName.replace(/\s+/g, ' ').trim();
        
        return {
          marketHashName,
          exterior: exterior || 'Field-Tested', // Default para Field-Tested se n√£o especificado
          isStatTrak
        };
      }
      
      // Buscar pre√ßo com m√©todo de fallback
      async function getPrice() {
        const fullSkinName = skinNameInput.value.trim();
        if (!fullSkinName) {
          alert('Por favor, informe o nome da skin no formato: "Arma | Nome da Skin (Desgaste)"\nExemplo: "AK-47 | Redline (Factory New)"');
          return;
        }
        
        priceResult.style.opacity = '1';
        priceLoading.style.display = 'block';
        priceData.style.display = 'none';
        
        // Verificar checkbox de StatTrak
        const statTrakCheckbox = document.getElementById('stattrak-checkbox');
        const statTrakFromCheckbox = statTrakCheckbox ? statTrakCheckbox.checked : false;
        
        // Extrair nome base, desgaste e StatTrak
        const { marketHashName, exterior, isStatTrak: isStatTrakFromName } = parseSkinName(fullSkinName);
        
        // Priorizar checkbox, mas se n√£o estiver marcado, usar detec√ß√£o do nome
        const isStatTrak = statTrakFromCheckbox || isStatTrakFromName;
        
        console.log('Nome completo:', fullSkinName);
        console.log('Nome base extra√≠do:', marketHashName);
        console.log('Desgaste:', exterior);
        console.log('StatTrak (checkbox):', statTrakFromCheckbox);
        console.log('StatTrak (do nome):', isStatTrakFromName);
        console.log('StatTrak (final):', isStatTrak);
        
        try {
          // Garantir que temos a taxa de c√¢mbio atualizada
          await getExchangeRate();
          
          // Usar endpoint espec√≠fico com par√¢metros separados
          const params = new URLSearchParams({
            market_hash_name: marketHashName,
            exterior: exterior,
            stattrack: isStatTrak.toString()
          });
          
          const endpoint = `${API_BASE_URL}/api/inventory/item-price?${params}`;
          console.log('Fazendo requisi√ß√£o para:', endpoint);
          
          // Tentar fazer a requisi√ß√£o para a API
          const response = await fetch(endpoint, {
            method: 'GET',
            headers: {
              'Accept': 'application/json',
              'Content-Type': 'application/json',
              'Cache-Control': 'no-cache'
            },
            mode: 'cors',
            cache: 'no-cache'
          });
          
          // Verificar se a resposta foi bem-sucedida
          if (!response || !response.ok) {
            throw new Error('Erro ao consultar a API: ' + (response ? `Status ${response.status}` : 'Conex√£o falhou'));
          }
          
          let data;
          let pricesData = null;
          let filteredPrice = null;
          let hasMultiplePrices = false;
          
          // Processar os dados da API
          data = await response.json();
          console.log('Pre√ßo obtido da API:', data);
          
          // Verificar se o pre√ßo existe nos dados retornados
          // O endpoint /api/inventory/item-price retorna price_usd em vez de price
          if (!data || (data.price_usd === undefined && data.price === undefined)) {
            throw new Error('API n√£o retornou um pre√ßo v√°lido');
          }
          
          // Normalizar o formato da resposta
          // O endpoint /api/inventory/item-price retorna price_usd
          if (data.price_usd !== undefined) {
            data.price = data.price_usd;
            data.original_price = data.price_usd;
          } else {
            data.original_price = data.price;
          }
          
          // Armazenar informa√ß√µes da moeda original
          data.original_currency = data.currency || "USD"; // A API sempre retorna em USD
          
          // Se a API n√£o retornou market_hash_name, usar o que extra√≠mos
          if (!data.market_hash_name) {
            data.market_hash_name = marketHashName;
          }
          
          // Se a API n√£o retornou exterior, usar o que extra√≠mos
          if (!data.exterior) {
            data.exterior = exterior;
          }
          
          // Se a API n√£o retornou stattrack, usar o que extra√≠mos
          if (data.stattrack === undefined) {
            data.stattrack = isStatTrak;
          }
          
          // Verificar se temos m√∫ltiplos pre√ßos para filtrar outliers
          if (data.prices && Array.isArray(data.prices) && data.prices.length > 0) {
            hasMultiplePrices = true;
            pricesData = data.prices;
            
            // Converter para valores num√©ricos
            const priceValues = data.prices.map(p => p.price || 0);
            
            // Aplicar o filtro de outliers
            filteredPrice = filterOutliersAndCalculateAverage(priceValues);
            console.log('Pre√ßo filtrado calculado:', filteredPrice);
            
            // Atualizar o pre√ßo com o valor filtrado
            data.price = filteredPrice.toFixed(2);
            data.filtered = true;
          }
          
          // A API sempre retorna em USD, ent√£o sempre converter para BRL
          data.price_brl = (parseFloat(data.price) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR).toFixed(2);
          
          // Converter tamb√©m os pre√ßos individuais se existirem
          if (pricesData) {
            pricesData = pricesData.map(p => {
              if (p.price) {
                p.original_price_usd = p.price;
                // A API sempre retorna em USD, ent√£o sempre converter para BRL
                p.price = (parseFloat(p.price) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR).toFixed(2);
              }
              return p;
            });
          }
          
          // Obter URL da imagem e cor de raridade
          // A API pode retornar image_url ou icon_url
          // Usar a fun√ß√£o getSteamItemImageUrl para processar corretamente
          const skinImageUrl = getSteamItemImageUrl(data);
          const rarityColor = getRarityColor(data.rarity || 'Classified');
          
          console.log('URL da imagem processada:', skinImageUrl);
          console.log('Dados brutos - image_url:', data.image_url);
          console.log('Dados brutos - icon_url:', data.icon_url);
          
          // Verificar se h√° pre√ßos por wear dispon√≠veis
          const hasPriceRange = data.prices && (data.prices.normal || data.prices.stattrak);
          const priceRange = data.price_range || null;
          
          // Mostrar resultado com layout horizontal compacto
          let priceInfoHTML = `
            <div style="display: grid; grid-template-columns: 200px 1fr; gap: 20px; margin-bottom: 20px;">
              <!-- Coluna da Imagem -->
              <div style="display: flex; flex-direction: column; align-items: center;">
                ${skinImageUrl ? `
                  <div style="padding: 15px; background: linear-gradient(135deg, rgba(19,30,43,0.9) 0%, rgba(26,38,52,0.7) 100%); border-radius: 12px; border: 2px solid ${rarityColor}50; box-shadow: 0 4px 16px rgba(0,0,0,0.4), 0 0 12px ${rarityColor}20; margin-bottom: 10px;">
                    <img src="${skinImageUrl}" 
                         alt="${data.market_hash_name || fullSkinName}" 
                         style="max-width: 170px; max-height: 130px; width: auto; height: auto; object-fit: contain; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.7)); transition: transform 0.3s ease;"
                         onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\\'color: var(--cs2-text-light); opacity: 0.5; padding: 15px;\\'><i class=\\'fas fa-image\\' style=\\'font-size: 2rem; color: ${rarityColor};\\'></i></div>';"
                         onmouseover="this.style.transform='scale(1.1)'"
                         onmouseout="this.style.transform='scale(1)'">
                  </div>
                ` : `
                  <div style="padding: 30px; background: rgba(19,30,43,0.5); border-radius: 12px; border: 2px dashed ${rarityColor}40; margin-bottom: 10px;">
                    <div style="color: ${rarityColor}; opacity: 0.5; font-size: 2.5rem;">
                      <i class="fas fa-image"></i>
                    </div>
                  </div>
                `}
                ${data.rarity ? `<span style="display: inline-block; padding: 4px 10px; background: ${rarityColor}30; color: ${rarityColor}; border-radius: 15px; font-size: 0.75rem; font-weight: 600; border: 1px solid ${rarityColor}50;">${data.rarity}</span>` : ''}
              </div>
              
              <!-- Coluna de Informa√ß√µes -->
              <div style="display: flex; flex-direction: column; gap: 10px;">
                <!-- Nome e Categoria -->
                <div style="padding: 12px; background: rgba(19,30,43,0.6); border-radius: 8px; border-left: 4px solid ${rarityColor};">
                  <div style="font-weight: 700; color: ${rarityColor}; font-size: 1.2rem; margin-bottom: 4px; text-shadow: 0 0 8px ${rarityColor}40;">${data.market_hash_name || fullSkinName}${data.exterior ? ` (${data.exterior})` : ''}${data.stattrack ? ' StatTrak‚Ñ¢' : ''}</div>
                  ${data.weapon || data.category ? `<div style="font-size: 0.85rem; color: var(--cs2-text-light); opacity: 0.7;">${data.weapon || ''} ${data.weapon && data.category ? '‚Ä¢' : ''} ${data.category || ''}</div>` : ''}
                </div>
                
                <!-- Pre√ßo Principal -->
                <div style="padding: 16px; background: linear-gradient(135deg, rgba(255,215,0,0.15) 0%, rgba(255,140,0,0.15) 100%); border-radius: 10px; border: 2px solid var(--cs2-accent-orange)50; box-shadow: 0 4px 12px rgba(255,140,0,0.2);">
                  <div style="display: flex; justify-content: space-between; align-items: baseline;">
                    <span style="font-family: 'Rajdhani', sans-serif; font-size: 1rem; color: var(--cs2-text-light); font-weight: 600;">Pre√ßo em BRL:</span>
                    <span style="font-weight: 800; color: var(--cs2-accent-orange); font-size: 1.6rem; text-shadow: 0 0 12px var(--cs2-accent-orange)50;">${formatCurrency(parseFloat(data.price_brl))}</span>
                  </div>
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 6px; font-size: 0.85rem;">
                    <span style="color: var(--cs2-text-light); opacity: 0.7;">Original (${data.original_currency}):</span>
                    <span style="font-weight: 600; color: var(--cs2-info-blue);">${formatOriginalCurrency(data.original_price, data.original_currency)}</span>
                  </div>
                </div>
                
                ${priceRange ? `
                <!-- Range de Pre√ßos -->
                <div style="padding: 10px; background: rgba(19,30,43,0.4); border-radius: 8px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.85rem;">
                  <div>
                    <span style="color: var(--cs2-text-light); opacity: 0.7;">M√≠nimo:</span>
                    <span style="color: var(--cs2-accent-green); font-weight: 600; margin-left: 5px;">${formatCurrency((priceRange.min || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span>
                  </div>
                  <div style="text-align: right;">
                    <span style="color: var(--cs2-text-light); opacity: 0.7;">M√°ximo:</span>
                    <span style="color: var(--cs2-danger-red); font-weight: 600; margin-left: 5px;">${formatCurrency((priceRange.max || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span>
                  </div>
                </div>
                ` : ''}
              </div>
            </div>`;
          
          // Adicionar tabela de pre√ßos por wear se dispon√≠vel
          if (hasPriceRange) {
            priceInfoHTML += `
              <div style="margin-top: 15px; padding: 12px; background: rgba(19,30,43,0.5); border-radius: 10px; border: 1px solid ${rarityColor}30;">
                <h4 style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-primary-gold); margin: 0 0 12px 0; font-size: 0.95rem; font-weight: 700;">Pre√ßos por Desgaste</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                  ${data.prices.normal ? `
                  <div>
                    <div style="font-size: 0.8rem; color: var(--cs2-text-light); opacity: 0.8; margin-bottom: 6px; font-weight: 600;">Normal</div>
                    <div style="display: flex; flex-direction: column; gap: 4px; font-size: 0.75rem;">
                      ${data.prices.normal.factory_new ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Factory New:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.normal.factory_new || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                      ${data.prices.normal.minimal_wear ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Minimal Wear:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.normal.minimal_wear || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                      ${data.prices.normal.field_tested ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Field-Tested:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.normal.field_tested || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                      ${data.prices.normal.well_worn ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Well-Worn:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.normal.well_worn || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                      ${data.prices.normal.battle_scarred ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Battle-Scarred:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.normal.battle_scarred || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                    </div>
                  </div>
                  ` : ''}
                  ${data.prices.stattrak ? `
                  <div>
                    <div style="font-size: 0.8rem; color: var(--cs2-text-light); opacity: 0.8; margin-bottom: 6px; font-weight: 600;">StatTrak‚Ñ¢</div>
                    <div style="display: flex; flex-direction: column; gap: 4px; font-size: 0.75rem;">
                      ${data.prices.stattrak.factory_new ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Factory New:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.stattrak.factory_new || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                      ${data.prices.stattrak.minimal_wear ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Minimal Wear:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.stattrak.minimal_wear || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                      ${data.prices.stattrak.field_tested ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Field-Tested:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.stattrak.field_tested || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                      ${data.prices.stattrak.well_worn ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Well-Worn:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.stattrak.well_worn || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                      ${data.prices.stattrak.battle_scarred ? `<div style="display: flex; justify-content: space-between; padding: 4px 6px; background: rgba(19,30,43,0.3); border-radius: 4px;"><span>Battle-Scarred:</span><span style="color: var(--cs2-accent-orange); font-weight: 600;">${formatCurrency((data.prices.stattrak.battle_scarred || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR)}</span></div>` : ''}
                    </div>
                  </div>
                  ` : ''}
                </div>
              </div>
            `;
          }
          
          // Adicionar informa√ß√µes sobre filtragem se aplic√°vel
          if (hasMultiplePrices && pricesData) {
            priceInfoHTML += `
              <div style="margin-top: 15px; padding: 10px; background: rgba(26,38,52,0.5); border-radius: 6px; border: 1px solid rgba(255,215,0,0.2);">
                <h4 style="font-family: 'Rajdhani', sans-serif; color: var(--cs2-primary-gold); margin-bottom: 10px; font-size: 1rem; display: flex; align-items: center;">
                  <span style="display: inline-block; width: 6px; height: 6px; background: var(--cs2-accent-green); border-radius: 50%; margin-right: 5px;"></span>
                  An√°lise de Pre√ßos (${pricesData.length} fontes)
                </h4>
                <div style="max-height: 200px; overflow-y: auto; padding-right: 10px;">`;
                
            // Ordenar pre√ßos do menor para o maior
            pricesData.sort((a, b) => parseFloat(a.price) - parseFloat(b.price));
            
            // Calcular a mediana para identificar outliers visualmente
            const priceValues = pricesData.map(p => parseFloat(p.price));
            const median = priceValues.length % 2 === 0
              ? (priceValues[priceValues.length / 2 - 1] + priceValues[priceValues.length / 2]) / 2
              : priceValues[Math.floor(priceValues.length / 2)];
            
            // Definir limite percentual para destacar outliers (40%)
            const percentLimit = 0.4;
            const upperVisualLimit = median * (1 + percentLimit);
            const lowerVisualLimit = median * (1 - percentLimit);
            
            // Adicionar cada pre√ßo com indicador de outlier
            pricesData.forEach((priceItem, index) => {
              const priceValue = parseFloat(priceItem.price);
              const isOutlier = priceValue < lowerVisualLimit || priceValue > upperVisualLimit;
              
              priceInfoHTML += `
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px; padding: 5px; border-radius: 4px; ${isOutlier ? 'background: rgba(221,51,51,0.1);' : ''}">
                  <span style="color: ${isOutlier ? 'var(--cs2-danger-red)' : 'var(--cs2-text-light)'}; font-size: 0.9rem;">
                    ${priceItem.source || `Fonte ${index + 1}`}
                    ${isOutlier ? ' <span style="color: var(--cs2-danger-red); font-size: 0.8rem;">(outlier)</span>' : ''}
                  </span>
                  <span style="font-weight: 600; color: ${isOutlier ? 'var(--cs2-danger-red)' : 'var(--cs2-accent-orange)'}; font-size: 0.9rem;">
                    ${formatCurrency(priceValue)}
                  </span>
                </div>`;
            });
            
            priceInfoHTML += `</div></div>`;
          }
          
          // Adicionar informa√ß√µes sobre taxas e origem (compacto)
          priceInfoHTML += `
            <div style="margin-top: 15px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1); font-family: 'Rajdhani', sans-serif; color: var(--cs2-text-light); font-size: 0.8rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 8px;">
              <span style="opacity: 0.7;">Pre√ßo ${data.filtered ? 'm√©dio ajustado' : 'obtido'} do Mercado Steam</span>
              <span style="opacity: 0.6;">1 USD = ${CURRENCY_RATES.USD_to_BRL.toFixed(2)} BRL</span>
              <span style="opacity: 0.6;">${new Date().toLocaleString('pt-BR', {day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit'})}</span>
            </div>
          `;
          
          // Atualizar o elemento com as informa√ß√µes
          priceInfo.innerHTML = priceInfoHTML;
          
          // Esconder loading e mostrar dados
          priceLoading.style.display = 'none';
          priceData.style.display = 'block';
          
        } catch (error) {
          console.error('Erro ao buscar pre√ßo:', error);
          
          // Exibir mensagem de erro sem simula√ß√£o de pre√ßo
          priceInfo.innerHTML = `
            <div style="text-align: center; padding: 20px; background: rgba(221,51,51,0.1); border-radius: 6px;">
              <p style="color: var(--cs2-danger-red); font-weight: 600; font-size: 1.2rem; margin-bottom: 10px;">Pre√ßo n√£o dispon√≠vel</p>
              <p style="color: var(--cs2-text-light);">N√£o foi poss√≠vel obter o pre√ßo atual desta skin no mercado Steam.</p>
              <p style="color: var(--cs2-text-light); margin-top: 10px; font-size: 0.9rem;">${error.message || 'Erro de conex√£o com o mercado Steam'}</p>
              <div style="margin-top: 15px;">
                <a href="https://steamcommunity.com/market/search?q=${encodeURIComponent(fullSkinName)}" target="_blank" style="color: var(--cs2-info-blue); text-decoration: underline;">Verificar diretamente no mercado Steam</a>
              </div>
            </div>
          `;
          
          // Esconder loading e mostrar dados
          priceLoading.style.display = 'none';
          priceData.style.display = 'block';
        }
      }
      
      // Fun√ß√£o de fallback para simular pre√ßos (usado quando a API n√£o est√° dispon√≠vel)
      function simulatePriceFallback(skinName) {
        // Fontes comuns de pre√ßos de CS2 para simula√ß√£o
        const sourcesNames = [
          "Steam Market", 
          "Steam Community", 
          "CS.Money", 
          "SkinBaron", 
          "SkinPort", 
          "Buff163", 
          "BitSkins", 
          "DMarket", 
          "SkinWallet"
        ];
        
        // Valores aproximados baseados em experi√™ncia de mercado (mais realistas)
        const prices = {
          "AWP | Asiimov (Field-Tested)": [80.45, 82.30, 79.98, 81.50],
          "AK-47 | Redline (Field-Tested)": [11.55, 12.00, 11.85, 11.45],
          "M4A4 | Desolate Space (Factory New)": [25.75, 24.99, 25.50, 26.20],
          "StatTrak‚Ñ¢ CZ75-Auto | Tacticat": [2.50, 2.65, 2.45, 2.55],
          "Desert Eagle | Blaze (Factory New)": [230.45, 235.20, 232.80, 228.50],
          "Karambit | Fade (Factory New)": [950.00, 945.50, 960.30, 952.80],
          "USP-S | Kill Confirmed (Minimal Wear)": [82.75, 84.20, 81.90, 83.50]
        };
        
        // Se o item espec√≠fico n√£o estiver na lista, mas o tipo for conhecido, fazer estimativa
        const itemType = getItemType(skinName);
        if (!prices[skinName] && itemType) {
          const basePrices = {
            "AWP": [25, 40, 70, 120],
            "AK-47": [15, 30, 60, 100],
            "M4A4": [10, 25, 50, 85],
            "M4A1-S": [12, 28, 55, 90],
            "Desert Eagle": [8, 15, 30, 60],
            "USP-S": [10, 20, 40, 70],
            "Glock-18": [8, 18, 35, 60],
            "Knife": [90, 200, 350, 600],
            "Gloves": [70, 150, 300, 500],
            "StatTrak‚Ñ¢": [1.5, 2, 3, 0] // multiplicador
          };
          
          // Gerar pre√ßo base pelo tipo
          let basePrice = 5; // valor base m√≠nimo
          if (basePrices[itemType]) {
            // Selecionar faixa de pre√ßo pela qualidade
            let qualityIndex = 0;
            if (skinName.includes("Factory New")) qualityIndex = 3;
            else if (skinName.includes("Minimal Wear")) qualityIndex = 2;
            else if (skinName.includes("Field-Tested")) qualityIndex = 1;
            else qualityIndex = 0;
            
            basePrice = basePrices[itemType][qualityIndex];
          }
          
          // Ajustar para StatTrak
          if (skinName.includes("StatTrak‚Ñ¢") && basePrices["StatTrak‚Ñ¢"]) {
            const stMultiplier = basePrices["StatTrak‚Ñ¢"][Math.floor(Math.random() * 3)];
            basePrice *= stMultiplier;
          }
          
          // Gerar varia√ß√µes para simular fontes diferentes (varia√ß√£o realista de 1-5%)
          const basePriceUSD = basePrice;
          const variations = [];
          
          // Gerar pre√ßos para 4-6 fontes aleat√≥rias
          const numSources = 4 + Math.floor(Math.random() * 3);
          const selectedSources = [...sourcesNames].sort(() => 0.5 - Math.random()).slice(0, numSources);
          
          selectedSources.forEach((source, idx) => {
            const variation = (Math.random() * 0.08) - 0.04; // -4% a +4%
            variations.push({
              source: source,
              price: (basePriceUSD * (1 + variation)).toFixed(2)
            });
          });
          
          // Aplicar filtro de outliers aos valores
          const priceValues = variations.map(v => parseFloat(v.price));
          const filteredPrice = filterOutliersAndCalculateAverage(priceValues);
          
          return {
            market_hash_name: skinName,
            price: filteredPrice.toFixed(2),
            prices: variations,
            filtered: variations.length > 3,
            offline_mode: true
          };
        }
        
        // Se temos pre√ßos predefinidos para o item, us√°-los com nomes de fontes
        if (prices[skinName]) {
          // Escolher 4-6 fontes aleat√≥rias
          const numSources = Math.min(prices[skinName].length, 4 + Math.floor(Math.random() * 3));
          const selectedSources = [...sourcesNames].sort(() => 0.5 - Math.random()).slice(0, numSources);
          
          // Associar pre√ßos com fontes
          const variations = [];
          for (let i = 0; i < numSources; i++) {
            variations.push({
              source: selectedSources[i],
              price: prices[skinName][i % prices[skinName].length].toFixed(2)
            });
          }
          
          // Aplicar filtro de outliers
          const priceValues = variations.map(v => parseFloat(v.price));
          const filteredPrice = filterOutliersAndCalculateAverage(priceValues);
          
          return {
            market_hash_name: skinName,
            price: filteredPrice.toFixed(2),
            prices: variations,
            filtered: variations.length > 3,
            offline_mode: true
          };
        }
        
        // Pre√ßos padr√£o para skins n√£o conhecidas
        const basePrice = 5 + Math.random() * 20;
        const variations = [];
        
        // Gerar pre√ßos para 4-6 fontes aleat√≥rias
        const numSources = 4 + Math.floor(Math.random() * 3);
        const selectedSources = [...sourcesNames].sort(() => 0.5 - Math.random()).slice(0, numSources);
        
        selectedSources.forEach(source => {
          const variation = (Math.random() * 0.08) - 0.04; // -4% a +4%
          variations.push({
            source: source,
            price: (basePrice * (1 + variation)).toFixed(2)
          });
        });
        
        // Aplicar filtro de outliers
        const priceValues = variations.map(v => parseFloat(v.price));
        const filteredPrice = filterOutliersAndCalculateAverage(priceValues);
        
        return {
          market_hash_name: skinName,
          price: filteredPrice.toFixed(2),
          prices: variations,
          filtered: variations.length > 3,
          offline_mode: true
        };
      }
      
      // Fun√ß√£o auxiliar para determinar o tipo de item a partir do nome
      function getItemType(skinName) {
        const typeChecks = [
          { pattern: /AWP/i, type: "AWP" },
          { pattern: /AK-47/i, type: "AK-47" },
          { pattern: /M4A4/i, type: "M4A4" },
          { pattern: /M4A1-S/i, type: "M4A1-S" },
          { pattern: /Desert Eagle|Deagle/i, type: "Desert Eagle" },
          { pattern: /USP-S/i, type: "USP-S" },
          { pattern: /Glock-18/i, type: "Glock-18" },
          { pattern: /Knife|Karambit|Bayonet|Bowie|Butterfly|Daggers|Falchion|Flip|Gut|Huntsman|Navaja|Shadow|Stiletto|Talon|Ursus|Paracord|Nomad|Skeleton|Survival|Classic/i, type: "Knife" },
          { pattern: /Gloves|Wraps|Hand/i, type: "Gloves" }
        ];
        
        for (const check of typeChecks) {
          if (check.pattern.test(skinName)) {
            return check.type;
          }
        }
        
        return null;
      }
      
      // Fun√ß√£o para filtrar outliers e calcular pre√ßo m√©dio mais preciso
      function filterOutliersAndCalculateAverage(prices) {
        // Se temos menos de 3 pre√ßos, simplesmente calculamos a m√©dia
        if (!prices || prices.length < 3) {
          if (prices && prices.length > 0) {
            const sum = prices.reduce((acc, price) => acc + parseFloat(price), 0);
            return sum / prices.length;
          }
          return null;
        }
        
        // Converter para array de n√∫meros
        const priceValues = prices.map(p => typeof p === 'number' ? p : parseFloat(p));
        
        // Ordenar os pre√ßos para calcular a mediana (mais robusta que m√©dia para outliers)
        const sortedPrices = [...priceValues].sort((a, b) => a - b);
        
        // Calcular a mediana (valor central)
        const median = sortedPrices.length % 2 === 0
          ? (sortedPrices[sortedPrices.length / 2 - 1] + sortedPrices[sortedPrices.length / 2]) / 2
          : sortedPrices[Math.floor(sortedPrices.length / 2)];
        
        // Calcular desvio absoluto mediano (MAD) - medida mais robusta de dispers√£o
        const deviations = sortedPrices.map(price => Math.abs(price - median));
        deviations.sort((a, b) => a - b);
        const mad = deviations.length % 2 === 0
          ? (deviations[deviations.length / 2 - 1] + deviations[deviations.length / 2]) / 2
          : deviations[Math.floor(deviations.length / 2)];
        
        // Definir limites para detec√ß√£o de outliers
        // 1) Usando MAD com fator de escala (mais robusto para pequenos conjuntos de dados)
        const madFactor = 2.5; // Fator conservador para n√£o remover muito
        
        // 2) Usando tamb√©m um limite percentual baseado na mediana
        const percentLimit = 0.4; // 40% de desvio da mediana
        
        // Aplicar ambos os crit√©rios para ser um filtro mais preciso
        const upperLimit = Math.min(
          median + (madFactor * mad), 
          median * (1 + percentLimit)
        );
        
        const lowerLimit = Math.max(
          median - (madFactor * mad),
          median * (1 - percentLimit),
          0 // Evitar valores negativos
        );
        
        // Filtrar outliers
        const filteredPrices = priceValues.filter(price => 
          price >= lowerLimit && price <= upperLimit
        );
        
        // Se todos os pre√ßos foram filtrados, retorne a mediana
        if (filteredPrices.length === 0) {
          console.log(`Todos os pre√ßos foram considerados outliers. Usando mediana: ${median}`);
          return median;
        }
        
        // Calcular nova m√©dia sem outliers
        const filteredSum = filteredPrices.reduce((acc, price) => acc + price, 0);
        const filteredMean = filteredSum / filteredPrices.length;
        
        // Log para debug
        const outliersRemoved = priceValues.length - filteredPrices.length;
        if (outliersRemoved > 0) {
          console.log(`Pre√ßo processado: Mediana: ${median.toFixed(2)}, Pre√ßo filtrado: ${filteredMean.toFixed(2)}`);
          console.log(`Pre√ßos originais: ${priceValues.length}, Pre√ßos ap√≥s filtro: ${filteredPrices.length}, Outliers removidos: ${outliersRemoved}`);
          console.log(`Limites de filtragem: [${lowerLimit.toFixed(2)} - ${upperLimit.toFixed(2)}]`);
        }
        
        return filteredMean;
      }
      

      
      // Fun√ß√£o para adicionar event listeners de forma robusta
      function setupLoginButtons() {
        console.log('Configurando bot√µes de login...');
        
        // Bot√£o principal
        const mainLoginBtn = document.getElementById('login-btn');
        if (mainLoginBtn) {
          console.log('Bot√£o principal encontrado, adicionando listener');
          
          // FOR√áAR estilos para garantir que seja clic√°vel
          mainLoginBtn.style.pointerEvents = 'auto';
          mainLoginBtn.style.cursor = 'pointer';
          mainLoginBtn.style.zIndex = '1000';
          mainLoginBtn.style.position = 'relative';
          mainLoginBtn.style.opacity = '1';
          mainLoginBtn.style.display = 'inline-flex';
          mainLoginBtn.disabled = false;
          
          // Remover atributo onclick problem√°tico se existir
          mainLoginBtn.removeAttribute('onclick');
          
          // Fun√ß√£o de clique direta e simples
          const handleClick = function(e) {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            console.log('=== BOT√ÉO CLICADO! ===');
            console.log('Event:', e);
            console.log('loginWithSteam existe?', typeof loginWithSteam);
            console.log('window.loginWithSteam existe?', typeof window.loginWithSteam);
            
            try {
              if (typeof loginWithSteam === 'function') {
                loginWithSteam();
              } else if (window.loginWithSteam && typeof window.loginWithSteam === 'function') {
                window.loginWithSteam();
              } else {
                alert('Fun√ß√£o de login n√£o encontrada. Verifique o console para mais detalhes.');
                console.error('loginWithSteam n√£o est√° dispon√≠vel');
              }
            } catch (error) {
              console.error('Erro ao executar login:', error);
              alert('Erro ao fazer login: ' + error.message);
            }
            return false;
          };
          
          // Remover todos os listeners anteriores clonando o bot√£o
          const newBtn = mainLoginBtn.cloneNode(true);
          newBtn.removeAttribute('onclick');
          mainLoginBtn.parentNode.replaceChild(newBtn, mainLoginBtn);
          const freshBtn = document.getElementById('login-btn');
          
          // Aplicar estilos novamente
          freshBtn.style.pointerEvents = 'auto';
          freshBtn.style.cursor = 'pointer';
          freshBtn.style.zIndex = '1000';
          freshBtn.style.position = 'relative';
          freshBtn.style.opacity = '1';
          freshBtn.style.display = 'inline-flex';
          freshBtn.disabled = false;
          
          // Adicionar listener direto via onclick (mais confi√°vel)
          freshBtn.onclick = handleClick;
          
          // Tamb√©m adicionar addEventListener como backup
          freshBtn.addEventListener('click', handleClick, true);
          
          // Adicionar listener de mousedown para debug
          freshBtn.addEventListener('mousedown', function(e) {
            console.log('=== MOUSEDOWN NO BOT√ÉO ===');
          });
          
          // Adicionar tamb√©m para touchstart (mobile)
          freshBtn.addEventListener('touchstart', handleClick, true);
          
          console.log('Bot√£o configurado com sucesso!');
        } else {
          console.warn('Bot√£o principal n√£o encontrado!');
        }
        
        // Bot√µes secund√°rios (se existirem)
        const loginButtonsSecondary = document.querySelectorAll('.login-btn-secondary');
        console.log(`Encontrados ${loginButtonsSecondary.length} bot√µes secund√°rios`);
        loginButtonsSecondary.forEach((btn, index) => {
          console.log(`Adicionando listener ao bot√£o secund√°rio ${index + 1}`);
          btn.removeEventListener('click', loginWithSteam);
          btn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            console.log(`Bot√£o secund√°rio ${index + 1} clicado!`);
            loginWithSteam();
          });
          btn.style.pointerEvents = 'auto';
          btn.style.cursor = 'pointer';
          btn.style.zIndex = '10';
        });
        
        // Bot√£o de logout principal
        const mainLogoutBtn = document.getElementById('logout-btn');
        if (mainLogoutBtn) {
          mainLogoutBtn.removeEventListener('click', logout);
          mainLogoutBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            logout();
          });
          mainLogoutBtn.style.pointerEvents = 'auto';
          mainLogoutBtn.style.cursor = 'pointer';
        }
        
        // Bot√µes de logout secund√°rios (se existirem)
        const logoutButtonsSecondary = document.querySelectorAll('.logout-btn-secondary');
        logoutButtonsSecondary.forEach(btn => {
          btn.removeEventListener('click', logout);
          btn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            logout();
          });
          btn.style.pointerEvents = 'auto';
          btn.style.cursor = 'pointer';
        });
        
        console.log('Bot√µes de login configurados!');
      }
      
      // Chamar a fun√ß√£o de setup
      setupLoginButtons();
      
      // REMOVIDO: Event delegation estava bloqueando outros cliques
      // N√£o usar event delegation global que pode interferir com outros bot√µes
      
      // Evento para analisar pr√≥prio invent√°rio
      const myInventoryBtn = document.getElementById('my-inventory-btn');
      if (myInventoryBtn) {
        myInventoryBtn.addEventListener('click', analyzeOwnInventory);
      }
      
      // Extrair SteamID do token armazenado
      function getSteamIDFromToken() {
        if (!authToken) return null;
        
        try {
          // Tentar decodificar o token (pode ser JWT ou base64 simples)
          let decoded;
          if (authToken.includes('.')) {
            // JWT format
            const parts = authToken.split('.');
            decoded = JSON.parse(atob(parts[1]));
          } else {
            // Base64 simples
            decoded = JSON.parse(atob(authToken));
          }
          
          return decoded.steam_id || decoded.steamid || null;
        } catch (e) {
          console.error('Erro ao decodificar token:', e);
          return null;
        }
      }
      
      // Fun√ß√£o para analisar o pr√≥prio invent√°rio
      function analyzeOwnInventory() {
        if (!authToken) {
          alert('Voc√™ precisa estar logado para analisar seu pr√≥prio invent√°rio.');
          return;
        }
        
        // Extrair SteamID do token
        const steamId = getSteamIDFromToken();
        if (!steamId) {
          alert('N√£o foi poss√≠vel obter o SteamID. Por favor, fa√ßa login novamente.');
          return;
        }
        
        console.log('Analisando invent√°rio do SteamID:', steamId);
        
        // Exibir loading
        inventoryResult.style.opacity = '1';
        inventoryLoading.style.display = 'block';
        inventoryData.style.display = 'none';
        
        // Verificar se a API est√° dispon√≠vel
        const apiStatus = apiStatusIndicator ? apiStatusIndicator.style.backgroundColor : '';
        const isApiOffline = apiStatus === 'var(--cs2-danger-red)' || apiStatus === 'rgb(221, 51, 51)';
        
        if (isApiOffline || !API_BASE_URL) {
          // API offline, usar dados mockados
          console.log('API offline, usando dados mockados');
          showMockInventoryData();
          return;
        }
        
        // Primeiro, garantir que temos a taxa de c√¢mbio atualizada
        getExchangeRate().then(() => {
          // Usar endpoint p√∫blico com SteamID (n√£o precisa de autentica√ß√£o)
          const endpoint = `${API_BASE_URL}/inventory/${steamId}`;
          
          console.log(`Fazendo requisi√ß√£o para: ${endpoint}`);
          
          fetch(endpoint, { 
            method: 'GET',
            headers: {
              'Cache-Control': 'no-cache, no-store, must-revalidate',
              'Pragma': 'no-cache',
              'Expires': '0',
              'Content-Type': 'application/json',
              'Accept': 'application/json'
            },
            credentials: 'same-origin',
            cache: 'no-cache',
            mode: 'cors' // Mantemos 'cors' pois estamos usando par√¢metro de URL
          })
            .then(response => {
              console.log('Status da resposta:', response.status);
              if (!response.ok) {
                return response.json().then(error => {
                  throw new Error(`Erro ${response.status}: ${error.detail || JSON.stringify(error)}`);
                });
              }
              return response.json();
            })
            .then(data => {
              console.log('Dados do invent√°rio recebidos:', data);
              
              // Aplicar fator de corre√ß√£o para BRL usando a taxa atual
              // Fun√ß√£o melhorada para aplicar fator de corre√ß√£o a um item e filtrar outliers quando h√° m√∫ltiplas fontes
              const applyPriceCorrection = (item) => {
                if (item && item.price) {
                  // Verificar se o item tem m√∫ltiplos pre√ßos
                  if (item.price_sources && Array.isArray(item.price_sources) && item.price_sources.length > 1) {
                    // Extrair os pre√ßos de diferentes fontes
                    const prices = item.price_sources.map(source => source.price || 0);
                    
                    // Usar filtro de outliers para calcular o pre√ßo ajustado
                    const filteredPrice = filterOutliersAndCalculateAverage(prices);
                    
                    // Atualizar informa√ß√µes do item
                    item.original_price = item.price;
                    item.price = filteredPrice;
                    item.filtered = true;
                    item.price_sources_count = item.price_sources.length;
                    
                    console.log(`Item filtrado: ${item.name}, Pre√ßo original: ${item.original_price}, Pre√ßo filtrado: ${item.price}`);
                  }
                  
                  const originalPrice = parseFloat(item.price);
                  // A API sempre retorna em USD, ent√£o sempre converter para BRL
                  item.price = originalPrice * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR;
                  if (item.total) {
                    item.total = item.price * (item.quantity || 1);
                  }
                  
                  // Converter tamb√©m os pre√ßos de fontes individuais, se existirem
                  if (item.price_sources && Array.isArray(item.price_sources)) {
                    item.price_sources = item.price_sources.map(source => {
                      if (source.price) {
                        source.original_price_usd = source.price;
                        source.price = parseFloat(source.price) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR;
                      }
                      return source;
                    });
                  }
                }
                return item;
              };
              
              // Aplicar corre√ß√£o a todos os itens
              if (data.items && Array.isArray(data.items)) {
                data.items = data.items.map(applyPriceCorrection);
              }
              
              // Aplicar corre√ß√£o a todos os itens se usar unidades de armazenamento
              if (data.all_items && Array.isArray(data.all_items)) {
                data.all_items = data.all_items.map(applyPriceCorrection);
              }
              
              // Aplicar corre√ß√£o √†s unidades de armazenamento
              if (data.storage_unit_contents && Array.isArray(data.storage_unit_contents)) {
                data.storage_unit_contents.forEach(unit => {
                  if (unit.contents && unit.contents.items) {
                    unit.contents.items = unit.contents.items.map(applyPriceCorrection);
                    // Recalcular o valor total da unidade
                    unit.contents.total_value = unit.contents.items.reduce((sum, item) => sum + (item.total || item.price || 0), 0);
                  }
                });
                
                // Recalcular o valor total das unidades
                data.storage_units_content_value = data.storage_unit_contents.reduce(
                  (sum, unit) => sum + (unit.contents?.total_value || 0), 0
                );
              }
              
              // Recalcular os totais
              // A API sempre retorna em USD, ent√£o sempre converter para BRL
              if (data.total_value !== undefined) {
                data.total_value = data.total_value * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR;
              }
              
              if (data.grand_total_value !== undefined) {
                // Se o total j√° n√£o incluir o valor corrigido das unidades
                data.grand_total_value = data.total_value + (data.storage_units_content_value || 0);
              }
              
              // Determina qual valor total mostrar com base no tipo de resposta
              const totalValue = data.grand_total_value || data.total_value || 0;
              inventoryTotalValue.textContent = formatCurrency(totalValue);
              
              // Armazenar dados para exporta√ß√£o
              lastInventoryData = data;
              
              // Calcular estat√≠sticas de filtragem de pre√ßos
              const filteredItemsCount = data.items ? 
                data.items.filter(item => item.filtered).length : 
                (data.all_items ? data.all_items.filter(item => item.filtered).length : 0);
              
              // Preenche o resumo
              let summaryHTML = `
                <div style="margin-bottom: 1.5rem; padding: 15px; background: rgba(19,30,43,0.5); border-radius: 8px;">
                  <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Total de Itens:</span>
                    <span style="font-weight: 600;">${data.total_items || 0}</span>
                  </div>
                  <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Valor M√©dio por Item:</span>
                    <span style="font-weight: 600;">${formatCurrency((totalValue) / (data.total_items || 1))}</span>
                  </div>`;
                  
              // Adicionar informa√ß√µes sobre a taxa de c√¢mbio
              summaryHTML += `
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                  <span>Taxa USD ‚Üí BRL:</span>
                  <span style="font-weight: 600;">1 USD = ${CURRENCY_RATES.USD_to_BRL.toFixed(2)} BRL</span>
                </div>`;
                
              // Adicionar informa√ß√£o sobre itens com pre√ßos filtrados
              if (filteredItemsCount > 0) {
                summaryHTML += `
                  <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Itens com pre√ßos filtrados:</span>
                    <span style="font-weight: 600; color: var(--cs2-accent-green);">${filteredItemsCount}</span>
                  </div>`;
              }
                  
              // Adicionar informa√ß√µes sobre unidades de armazenamento se dispon√≠veis
              if (data.storage_units_content_value !== undefined) {
                summaryHTML += `
                  <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Valor em Unidades:</span>
                    <span style="font-weight: 600;">${formatCurrency(data.storage_units_content_value)}</span>
                  </div>
                  <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Valor em Invent√°rio:</span>
                    <span style="font-weight: 600;">${formatCurrency(data.total_value)}</span>
                  </div>
                `;
              }
              
              // Adicionar item mais valioso se dispon√≠vel
              if (data.most_valuable_item) {
                summaryHTML += `
                  <div style="display: flex; justify-content: space-between;">
                    <span>Item Mais Valioso:</span>
                    <span style="font-weight: 600; color: var(--cs2-accent-orange);">${data.most_valuable_item?.name || 'N/A'}</span>
                  </div>
                `;
              }
              
              summaryHTML += `</div>`;
              inventorySummary.innerHTML = summaryHTML;
              
              // Preenche a lista de itens
              let itemsHTML = '<h4 style="font-family: \'Orbitron\', sans-serif; color: var(--cs2-primary-gold); margin: 1rem 0; font-size: 1.1rem;">Itens Mais Valiosos</h4>';
              
              // Determinar quais itens mostrar com base no tipo de resposta
              let itemsToShow = [];
              
              if (data.all_items && data.all_items.length > 0) {
                // Resposta da an√°lise com unidades de armazenamento
                itemsToShow = data.all_items;
              } else if (data.items && data.items.length > 0) {
                // Resposta normal
                itemsToShow = data.items;
              }
              
              // Adiciona itens se dispon√≠veis
              if (itemsToShow.length > 0) {
                itemsToShow.sort((a, b) => b.price - a.price).slice(0, 10).forEach(item => {
                  itemsHTML += createItemCard(item);
                });
              } else {
                itemsHTML += '<p style="color: var(--cs2-text-light); opacity: 0.7;">Nenhum item encontrado</p>';
              }
              
              // Adicionar se√ß√£o de unidades de armazenamento se dispon√≠vel
              if (data.storage_unit_contents && data.storage_unit_contents.length > 0) {
                itemsHTML += `
                  <h4 style="font-family: 'Orbitron', sans-serif; color: var(--cs2-primary-gold); margin: 1.5rem 0 1rem; font-size: 1.1rem; border-top: 1px solid rgba(255,215,0,0.2); padding-top: 1.5rem;">Unidades de Armazenamento</h4>
                `;
                
                data.storage_unit_contents.forEach(unit => {
                  itemsHTML += createStorageUnitCard(unit);
                });
              }
              
              inventoryItems.innerHTML = itemsHTML;
              
              // Exibe os dados
              inventoryLoading.style.display = 'none';
              inventoryData.style.display = 'block';
            })
            .catch(error => {
              console.error('Erro ao analisar invent√°rio:', error);
              console.log('API offline, usando dados mockados para demonstra√ß√£o');
              
              // Usar dados mockados quando a API estiver offline
              showMockInventoryData();
            });
        }); // Fechar o .then() do getExchangeRate()
      }
      
      // Fun√ß√µes auxiliares para extrair informa√ß√µes do nome do item
      function extractMarketHashName(fullName) {
        // Remove StatTrak‚Ñ¢ e wear condition do nome
        return fullName
          .replace(/StatTrak‚Ñ¢?\s*/gi, '')
          .replace(/\s*\([^)]+\)$/, '')
          .trim();
      }
      
      function extractExterior(fullName) {
        // Extrai a condi√ß√£o do nome
        const match = fullName.match(/\(([^)]+)\)$/);
        if (match) {
          return match[1];
        }
        return 'Field-Tested'; // Padr√£o se n√£o encontrar
      }
      
      function extractStatTrak(fullName) {
        // Verifica se o nome cont√©m StatTrak
        return /StatTrak‚Ñ¢?/i.test(fullName);
      }
      
      // Fun√ß√£o para buscar hist√≥rico de pre√ßos para m√∫ltiplos itens
      async function fetchPriceHistoryForItems(items) {
        if (!items || items.length === 0) {
          console.warn('[PRICE_HISTORY] Nenhum item para buscar hist√≥rico');
          return;
        }
        
        console.log(`üìä [PRICE_HISTORY] Buscando hist√≥rico para ${items.length} itens...`);
        
        let successCount = 0;
        let failCount = 0;
        
        // Processar itens sequencialmente (com delay entre requisi√ß√µes para n√£o sobrecarregar a API)
        for (let i = 0; i < items.length; i++) {
          const item = items[i];
          
          // Adicionar delay entre requisi√ß√µes
          if (i > 0) {
            await new Promise(resolve => setTimeout(resolve, 200)); // 200ms entre requisi√ß√µes
          }
          
          // S√≥ buscar hist√≥rico se o item tiver os dados necess√°rios
          if (!item.market_hash_name || !item.exterior) {
            console.warn(`‚ö†Ô∏è [PRICE_HISTORY] Item ${i + 1} sem market_hash_name ou exterior:`, item.name);
            continue;
          }
          
          try {
            const params = new URLSearchParams({
              market_hash_name: item.market_hash_name,
              exterior: item.exterior || 'Field-Tested',
              stattrack: (item.stattrack || false).toString()
            });
            
            const endpoint = `${API_BASE_URL}/api/inventory/item-price?${params}`;
            console.log(`üìä [PRICE_HISTORY] Buscando hist√≥rico para: ${item.name} (${i + 1}/${items.length})`);
            
            const response = await fetch(endpoint, {
              method: 'GET',
              headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                'Cache-Control': 'no-cache'
              },
              mode: 'cors',
              cache: 'no-cache'
            });
            
            if (!response.ok) {
              console.warn(`‚ö†Ô∏è [PRICE_HISTORY] HTTP ${response.status} para ${item.name}`);
              failCount++;
              continue;
            }
            
            const data = await response.json();
            
            // Converter price_history da API para o formato esperado pelo dashboard
            if (data.price_history) {
              let priceHistory = null;
              
              if (data.price_history.entries && Array.isArray(data.price_history.entries)) {
                // Formato da API: {entries: [{date, price_usd, ...}]}
                priceHistory = data.price_history.entries.map(entry => ({
                  date: entry.date,
                  price: parseFloat(entry.price_usd || entry.price || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR
                }));
              } else if (Array.isArray(data.price_history)) {
                // J√° est√° no formato esperado
                priceHistory = data.price_history.map(entry => ({
                  date: entry.date,
                  price: parseFloat(entry.price || entry.price_usd || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR
                }));
              }
              
              if (priceHistory && priceHistory.length > 0) {
                item.price_history = priceHistory;
                successCount++;
                console.log(`‚úÖ [PRICE_HISTORY] Hist√≥rico carregado para ${item.name}: ${priceHistory.length} entradas`);
              } else {
                console.warn(`‚ö†Ô∏è [PRICE_HISTORY] Hist√≥rico vazio para ${item.name}`);
                failCount++;
              }
            } else {
              console.warn(`‚ö†Ô∏è [PRICE_HISTORY] Sem price_history na resposta para ${item.name}`);
              failCount++;
            }
          } catch (error) {
            console.error(`‚ùå [PRICE_HISTORY] Erro ao buscar hist√≥rico para ${item.name}:`, error);
            failCount++;
          }
        }
        
        console.log(`üìä [PRICE_HISTORY] Resumo: ${successCount} sucessos, ${failCount} falhas`);
      }
      
      // Fun√ß√£o para buscar pre√ßo no Steam Market como fallback
      async function fetchSteamMarketPrice(item) {
        try {
          // Construir nome completo da skin para busca
          let searchName = item.name || item.market_hash_name || '';
          
          if (!searchName) {
            console.warn('Item sem nome para buscar no Steam Market:', item);
            return null;
          }
          
          // Gerar varia√ß√µes do nome para tentar diferentes buscas
          const searchVariations = [];
          
          // Varia√ß√£o 1: Nome original com StatTrak se necess√°rio
          if (item.stattrack && !searchName.toLowerCase().includes('stattrak')) {
            searchVariations.push('StatTrak‚Ñ¢ ' + searchName);
            // Tamb√©m tentar sem o s√≠mbolo ‚Ñ¢
            searchVariations.push('StatTrak ' + searchName);
          } else {
            searchVariations.push(searchName);
          }
          
          // Varia√ß√£o 2: Remover wear condition e tentar buscar gen√©rico
          const nameWithoutWear = searchName.replace(/\s*\([^)]+\)\s*$/, '').trim();
          if (nameWithoutWear !== searchName) {
            if (item.stattrack && !nameWithoutWear.toLowerCase().includes('stattrak')) {
              searchVariations.push('StatTrak‚Ñ¢ ' + nameWithoutWear);
              searchVariations.push('StatTrak ' + nameWithoutWear);
            } else {
              searchVariations.push(nameWithoutWear);
            }
          }
          
          // Varia√ß√£o 3: Apenas market_hash_name (sem wear)
          if (item.market_hash_name && item.market_hash_name !== searchName) {
            if (item.stattrack && !item.market_hash_name.toLowerCase().includes('stattrak')) {
              searchVariations.push('StatTrak‚Ñ¢ ' + item.market_hash_name);
              searchVariations.push('StatTrak ' + item.market_hash_name);
            } else {
              searchVariations.push(item.market_hash_name);
            }
          }
          
          console.log(`üîç [FALLBACK] Item: ${item.name}, StatTrak: ${item.stattrack}`);
          console.log(`üîç [FALLBACK] Varia√ß√µes para tentar:`, searchVariations);
          
          // Tentar cada varia√ß√£o at√© encontrar um pre√ßo
          for (const variation of searchVariations) {
            const searchUrl = `https://steamcommunity.com/market/search?q=${encodeURIComponent(variation)}`;
            console.log(`üîç [FALLBACK] Tentando busca: ${searchUrl}`);
          
            // Usar proxy CORS para fazer a requisi√ß√£o
            const corsProxy = 'https://api.allorigins.win/raw?url=';
            const proxyUrl = corsProxy + encodeURIComponent(searchUrl);
            
            try {
              const response = await fetch(proxyUrl, {
                method: 'GET',
                headers: {
                  'Accept': 'text/html',
                },
                cache: 'no-cache'
              });
              
              if (!response.ok) {
                console.warn(`HTTP ${response.status} para varia√ß√£o: ${variation}`);
                continue; // Tentar pr√≥xima varia√ß√£o
              }
              
              const html = await response.text();
              
              // Extrair pre√ßo do HTML do Steam Market
              // O Steam Market usa data-price no formato centavos (ex: data-price="800" = $8.00)
              // Vamos procurar por v√°rios padr√µes diferentes
              let priceUSD = null;
              let pricesFound = [];
              
              // Prioridade 1: Buscar data-price (mais confi√°vel, est√° em centavos)
              const dataPricePattern = /data-price="(\d+)"/gi;
              const dataPriceMatches = html.matchAll(dataPricePattern);
              for (const match of dataPriceMatches) {
                if (match && match[1]) {
                  // Converter de centavos para d√≥lares
                  const priceInCents = parseInt(match[1]);
                  const price = priceInCents / 100;
                  if (price > 0 && price < 100000) {
                    pricesFound.push(price);
                    console.log(`‚úÖ Pre√ßo encontrado via data-price: $${price} (${priceInCents} centavos)`);
                  }
                }
              }
              
              // Prioridade 2: Buscar padr√µes de texto se data-price n√£o funcionar
              if (pricesFound.length === 0) {
                const pricePatterns = [
                  // Padr√£o: Starting at: $X.XX
                  /Starting at:\s*\$([\d,]+\.?\d*)/gi,
                  // Padr√£o: $X.XX USD
                  /\$([\d,]+\.?\d*)\s*USD/gi,
                  // Padr√£o: normal_price no JSON
                  /"normal_price":"\$([\d,]+\.?\d*)"/gi,
                  // Padr√£o: span com normal_price
                  /<span[^>]*class="[^"]*normal_price[^"]*"[^>]*>\s*\$([\d,]+\.?\d*)/gi,
                  // Padr√£o: market_listing_price_with_fee
                  /market_listing_price_with_fee[^>]*>\s*\$([\d,]+\.?\d*)/gi
                ];
                
                for (const pattern of pricePatterns) {
                  try {
                    const matches = html.matchAll(pattern);
                    for (const match of matches) {
                      if (match && match[1]) {
                        const price = parseFloat(match[1].replace(/,/g, ''));
                        if (price > 0 && price < 100000) {
                          pricesFound.push(price);
                        }
                      }
                    }
                  } catch (e) {
                    console.warn('Erro ao processar padr√£o regex:', e);
                  }
                }
              }
              
              // Se encontrou pre√ßos, usar o menor (geralmente √© o "Starting at")
              if (pricesFound.length > 0) {
                pricesFound.sort((a, b) => a - b);
                priceUSD = pricesFound[0]; // Pegar o menor pre√ßo
                console.log(`‚úÖ Pre√ßos encontrados: ${pricesFound.join(', ')}, usando: $${priceUSD} (varia√ß√£o: ${variation})`);
                console.log(`‚úÖ Pre√ßo encontrado no Steam Market para ${item.name}: $${priceUSD}`);
                return priceUSD;
              } else {
                console.log(`‚ö†Ô∏è Nenhum pre√ßo encontrado para varia√ß√£o: ${variation}`);
              }
            } catch (fetchError) {
              console.warn(`Erro ao buscar varia√ß√£o "${variation}":`, fetchError);
              continue; // Tentar pr√≥xima varia√ß√£o
            }
          }
          
          // Se nenhuma varia√ß√£o funcionou
          console.warn(`‚ùå Pre√ßo n√£o encontrado no Steam Market para ${item.name} ap√≥s tentar ${searchVariations.length} varia√ß√µes`);
          return null;
          
        } catch (error) {
          console.error(`Erro ao buscar pre√ßo no Steam Market para ${item.name}:`, error);
          return null;
        }
      }
      
      // Fun√ß√£o para buscar pre√ßos no Steam Market para m√∫ltiplos itens
      async function fetchSteamMarketPrices(items) {
        if (!items || items.length === 0) {
          console.warn('[FALLBACK] Nenhum item para buscar no Steam Market');
          return;
        }
        
        console.log(`üöÄ [FALLBACK] Iniciando busca no Steam Market para ${items.length} itens...`);
        console.log(`üöÄ [FALLBACK] Itens:`, items.map(item => item.name));
        
        let successCount = 0;
        let failCount = 0;
        
        // Processar itens sequencialmente (com delay entre requisi√ß√µes)
        for (let i = 0; i < items.length; i++) {
          const item = items[i];
          
          // Adicionar delay entre requisi√ß√µes para n√£o sobrecarregar o Steam Market
          if (i > 0) {
            console.log(`‚è≥ [FALLBACK] Aguardando 1 segundo antes da pr√≥xima requisi√ß√£o...`);
            await new Promise(resolve => setTimeout(resolve, 1000)); // 1 segundo entre requisi√ß√µes
          }
          
          console.log(`üì¶ [FALLBACK] Processando item ${i + 1}/${items.length}: ${item.name}`);
          const priceUSD = await fetchSteamMarketPrice(item);
          
          if (priceUSD && priceUSD > 0) {
            // Preservar dados importantes da API (n√£o sobrescrever)
            const originalImageUrl = item.image_url;
            const originalIconUrl = item.icon_url;
            const originalPriceHistory = item.price_history; // Preservar hist√≥rico de pre√ßos
            
            // Converter para BRL
            item.price = priceUSD * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR;
            item.total = item.price * (item.quantity || 1);
            item.error = null;
            item.needsSteamMarketFallback = false;
            item.price_source = 'Steam Market (Fallback)';
            
            // Garantir que a imagem da API seja preservada
            if (originalImageUrl) {
              item.image_url = originalImageUrl;
            }
            if (originalIconUrl) {
              item.icon_url = originalIconUrl;
            }
            
            // Garantir que o hist√≥rico de pre√ßos seja preservado
            if (originalPriceHistory) {
              item.price_history = originalPriceHistory;
            }
            
            successCount++;
            console.log(`‚úÖ [FALLBACK] Pre√ßo encontrado para ${item.name}: $${priceUSD} USD = R$ ${item.price.toFixed(2)}`);
            console.log(`üñºÔ∏è [FALLBACK] Imagem preservada: ${item.image_url || item.icon_url || 'nenhuma'}`);
            console.log(`üìä [FALLBACK] Hist√≥rico preservado: ${originalPriceHistory ? originalPriceHistory.length + ' entradas' : 'nenhum'}`);
          } else {
            failCount++;
            console.warn(`‚ùå [FALLBACK] Pre√ßo n√£o encontrado no Steam Market para ${item.name}`);
          }
        }
        
        // Recalcular total ap√≥s fallback
        const totalAfterFallback = items.reduce((sum, item) => sum + (item.total || 0), 0);
        console.log(`üìä [FALLBACK] Resumo: ${successCount} sucessos, ${failCount} falhas`);
        console.log(`üí∞ [FALLBACK] Total ap√≥s fallback: R$ ${totalAfterFallback.toFixed(2)}`);
      }
      
      // Fun√ß√£o para mostrar dados mockados e enviar para a API
      async function showMockInventoryData() {
        console.log('Usando dados mockados e enviando para API para buscar pre√ßos reais');
        
        // Dados mockados elaborados com todas as informa√ß√µes necess√°rias
        const mockInventoryItems = [
          {
            name: "AK-47 | Redline (Field-Tested)",
            market_hash_name: "AK-47 | Redline",
            exterior: "Field-Tested",
            stattrack: false,
            quantity: 1,
            category: "Rifle",
            rarity: "Classified",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678901"
          },
          {
            name: "AWP | Dragon Lore (Factory New)",
            market_hash_name: "AWP | Dragon Lore",
            exterior: "Factory New",
            stattrack: false,
            quantity: 1,
            category: "Sniper Rifle",
            rarity: "Covert",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678902"
          },
          {
            name: "StatTrak‚Ñ¢ M4A4 | Howl (Minimal Wear)",
            market_hash_name: "M4A4 | Howl",
            exterior: "Minimal Wear",
            stattrack: true,
            quantity: 1,
            category: "Rifle",
            rarity: "Contraband",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678903"
          },
          {
            name: "Karambit | Fade (Factory New)",
            market_hash_name: "Karambit | Fade",
            exterior: "Factory New",
            stattrack: false,
            quantity: 1,
            category: "Knife",
            rarity: "Covert",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678904"
          },
          {
            name: "StatTrak‚Ñ¢ Glock-18 | Fade (Factory New)",
            market_hash_name: "Glock-18 | Fade",
            exterior: "Factory New",
            stattrack: true,
            quantity: 1,
            category: "Pistol",
            rarity: "Classified",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678905"
          },
          {
            name: "AK-47 | Fire Serpent (Field-Tested)",
            market_hash_name: "AK-47 | Fire Serpent",
            exterior: "Field-Tested",
            stattrack: false,
            quantity: 1,
            category: "Rifle",
            rarity: "Covert",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678906"
          },
          {
            name: "AWP | Asiimov (Field-Tested)",
            market_hash_name: "AWP | Asiimov",
            exterior: "Field-Tested",
            stattrack: false,
            quantity: 2,
            category: "Sniper Rifle",
            rarity: "Classified",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678907"
          },
          {
            name: "M4A1-S | Icarus Fell (Factory New)",
            market_hash_name: "M4A1-S | Icarus Fell",
            exterior: "Factory New",
            stattrack: false,
            quantity: 1,
            category: "Rifle",
            rarity: "Classified",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678908"
          },
          {
            name: "Desert Eagle | Blaze (Factory New)",
            market_hash_name: "Desert Eagle | Blaze",
            exterior: "Factory New",
            stattrack: false,
            quantity: 1,
            category: "Pistol",
            rarity: "Covert",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678909"
          },
          {
            name: "AK-47 | Vulcan (Minimal Wear)",
            market_hash_name: "AK-47 | Vulcan",
            exterior: "Minimal Wear",
            stattrack: false,
            quantity: 1,
            category: "Rifle",
            rarity: "Classified",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678910"
          },
          {
            name: "StatTrak‚Ñ¢ AWP | Medusa (Field-Tested)",
            market_hash_name: "AWP | Medusa",
            exterior: "Field-Tested",
            stattrack: true,
            quantity: 1,
            category: "Sniper Rifle",
            rarity: "Covert",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678911"
          },
          {
            name: "M4A4 | Poseidon (Factory New)",
            market_hash_name: "M4A4 | Poseidon",
            exterior: "Factory New",
            stattrack: false,
            quantity: 1,
            category: "Rifle",
            rarity: "Covert",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678912"
          },
          {
            name: "Butterfly Knife | Fade (Factory New)",
            market_hash_name: "Butterfly Knife | Fade",
            exterior: "Factory New",
            stattrack: false,
            quantity: 1,
            category: "Knife",
            rarity: "Covert",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678913"
          },
          {
            name: "StatTrak‚Ñ¢ AK-47 | Case Hardened (Well-Worn)",
            market_hash_name: "AK-47 | Case Hardened",
            exterior: "Well-Worn",
            stattrack: true,
            quantity: 1,
            category: "Rifle",
            rarity: "Classified",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678914"
          },
          {
            name: "USP-S | Kill Confirmed (Minimal Wear)",
            market_hash_name: "USP-S | Kill Confirmed",
            exterior: "Minimal Wear",
            stattrack: false,
            quantity: 1,
            category: "Pistol",
            rarity: "Covert",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678915"
          },
          {
            name: "AWP | Oni Taiji (Battle-Scarred)",
            market_hash_name: "AWP | Oni Taiji",
            exterior: "Battle-Scarred",
            stattrack: false,
            quantity: 1,
            category: "Sniper Rifle",
            rarity: "Classified",
            icon_url: "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjxszJemkV09-5gZKKkuXLPr7Vn35cppwl3r3E9t2s3gHgqkE4Z2-mJ4fDc1M3Y1rV-lC_x-7s1sO5tJ7Nv3Rjz3Mh5CvDlQ",
            assetid: "12345678916"
          }
        ];
        
        // Exibir loading
        inventoryLoading.style.display = 'block';
        inventoryData.style.display = 'none';
        inventoryResult.style.opacity = '1';
        
        // Garantir que temos a taxa de c√¢mbio atualizada
        await getExchangeRate();
        
        // Preparar itens no formato da API
        const itemsForAPI = mockInventoryItems.map(item => ({
          name: item.name,
          market_hash_name: item.market_hash_name,
          exterior: item.exterior,
          stattrack: item.stattrack,
          quantity: item.quantity,
          icon_url: item.icon_url,
          assetid: item.assetid,
          rarity: item.rarity,
          category: item.category
        }));
        
        try {
          // Enviar para a API para buscar pre√ßos reais
          const apiUrl = `${API_BASE_URL}/api/inventory/analyze-items`;
          console.log('=== ENVIANDO PARA API ===');
          console.log('URL:', apiUrl);
          console.log('API_BASE_URL:', API_BASE_URL);
          console.log('Itens enviados:', itemsForAPI.length);
          console.log('Primeiro item exemplo:', itemsForAPI[0]);
          console.log('Payload completo:', JSON.stringify({ items: itemsForAPI }, null, 2));
          
          const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Cache-Control': 'no-cache, no-store, must-revalidate',
              'Pragma': 'no-cache',
              'Expires': '0'
            },
            body: JSON.stringify({
              items: itemsForAPI
            }),
            credentials: 'same-origin',
            cache: 'no-cache',
            mode: 'cors'
          });
          
          console.log('Status da resposta:', response.status);
          console.log('Headers da resposta:', [...response.headers.entries()]);
          
          if (!response.ok) {
            const errorText = await response.text();
            console.error('Erro na resposta:', errorText);
            throw new Error(`Erro ${response.status}: ${errorText}`);
          }
          
          const apiData = await response.json();
          console.log('Resposta completa da API:', JSON.stringify(apiData, null, 2));
          console.log('Total de itens na resposta:', apiData.total_items);
          console.log('Total value USD:', apiData.total_value_usd);
          console.log('Items recebidos:', apiData.items?.length);
          
          // Verificar se os itens t√™m image_url
          if (apiData.items && apiData.items.length > 0) {
            console.log('Primeiro item da API:', apiData.items[0]);
            const itemsWithImage = apiData.items.filter(item => item.image_url || item.icon_url);
            console.log(`Itens com imagem: ${itemsWithImage.length} de ${apiData.items.length}`);
            if (itemsWithImage.length > 0) {
              console.log('Exemplo de item com imagem:', itemsWithImage[0]);
            }
          }
          
          // Verificar se a resposta tem dados v√°lidos
          if (!apiData.items || !Array.isArray(apiData.items) || apiData.items.length === 0) {
            console.warn('API retornou sem itens ou array vazio');
            throw new Error('API retornou sem dados de itens');
          }
          
          // Processar resposta da API da mesma forma que os dados reais
          // Aplicar convers√£o USD -> BRL
          const applyPriceCorrection = (item, index) => {
            console.log(`Processando item ${index}:`, item);
            
            // A API pode retornar price_usd ou price (j√° em USD)
            let priceUSD = 0;
            if (item.price_usd !== undefined && item.price_usd !== null) {
              priceUSD = parseFloat(item.price_usd);
            } else if (item.price !== undefined && item.price !== null) {
              // Se j√° vier como price, assumir que est√° em USD
              priceUSD = parseFloat(item.price);
            }
            
            console.log(`Item ${index} - priceUSD:`, priceUSD);
            
            if (priceUSD > 0) {
              item.price = priceUSD * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR;
              
              // Calcular total
              if (item.total_usd !== undefined && item.total_usd !== null) {
                item.total = parseFloat(item.total_usd) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR;
              } else {
                const quantity = item.quantity || 1;
                item.total = item.price * quantity;
              }
              
              console.log(`Item ${index} - price BRL:`, item.price, 'total BRL:', item.total);
            } else {
              console.warn(`Item ${index} sem pre√ßo v√°lido - tentando fallback Steam Market`);
              item.price = 0;
              item.total = 0;
              item.error = 'Pre√ßo n√£o encontrado na API';
              // Marcar para buscar no Steam Market
              item.needsSteamMarketFallback = true;
            }
            
            return item;
          };
          
          // Aplicar corre√ß√£o a todos os itens
          apiData.items = apiData.items.map(applyPriceCorrection);
          
          // Converter total inicial
          let totalValueBRL = 0;
          if (apiData.total_value_usd !== undefined && apiData.total_value_usd !== null) {
            totalValueBRL = parseFloat(apiData.total_value_usd) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR;
            apiData.total_value = totalValueBRL;
          } else {
            // Calcular total somando os itens processados
            totalValueBRL = apiData.items.reduce((sum, item) => sum + (item.total || 0), 0);
            apiData.total_value = totalValueBRL;
          }
          
          console.log('Total value BRL calculado (antes do fallback):', totalValueBRL);
          
          // Combinar dados da API com informa√ß√µes dos itens mockados (antes do fallback)
          const processedData = {
            total_items: apiData.total_items || apiData.items.length || mockInventoryItems.length,
            total_value: apiData.total_value || totalValueBRL || 0,
            items: apiData.items.map((apiItem, index) => {
              const mockItem = mockInventoryItems[index] || {};
              
              // Converter price_history da API para o formato esperado pelo dashboard
              let priceHistory = null;
              if (apiItem.price_history) {
                if (apiItem.price_history.entries && Array.isArray(apiItem.price_history.entries)) {
                  // Formato da API: {entries: [{date, price_usd, ...}]}
                  priceHistory = apiItem.price_history.entries.map(entry => ({
                    date: entry.date,
                    price: parseFloat(entry.price_usd || entry.price || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR
                  }));
                } else if (Array.isArray(apiItem.price_history)) {
                  // J√° est√° no formato esperado
                  priceHistory = apiItem.price_history.map(entry => ({
                    date: entry.date,
                    price: parseFloat(entry.price || entry.price_usd || 0) * CURRENCY_RATES.USD_to_BRL * STEAM_TAX_FACTOR
                  }));
                }
              }
              
              return {
                ...mockItem,
                ...apiItem,
                // Garantir que temos os campos necess√°rios
                name: apiItem.name || mockItem.name,
                market_hash_name: apiItem.market_hash_name || mockItem.market_hash_name,
                exterior: apiItem.exterior || mockItem.exterior,
                stattrack: apiItem.stattrack !== undefined ? apiItem.stattrack : mockItem.stattrack,
                quantity: apiItem.quantity || mockItem.quantity || 1,
                category: apiItem.category || mockItem.category,
                rarity: apiItem.rarity || mockItem.rarity,
                price: apiItem.price || 0,
                total: apiItem.total || (apiItem.price || 0) * (apiItem.quantity || mockItem.quantity || 1),
                // Preservar hist√≥rico de pre√ßos convertido
                price_history: priceHistory || mockItem.price_history || null,
                // Priorizar image_url/icon_url da API (do csgoskins)
                // A API agora retorna imagem mesmo sem pre√ßo; o pre√ßo pode vir do Steam Market via fallback
                image_url: apiItem.image_url || apiItem.icon_url || mockItem.image_url || mockItem.icon_url,
                icon_url: apiItem.icon_url || apiItem.image_url || mockItem.icon_url || mockItem.image_url
              };
            })
          };
          
          // Exibir os dados iniciais (com itens que j√° t√™m pre√ßo)
          displayInventoryData(processedData, true);
          
          // Buscar hist√≥rico de pre√ßos para cada item (em background)
          console.log('üìä Buscando hist√≥rico de pre√ßos para os itens...');
          fetchPriceHistoryForItems(processedData.items).then(() => {
            console.log('‚úÖ Hist√≥rico de pre√ßos carregado para todos os itens');
            
            // Verificar quantos itens t√™m hist√≥rico
            const itemsWithHistory = processedData.items.filter(item => item.price_history && item.price_history.length > 0);
            console.log(`üìä Itens com hist√≥rico: ${itemsWithHistory.length} de ${processedData.items.length}`);
            if (itemsWithHistory.length > 0) {
              console.log('Exemplo de item com hist√≥rico:', {
                name: itemsWithHistory[0].name,
                historyLength: itemsWithHistory[0].price_history.length,
                firstEntry: itemsWithHistory[0].price_history[0],
                lastEntry: itemsWithHistory[0].price_history[itemsWithHistory[0].price_history.length - 1]
              });
            }
            
            // Atualizar exibi√ß√£o e salvar no localStorage com hist√≥rico
            displayInventoryData(processedData, true);
            console.log('üíæ Dados salvos no localStorage com hist√≥rico de pre√ßos');
          }).catch(error => {
            console.warn('‚ö†Ô∏è Erro ao buscar hist√≥rico de pre√ßos:', error);
          });
          
          // Buscar pre√ßos no Steam Market para itens sem pre√ßo (em background)
          const itemsNeedingFallback = processedData.items.filter(item => item.needsSteamMarketFallback);
          if (itemsNeedingFallback.length > 0) {
            console.log(`Buscando pre√ßos no Steam Market para ${itemsNeedingFallback.length} itens...`);
            
            // Executar fallback em background e atualizar quando terminar
            fetchSteamMarketPrices(itemsNeedingFallback).then(() => {
              // Recalcular total ap√≥s fallback
              totalValueBRL = processedData.items.reduce((sum, item) => sum + (item.total || 0), 0);
              processedData.total_value = totalValueBRL;
              
              console.log('Total value BRL recalculado (ap√≥s fallback):', totalValueBRL);
              console.log('Itens atualizados ap√≥s fallback:', itemsNeedingFallback.filter(item => item.price > 0).length);
              
              // Atualizar exibi√ß√£o com os novos pre√ßos
              displayInventoryData(processedData, true);
            });
          }
          
        } catch (error) {
          console.error('Erro ao buscar pre√ßos da API:', error);
          console.error('Stack trace:', error.stack);
          console.log('Exibindo dados mockados sem pre√ßos da API');
          
          // Verificar se √© erro de CORS
          let errorMessage = error.message || 'Erro desconhecido ao buscar pre√ßos';
          let isCorsError = false;
          
          if (error.message && (
            error.message.includes('CORS') || 
            error.message.includes('cors') ||
            error.message.includes('Access-Control') ||
            error.message.includes('NetworkError') ||
            error.message.includes('Failed to fetch') ||
            error.name === 'TypeError'
          )) {
            isCorsError = true;
            errorMessage = 'Erro de CORS: A API n√£o est√° configurada para aceitar requisi√ß√µes deste dom√≠nio. √â necess√°rio configurar CORS no backend da API.';
            console.error('‚ö†Ô∏è ERRO DE CORS DETECTADO');
            console.error('A API precisa permitir requisi√ß√µes do dom√≠nio:', window.location.origin);
            console.error('Configure o backend para aceitar requisi√ß√µes de:', [
              window.location.origin,
              'https://sidnei-almeida.github.io',
              'http://localhost:8000',
              'http://127.0.0.1:8000'
            ]);
          }
          
          // Se a API falhar, exibir dados mockados sem pre√ßos reais
          const mockData = {
            total_items: mockInventoryItems.length,
            total_value: 0,
            items: mockInventoryItems.map(item => ({
              ...item,
              price: 0,
              total: 0,
              error: isCorsError ? 'CORS bloqueado' : (error.message || 'Pre√ßo n√£o dispon√≠vel - API n√£o respondeu corretamente')
            }))
          };
          
          console.warn('Erro detalhado:', errorMessage);
          
          displayInventoryData(mockData, true, errorMessage);
        }
      }
      
      // Fun√ß√£o auxiliar para exibir dados do invent√°rio
      function displayInventoryData(data, isMocked = false, errorMessage = null) {
        inventoryLoading.style.display = 'none';
        inventoryData.style.display = 'block';
        
        const totalValue = data.total_value || 0;
        inventoryTotalValue.textContent = formatCurrency(totalValue);
        
        // Armazenar dados para exporta√ß√£o
        lastInventoryData = data;
        
        // Verificar se h√° itens com erro
        const itemsWithError = data.items?.filter(item => item.error).length || 0;
        const itemsWithPrice = data.items?.filter(item => item.price > 0).length || 0;
        
        // Preencher resumo
        let summaryHTML = `
          ${isMocked ? `
          <div style="margin-bottom: 1.5rem; padding: 12px 16px; background: rgba(255,215,0,0.08); border-radius: 6px; border-left: 3px solid rgba(255,215,0,0.5);">
            <p style="color: rgba(255,215,0,0.9); font-size: 0.9rem; margin: 0; font-weight: 500;">
              ‚ÑπÔ∏è Modo demonstra√ß√£o: usando invent√°rio de exemplo com pre√ßos reais da API
            </p>
          </div>
          ` : ''}
          <div style="margin-bottom: 1.5rem;">
            <p style="color: var(--cs2-text-light); font-size: 0.9rem; margin-bottom: 10px;">
              ${isMocked ? '' : 'üìä Invent√°rio analisado com sucesso.'}
            </p>
            ${errorMessage ? `
            <p style="color: var(--cs2-danger-red); margin-top: 10px; font-size: 0.85rem; padding: 8px; background: rgba(221,51,51,0.1); border-radius: 4px;">
              <strong>Erro:</strong> ${errorMessage}
            </p>
            ${errorMessage.includes('CORS') ? `
            <div style="margin-top: 10px; padding: 10px; background: rgba(255,215,0,0.1); border-radius: 4px; border-left: 3px solid var(--cs2-primary-gold);">
              <p style="color: var(--cs2-text-light); font-size: 0.8rem; margin-bottom: 5px;">
                <strong>Como resolver:</strong>
              </p>
              <ul style="color: var(--cs2-text-light); font-size: 0.75rem; margin: 5px 0; padding-left: 20px;">
                <li>Configure o backend da API para aceitar requisi√ß√µes CORS</li>
                <li>Adicione o dom√≠nio <code style="background: rgba(0,0,0,0.3); padding: 2px 4px; border-radius: 2px;">${window.location.origin}</code> nas origens permitidas</li>
                <li>Ou use um proxy CORS para contornar o problema temporariamente</li>
              </ul>
            </div>
            ` : ''}
            ` : ''}
            ${itemsWithError > 0 ? `
            <p style="color: var(--cs2-accent-orange); margin-top: 10px; font-size: 0.85rem;">
              <strong>Aten√ß√£o:</strong> ${itemsWithError} item(ns) sem pre√ßo dispon√≠vel na API.
            </p>
            ` : ''}
          </div>
          <div style="margin-bottom: 1.5rem; padding: 15px; background: rgba(19,30,43,0.5); border-radius: 8px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
              <span>Total de Itens:</span>
              <span style="font-weight: 600;">${data.total_items}</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
              <span>Valor Total:</span>
              <span style="font-weight: 600; color: var(--cs2-primary-gold);">${formatCurrency(totalValue)}</span>
            </div>
            ${data.total_items > 0 ? `
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
              <span>Valor M√©dio por Item:</span>
              <span style="font-weight: 600;">${formatCurrency(totalValue / data.total_items)}</span>
            </div>
            ` : ''}
          </div>
        `;
        
        inventorySummary.innerHTML = summaryHTML;
        
        // Renderizar itens usando createItemCard que j√° tem suporte a imagens
        let itemsHTML = '';
        
        if (data.items && data.items.length > 0) {
          // Ordenar por pre√ßo (maior primeiro)
          const sortedItems = [...data.items].sort((a, b) => (b.price || 0) - (a.price || 0));
          
          sortedItems.forEach(item => {
            // Garantir que o item tenha os campos necess√°rios para createItemCard
            if (!item.type && item.category) {
              item.type = item.category;
            }
            
            // Usar createItemCard que j√° tem suporte completo a imagens
            itemsHTML += createItemCard(item);
          });
        } else {
          itemsHTML += '<p style="color: var(--cs2-text-light); opacity: 0.7; grid-column: 1/-1; text-align: center; padding: 20px;">Nenhum item encontrado</p>';
        }
        
        inventoryItems.innerHTML = itemsHTML;
        
        // Salvar no localStorage para o dashboard
        localStorage.setItem('inventoryData', JSON.stringify(data));
      }
      
      // Fun√ß√£o auxiliar para obter cor da raridade
      function getRarityColor(rarity) {
        const rarityColors = {
          'Consumer Grade': '#b0c3d9',
          'Industrial Grade': '#5e98d9',
          'Mil-Spec Grade': '#4b69ff',
          'Restricted': '#8847ff',
          'Classified': '#d32ce6',
          'Covert': '#eb4b4b',
          'Knife': '#caab05',
          'Extraordinary': '#caab05',
          'Contraband': '#e4ae39'
        };
        
        return rarityColors[rarity] || 'var(--cs2-primary-gold)';
      }
      
      // Fun√ß√£o para formatar moeda
      function formatCurrency(value) {
        return new Intl.NumberFormat('pt-BR', { 
          style: 'currency', 
          currency: 'BRL' 
        }).format(value);
      }
      
      // Adicionar anima√ß√£o de rota√ß√£o para o loading
      const styleElement = document.createElement('style');
      styleElement.textContent = `
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `;
      document.head.appendChild(styleElement);
      
      // Taxa de c√¢mbio padr√£o (caso a API falhe)
      let CURRENCY_RATES = {
        USD_to_BRL: 5.05,
        EUR_to_BRL: 5.85,
        GBP_to_BRL: 6.70
      };
      const STEAM_TAX_FACTOR = 1.15; // 15% de taxa da Steam (1 + 0.15)
      
      // Fun√ß√£o para converter qualquer moeda para BRL
      function convertToBRL(price, currency) {
        if (!price || isNaN(parseFloat(price))) return 0;
        
        price = parseFloat(price);
        
        // J√° est√° em BRL
        if (currency === 'BRL') return price;
        
        // Converter com base na moeda
        if (currency === 'USD') {
          return price * CURRENCY_RATES.USD_to_BRL;
        } else if (currency === 'EUR') {
          return price * CURRENCY_RATES.EUR_to_BRL;
        } else if (currency === 'GBP') {
          return price * CURRENCY_RATES.GBP_to_BRL;
        }
        
        // Moeda n√£o suportada, usar USD como padr√£o
        console.warn(`Moeda ${currency} n√£o suportada, usando convers√£o de USD`);
        return price * CURRENCY_RATES.USD_to_BRL;
      }
      
      // Fun√ß√£o para obter a taxa de c√¢mbio atualizada
      async function getExchangeRate() {
        // Refer√™ncias aos elementos do indicador visual
        const exchangeRateIndicator = document.getElementById('exchange-rate-indicator');
        const exchangeRateText = document.getElementById('exchange-rate-text');
        
        // Atualizar indicador visual
        if (exchangeRateIndicator) {
          exchangeRateIndicator.style.backgroundColor = '#777';
          exchangeRateText.textContent = 'Atualizando taxa de c√¢mbio...';
        }
        
        try {
          // Verificar se j√° temos taxas armazenadas e se ainda s√£o v√°lidas (menos de 24 horas)
          const savedRates = localStorage.getItem('exchange_rates');
          const savedTimestamp = localStorage.getItem('exchange_rate_timestamp');
          
          if (savedRates && savedTimestamp) {
            const rateAge = Date.now() - parseInt(savedTimestamp);
            // Se a taxa foi atualizada nas √∫ltimas 24 horas, us√°-la
            if (rateAge < 24 * 60 * 60 * 1000) {
              console.log('Usando taxas de c√¢mbio em cache');
              CURRENCY_RATES = JSON.parse(savedRates);
              
              // Atualizar indicador visual
              if (exchangeRateIndicator) {
                exchangeRateIndicator.style.backgroundColor = 'var(--cs2-accent-green)';
                exchangeRateText.textContent = `1 USD = ${CURRENCY_RATES.USD_to_BRL.toFixed(2)} BRL`;
              }
              
              return CURRENCY_RATES;
            }
          }
          
          // Caso contr√°rio, buscar nova taxa
          // Usando API gratuita de Exchange Rates
          const response = await fetch('https://open.er-api.com/v6/latest/USD', {
            method: 'GET',
            headers: {
              'Accept': 'application/json'
            },
            mode: 'cors',
            cache: 'no-cache'
          });
          
          if (response.ok) {
            const data = await response.json();
            
            if (data && data.rates) {
              // Atualizar todas as taxas
              CURRENCY_RATES = {
                USD_to_BRL: data.rates.BRL || 5.05,
                EUR_to_BRL: data.rates.BRL / data.rates.EUR || 5.85,
                GBP_to_BRL: data.rates.BRL / data.rates.GBP || 6.70
              };
              
              console.log('Taxas de c√¢mbio atualizadas:', CURRENCY_RATES);
              
              // Armazenar as novas taxas e timestamp
              localStorage.setItem('exchange_rates', JSON.stringify(CURRENCY_RATES));
              localStorage.setItem('exchange_rate_timestamp', Date.now().toString());
              
              // Atualizar indicador visual
              if (exchangeRateIndicator) {
                exchangeRateIndicator.style.backgroundColor = 'var(--cs2-accent-green)';
                exchangeRateText.textContent = `1 USD = ${CURRENCY_RATES.USD_to_BRL.toFixed(2)} BRL`;
              }
              
              return CURRENCY_RATES;
            }
          }
          
          throw new Error('N√£o foi poss√≠vel obter as taxas de c√¢mbio atuais');
        } catch (error) {
          console.warn('Erro ao buscar taxas de c√¢mbio:', error);
          
          // Buscar alternativa se a primeira API falhar
          try {
            const altResponse = await fetch('https://api.exchangerate-api.com/v4/latest/USD', {
              method: 'GET',
              headers: {
                'Accept': 'application/json'
              },
              mode: 'cors'
            });
            
            if (altResponse.ok) {
              const altData = await altResponse.json();
              if (altData && altData.rates) {
                // Atualizar todas as taxas
                CURRENCY_RATES = {
                  USD_to_BRL: altData.rates.BRL || 5.05,
                  EUR_to_BRL: altData.rates.BRL / altData.rates.EUR || 5.85,
                  GBP_to_BRL: altData.rates.BRL / altData.rates.GBP || 6.70
                };
                
                console.log('Taxas de c√¢mbio alternativas:', CURRENCY_RATES);
                
                localStorage.setItem('exchange_rates', JSON.stringify(CURRENCY_RATES));
                localStorage.setItem('exchange_rate_timestamp', Date.now().toString());
                
                // Atualizar indicador visual
                if (exchangeRateIndicator) {
                  exchangeRateIndicator.style.backgroundColor = 'var(--cs2-accent-green)';
                  exchangeRateText.textContent = `1 USD = ${CURRENCY_RATES.USD_to_BRL.toFixed(2)} BRL`;
                }
                
                return CURRENCY_RATES;
              }
            }
          } catch (altError) {
            console.warn('Erro na API alternativa de c√¢mbio:', altError);
          }
          
          // Se todas as APIs falharem, usar os valores padr√£o
          console.log('Usando taxas de c√¢mbio padr√£o:', CURRENCY_RATES);
          
          // Atualizar indicador visual
          if (exchangeRateIndicator) {
            exchangeRateIndicator.style.backgroundColor = 'var(--cs2-danger-red)';
            exchangeRateText.textContent = `Taxa offline: 1 USD = ${CURRENCY_RATES.USD_to_BRL.toFixed(2)} BRL`;
          }
          
          return CURRENCY_RATES;
        }
      }
      
      // Tornar fun√ß√£o global para acesso via onclick
      window.loginWithSteam = loginWithSteam;
      window.logout = logout;
      
      // REMOVER QUALQUER OVERLAY QUE POSSA ESTAR BLOQUEANDO
      function removeBlockingOverlays() {
        // Remover redirect-indicator se estiver presente
        const redirectIndicator = document.getElementById('redirect-indicator');
        if (redirectIndicator) {
          console.log('Removendo redirect-indicator que estava bloqueando cliques');
          redirectIndicator.remove();
        }
        
        // Verificar se h√° elementos com z-index muito alto bloqueando
        const allElements = document.querySelectorAll('*');
        allElements.forEach(el => {
          const zIndex = window.getComputedStyle(el).zIndex;
          if (zIndex && parseInt(zIndex) > 5000 && el.id !== 'login-btn' && !el.closest('#login-btn')) {
            const rect = el.getBoundingClientRect();
            // Se o elemento cobre toda a tela
            if (rect.width > window.innerWidth * 0.9 && rect.height > window.innerHeight * 0.9) {
              console.log('Elemento bloqueante encontrado:', el.id || el.className, 'z-index:', zIndex);
              // N√£o remover automaticamente, apenas logar
            }
          }
        });
      }
      
      // Garantir que todos os bot√µes sejam clic√°veis
      function ensureButtonsClickable() {
        // Todos os bot√µes
        const allButtons = document.querySelectorAll('button, .btn, [role="button"], .api-tab');
        allButtons.forEach(btn => {
          btn.style.pointerEvents = 'auto';
          btn.style.cursor = 'pointer';
          btn.style.zIndex = '100';
          btn.style.position = 'relative';
          if (btn.disabled) {
            btn.disabled = false;
          }
          // Remover qualquer atributo que possa bloquear
          btn.removeAttribute('disabled');
        });
        
        // Tabs tamb√©m - garantir que funcionem e adicionar listeners
        const tabs = document.querySelectorAll('.api-tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
          tab.style.pointerEvents = 'auto';
          tab.style.cursor = 'pointer';
          tab.style.zIndex = '100';
          tab.style.position = 'relative';
          
          // Remover listeners antigos e adicionar novos
          const newTab = tab.cloneNode(true);
          tab.parentNode.replaceChild(newTab, tab);
          const freshTab = document.querySelector(`[data-tab="${newTab.dataset.tab}"]`);
          
          if (freshTab) {
            freshTab.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation();
              console.log('Tab clicada:', freshTab.dataset.tab);
              
              // Remove active class de todas as tabs
              tabs.forEach(t => {
                t.classList.remove('active');
                t.style.color = 'var(--cs2-text-light)';
              });
              
              // Adiciona active class na tab clicada
              freshTab.classList.add('active');
              freshTab.style.color = 'var(--cs2-primary-gold)';
              
              // Esconde todos os conte√∫dos
              tabContents.forEach(content => {
                content.style.display = 'none';
                content.classList.remove('active');
              });
              
              // Mostra o conte√∫do correspondente
              const targetContent = document.getElementById(`${freshTab.dataset.tab}-tab`);
              if (targetContent) {
                targetContent.style.display = 'block';
                targetContent.classList.add('active');
              }
            });
          }
        });
        
        // Garantir que elementos pais n√£o bloqueiem
        const containers = document.querySelectorAll('#auth-section, .tab-content, [id*="tab"]');
        containers.forEach(container => {
          const computedStyle = window.getComputedStyle(container);
          if (computedStyle.pointerEvents === 'none') {
            container.style.pointerEvents = 'auto';
          }
        });
        
        console.log(`Garantindo que ${allButtons.length} bot√µes sejam clic√°veis`);
      }
      
      // Inicializa√ß√£o
      removeBlockingOverlays(); // Remover overlays bloqueantes
      checkApiStatus();  // Verificar status da API
      processUrlParams(); // Processar par√¢metros de URL para auth
      checkAuthStatus();  // Verificar estado de autentica√ß√£o
      getExchangeRate(); // Buscar taxa de c√¢mbio atual
      ensureButtonsClickable(); // Garantir que bot√µes sejam clic√°veis
      
      // Reconfigurar bot√µes ap√≥s um pequeno delay para garantir que o DOM est√° pronto
      setTimeout(() => {
        removeBlockingOverlays();
        setupLoginButtons();
        ensureButtonsClickable();
      }, 100);
      
      // Reconfigurar novamente ap√≥s mais tempo (caso elementos sejam carregados dinamicamente)
      setTimeout(() => {
        removeBlockingOverlays();
        setupLoginButtons();
        ensureButtonsClickable();
      }, 500);
      
      // Verificar periodicamente se h√° overlays bloqueantes
      setInterval(() => {
        const redirectIndicator = document.getElementById('redirect-indicator');
        if (redirectIndicator && redirectIndicator.style.display !== 'none') {
          // Se o overlay existe mas n√£o deveria estar vis√≠vel, remover
          const now = Date.now();
          const created = redirectIndicator.dataset.created;
          if (created && (now - parseInt(created)) > 30000) {
            console.log('Removendo overlay antigo que estava bloqueando');
            redirectIndicator.remove();
          }
        }
      }, 2000);
      
      // Adicionar event listeners para bot√µes
      if (priceBtn) {
        console.log('Adicionando event listener para o bot√£o de busca de pre√ßo');
        priceBtn.addEventListener('click', getPrice);
        
        // Sincronizar checkbox StatTrak com o texto digitado
        if (skinNameInput) {
          skinNameInput.addEventListener('input', function() {
            const statTrakCheckbox = document.getElementById('stattrak-checkbox');
            if (statTrakCheckbox) {
              const text = this.value.toLowerCase();
              const hasStatTrak = text.includes('stattrak') || text.includes('stattrak‚Ñ¢');
              statTrakCheckbox.checked = hasStatTrak;
            }
          });
          
          // Tamb√©m permitir Enter para buscar
          skinNameInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
              getPrice();
            }
          });
        }
        
        // Sincronizar texto quando checkbox for alterado
        const statTrakCheckbox = document.getElementById('stattrak-checkbox');
        if (statTrakCheckbox) {
          statTrakCheckbox.addEventListener('change', function() {
            if (this.checked && skinNameInput) {
              const text = skinNameInput.value;
              // Se n√£o tiver StatTrak no texto, adicionar
              if (!text.toLowerCase().includes('stattrak')) {
                // Tentar adicionar StatTrak no in√≠cio do nome
                if (text.trim()) {
                  skinNameInput.value = 'StatTrak‚Ñ¢ ' + text.trim();
                }
              }
            } else if (!this.checked && skinNameInput) {
              // Remover StatTrak do texto se desmarcar
              const text = skinNameInput.value;
              skinNameInput.value = text.replace(/StatTrak‚Ñ¢?\s*/gi, '').trim();
            }
          });
        }
      }
      
      // A funcionalidade de caixas foi removida
      
      // Conectar o bot√£o de exportar Excel com a fun√ß√£o
      if (exportExcelBtn) {
        exportExcelBtn.addEventListener('click', () => {
          // Verificar se h√° dados para exportar
          if (lastInventoryData) {
            exportToExcel(lastInventoryData);
          } else {
            alert('Nenhum dado dispon√≠vel para exportar. Fa√ßa uma an√°lise de invent√°rio primeiro.');
          }
        });
      }
      
      // Conectar o bot√£o de gerar dashboard com a fun√ß√£o
      const generateDashboardBtn = document.getElementById('generate-dashboard-btn');
      if (generateDashboardBtn) {
        generateDashboardBtn.addEventListener('click', () => {
          // Verificar se h√° dados para gerar a dashboard
          if (lastInventoryData) {
            generateDashboard(lastInventoryData);
          } else {
            alert('Nenhum dado dispon√≠vel para gerar dashboard. Fa√ßa uma an√°lise de invent√°rio primeiro.');
          }
        });
      }
    });
    
    // Fun√ß√£o para gerar dashboard interativa com Plotly
    function generateDashboard(data) {
      if (!data || !data.items || data.items.length === 0) {
        alert('Nenhum dado dispon√≠vel para gerar dashboard. Fa√ßa uma an√°lise de invent√°rio primeiro.');
        return;
      }
      
      console.log('Gerando dashboard interativa...');
      
      // Armazenar os dados no localStorage para que o dashboard.html possa acess√°-los
      localStorage.setItem('inventoryData', JSON.stringify(data));
      
      // Abrir o dashboard em uma nova janela
      window.open('dashboard.html', '_blank');
    }
  </script>

  <!-- Script para rolagem suave ao topo e ajuste de padding -->
  <script>
    // Ajustar padding-top do main baseado na altura do header
    function adjustMainPadding() {
      const header = document.querySelector('.header');
      const main = document.querySelector('main');
      if (header && main) {
        const headerHeight = header.offsetHeight;
        main.style.paddingTop = (headerHeight + 20) + 'px'; // 20px de espa√ßo extra
      }
    }
    
    // Executar ao carregar e ao redimensionar
    window.addEventListener('load', adjustMainPadding);
    window.addEventListener('resize', adjustMainPadding);
    // Executar tamb√©m ap√≥s um pequeno delay para garantir que tudo est√° renderizado
    setTimeout(adjustMainPadding, 100);
    
    // Captura todos os links com a classe scroll-top-link
    document.addEventListener('DOMContentLoaded', function() {
      const scrollTopLinks = document.querySelectorAll('.scroll-top-link');
      
      scrollTopLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          // Se o link aponta para outro arquivo HTML, permite navega√ß√£o normal
          const href = link.getAttribute('href');
          if (href && (href.includes('.html') || href.startsWith('http'))) {
            // Permite navega√ß√£o normal para outros arquivos
            return;
          }
          
          // Previne o comportamento padr√£o do link apenas para √¢ncoras
          e.preventDefault();
          
          // Rola para o topo da p√°gina com efeito suave
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        });
      });
    });
  </script>
</body>
</html>